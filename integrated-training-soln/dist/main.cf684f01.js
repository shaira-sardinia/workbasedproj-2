parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"pBGv":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"chA2":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var t=arguments[3],e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sha1=exports.RANDOM_FACTOR=exports.MAX_VALUE_MILLIS=exports.FirebaseError=exports.ErrorFactory=exports.Deferred=exports.DecodeBase64StringError=exports.CONSTANTS=void 0,exports.areCookiesEnabled=V,exports.assertionError=exports.assert=void 0,exports.async=ft,exports.base64urlEncodeWithoutPadding=exports.base64Encode=exports.base64Decode=exports.base64=void 0,exports.calculateBackoffMillis=Ct,exports.contains=Y,exports.createMockUserToken=O,exports.createSubscribe=ht,exports.decode=void 0,exports.deepCopy=l,exports.deepEqual=rt,exports.deepExtend=p,exports.errorPrefix=bt,exports.extractQuerystring=at,exports.getExperimentalSetting=exports.getDefaults=exports.getDefaultEmulatorHostnameAndPort=exports.getDefaultEmulatorHost=exports.getDefaultAppConfig=void 0,exports.getGlobal=b,exports.getModularInstance=Tt,exports.getUA=C,exports.isAdmin=void 0,exports.isBrowser=T,exports.isBrowserExtension=N,exports.isElectron=j,exports.isEmpty=tt,exports.isIE=B,exports.isIndexedDBAvailable=L,exports.isMobileCordova=D,exports.isNode=w,exports.isNodeSdk=I,exports.isReactNative=M,exports.isSafari=P,exports.isUWP=k,exports.issuedAtTime=exports.isValidTimestamp=exports.isValidFormat=void 0,exports.jsonEval=H,exports.map=et,exports.ordinal=Dt,exports.promiseWithTimeout=nt,exports.querystring=st,exports.querystringDecode=it,exports.safeGet=Z,exports.stringToByteArray=exports.stringLength=void 0,exports.stringify=J,exports.validateArgCount=exports.uuidv4=void 0,exports.validateCallback=_t,exports.validateContextObject=gt,exports.validateIndexedDBOpenable=R,exports.validateNamespace=xt;const r=exports.CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw n(e)};exports.assert=o;const n=function(t){return new Error("Firebase Database ("+r.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};exports.assertionError=n;const s=function(t){const e=[];let r=0;for(let o=0;o<t.length;o++){let n=t.charCodeAt(o);n<128?e[r++]=n:n<2048?(e[r++]=n>>6|192,e[r++]=63&n|128):55296==(64512&n)&&o+1<t.length&&56320==(64512&t.charCodeAt(o+1))?(n=65536+((1023&n)<<10)+(1023&t.charCodeAt(++o)),e[r++]=n>>18|240,e[r++]=n>>12&63|128,e[r++]=n>>6&63|128,e[r++]=63&n|128):(e[r++]=n>>12|224,e[r++]=n>>6&63|128,e[r++]=63&n|128)}return e},i=function(t){const e=[];let r=0,o=0;for(;r<t.length;){const n=t[r++];if(n<128)e[o++]=String.fromCharCode(n);else if(n>191&&n<224){const s=t[r++];e[o++]=String.fromCharCode((31&n)<<6|63&s)}else if(n>239&&n<365){const s=((7&n)<<18|(63&t[r++])<<12|(63&t[r++])<<6|63&t[r++])-65536;e[o++]=String.fromCharCode(55296+(s>>10)),e[o++]=String.fromCharCode(56320+(1023&s))}else{const s=t[r++],i=t[r++];e[o++]=String.fromCharCode((15&n)<<12|(63&s)<<6|63&i)}}return e.join("")},a=exports.base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let n=0;n<t.length;n+=3){const e=t[n],s=n+1<t.length,i=s?t[n+1]:0,a=n+2<t.length,c=a?t[n+2]:0,h=e>>2,u=(3&e)<<4|i>>4;let f=(15&i)<<2|c>>6,l=63&c;a||(l=64,s||(f=64)),o.push(r[h],r[u],r[f],r[l])}return o.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):i(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let n=0;n<t.length;){const e=r[t.charAt(n++)],s=n<t.length?r[t.charAt(n)]:0,i=++n<t.length?r[t.charAt(n)]:64,a=++n<t.length?r[t.charAt(n)]:64;if(++n,null==e||null==s||null==i||null==a)throw new c;const h=e<<2|s>>4;if(o.push(h),64!==i){const t=s<<4&240|i>>2;if(o.push(t),64!==a){const t=i<<6&192|a;o.push(t)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}exports.DecodeBase64StringError=c;const h=function(t){const e=s(t);return a.encodeByteArray(e,!0)};exports.base64Encode=h;const u=function(t){return h(t).replace(/\./g,"")};exports.base64urlEncodeWithoutPadding=u;const f=function(t){try{return a.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l(t){return p(void 0,t)}function p(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const r in e)e.hasOwnProperty(r)&&d(r)&&(t[r]=p(t[r],e[r]));return t}function d(t){return"__proto__"!==t}function b(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("Unable to locate global object.")}exports.base64Decode=f;const x=()=>b().__FIREBASE_DEFAULTS__,_=()=>{if(void 0===e||void 0===e.env)return},g=()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(r){return}const e=t&&f(t[1]);return e&&JSON.parse(e)},y=()=>{try{return x()||_()||g()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}};exports.getDefaults=y;const v=t=>{var e,r;return null===(r=null===(e=y())||void 0===e?void 0:e.emulatorHosts)||void 0===r?void 0:r[t]};exports.getDefaultEmulatorHost=v;const E=t=>{const e=v(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const o=parseInt(e.substring(r+1),10);return"["===e[0]?[e.substring(1,r-1),o]:[e.substring(0,r),o]};exports.getDefaultEmulatorHostnameAndPort=E;const m=()=>{var t;return null===(t=y())||void 0===t?void 0:t.config};exports.getDefaultAppConfig=m;const A=t=>{var e;return null===(e=y())||void 0===e?void 0:e[`_${t}`]};exports.getExperimentalSetting=A;class S{constructor(){this.reject=(()=>{}),this.resolve=(()=>{}),this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}function O(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=e||"demo-project",o=t.iat||0,n=t.sub||t.user_id;if(!n)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:n,user_id:n,firebase:{sign_in_provider:"custom",identities:{}}},t);return[u(JSON.stringify({alg:"none",type:"JWT"})),u(JSON.stringify(s)),""].join(".")}function C(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function D(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(C())}function w(){var e;const r=null===(e=y())||void 0===e?void 0:e.forceEnvironment;if("node"===r)return!0;if("browser"===r)return!1;try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(o){return!1}}function T(){return"object"==typeof self&&self.self===self}function N(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function M(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function j(){return C().indexOf("Electron/")>=0}function B(){const t=C();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function k(){return C().indexOf("MSAppHost/")>=0}function I(){return!0===r.NODE_CLIENT||!0===r.NODE_ADMIN}function P(){return!w()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function L(){try{return"object"==typeof indexedDB}catch(t){return!1}}function R(){return new Promise((t,e)=>{try{let o=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=(()=>{s.result.close(),o||self.indexedDB.deleteDatabase(n),t(!0)}),s.onupgradeneeded=(()=>{o=!1}),s.onerror=(()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")})}catch(r){e(r)}})}function V(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}exports.Deferred=S;const F="FirebaseError";class U extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name=F,Object.setPrototypeOf(this,U.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,W.prototype.create)}}exports.FirebaseError=U;class W{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},o=`${this.service}/${t}`,n=this.errors[t],s=n?$(n,r):"Error",i=`${this.serviceName}: ${s} (${o}).`;return new U(o,i,r)}}function $(t,e){return t.replace(z,(t,r)=>{const o=e[r];return null!=o?String(o):`<${r}?>`})}exports.ErrorFactory=W;const z=/\{\$([^}]+)}/g;function H(t){return JSON.parse(t)}function J(t){return JSON.stringify(t)}const q=function(t){let e={},r={},o={},n="";try{const i=t.split(".");e=H(f(i[0])||""),r=H(f(i[1])||""),n=i[2],o=r.d||{},delete r.d}catch(s){}return{header:e,claims:r,data:o,signature:n}};exports.decode=q;const G=function(t){const e=q(t).claims,r=Math.floor((new Date).getTime()/1e3);let o=0,n=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?o=e.nbf:e.hasOwnProperty("iat")&&(o=e.iat),n=e.hasOwnProperty("exp")?e.exp:o+86400),!!r&&!!o&&!!n&&r>=o&&r<=n};exports.isValidTimestamp=G;const K=function(t){const e=q(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null};exports.issuedAtTime=K;const X=function(t){const e=q(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")};exports.isValidFormat=X;const Q=function(t){const e=q(t).claims;return"object"==typeof e&&!0===e.admin};function Y(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Z(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function tt(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function et(t,e,r){const o={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=e.call(r,t[n],n,t));return o}function rt(t,e){if(t===e)return!0;const r=Object.keys(t),o=Object.keys(e);for(const n of r){if(!o.includes(n))return!1;const r=t[n],s=e[n];if(ot(r)&&ot(s)){if(!rt(r,s))return!1}else if(r!==s)return!1}for(const n of o)if(!r.includes(n))return!1;return!0}function ot(t){return null!==t&&"object"==typeof t}function nt(t,e=2e3){const r=new S;return setTimeout(()=>r.reject("timeout!"),e),t.then(r.resolve,r.reject),r.promise}function st(t){const e=[];for(const[r,o]of Object.entries(t))Array.isArray(o)?o.forEach(t=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(o));return e.length?"&"+e.join("&"):""}function it(t){const e={};return t.replace(/^\?/,"").split("&").forEach(t=>{if(t){const[r,o]=t.split("=");e[decodeURIComponent(r)]=decodeURIComponent(o)}}),e}function at(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}exports.isAdmin=Q;class ct{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const r=this.W_;if("string"==typeof t)for(let u=0;u<16;u++)r[u]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let u=0;u<16;u++)r[u]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let u=16;u<80;u++){const t=r[u-3]^r[u-8]^r[u-14]^r[u-16];r[u]=4294967295&(t<<1|t>>>31)}let o,n,s=this.chain_[0],i=this.chain_[1],a=this.chain_[2],c=this.chain_[3],h=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(o=c^i&(a^c),n=1518500249):(o=i^a^c,n=1859775393):u<60?(o=i&a|c&(i|a),n=2400959708):(o=i^a^c,n=3395469782);const t=(s<<5|s>>>27)+o+h+n+r[u]&4294967295;h=c,c=a,a=4294967295&(i<<30|i>>>2),i=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const r=e-this.blockSize;let o=0;const n=this.buf_;let s=this.inbuf_;for(;o<e;){if(0===s)for(;o<=r;)this.compress_(t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(n[s]=t.charCodeAt(o),++o,++s===this.blockSize){this.compress_(n),s=0;break}}else for(;o<e;)if(n[s]=t[o],++o,++s===this.blockSize){this.compress_(n),s=0;break}}this.inbuf_=s,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let o=this.blockSize-1;o>=56;o--)this.buf_[o]=255&e,e/=256;this.compress_(this.buf_);let r=0;for(let o=0;o<5;o++)for(let e=24;e>=0;e-=8)t[r]=this.chain_[o]>>e&255,++r;return t}}function ht(t,e){const r=new ut(t,e);return r.subscribe.bind(r)}exports.Sha1=ct;class ut{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(t=>{this.error(t)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let o;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");void 0===(o=lt(t,["next","error","complete"])?t:{next:t,error:e,complete:r}).next&&(o.next=pt),void 0===o.error&&(o.error=pt),void 0===o.complete&&(o.complete=pt);const n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch(t){}}),this.observers.push(o),n}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ft(t,e){return(...r)=>{Promise.resolve(!0).then(()=>{t(...r)}).catch(t=>{e&&e(t)})}}function lt(t,e){if("object"!=typeof t||null===t)return!1;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}function pt(){}const dt=function(t,e,r,o){let n;if(o<e?n="at least "+e:o>r&&(n=0===r?"none":"no more than "+r),n){throw new Error(t+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+n+".")}};function bt(t,e){return`${t} failed: ${e} argument `}function xt(t,e,r){if((!r||e)&&"string"!=typeof e)throw new Error(bt(t,"namespace")+"must be a valid firebase namespace.")}function _t(t,e,r,o){if((!o||r)&&"function"!=typeof r)throw new Error(bt(t,e)+"must be a valid function.")}function gt(t,e,r,o){if((!o||r)&&("object"!=typeof r||null===r))throw new Error(bt(t,e)+"must be a valid context object.")}exports.validateArgCount=dt;const yt=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s>=55296&&s<=56319){const e=s-55296;o(++n<t.length,"Surrogate pair missing trail surrogate."),s=65536+(e<<10)+(t.charCodeAt(n)-56320)}s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=63&s|128):s<65536?(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=63&s|128):(e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=63&s|128)}return e};exports.stringToByteArray=yt;const vt=function(t){let e=0;for(let r=0;r<t.length;r++){const o=t.charCodeAt(r);o<128?e++:o<2048?e+=2:o>=55296&&o<=56319?(e+=4,r++):e+=3}return e};exports.stringLength=vt;const Et=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})};exports.uuidv4=Et;const mt=1e3,At=2,St=exports.MAX_VALUE_MILLIS=144e5,Ot=exports.RANDOM_FACTOR=.5;function Ct(t,e=mt,r=At){const o=e*Math.pow(r,t),n=Math.round(Ot*o*(Math.random()-.5)*2);return Math.min(St,o+n)}function Dt(t){return Number.isFinite(t)?t+wt(t):`${t}`}function wt(t){const e=(t=Math.abs(t))%100;if(e>=10&&e<=20)return"th";const r=t%10;return 1===r?"st":2===r?"nd":3===r?"rd":"th"}function Tt(t){return t&&t._delegate?t._delegate:t}
},{"process":"pBGv"}],"vhY9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Provider=exports.ComponentContainer=exports.Component=void 0;var t=require("@firebase/util");class e{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}exports.Component=e;const n="[DEFAULT]";class i{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const e=new t.Deferred;if(this.instancesDeferred.set(n,e),this.isInitialized(n)||this.shouldAutoInitialize())try{const t=this.getOrInitializeService({instanceIdentifier:n});t&&e.resolve(t)}catch(i){}}return this.instancesDeferred.get(n).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(r(t))try{this.getOrInitializeService({instanceIdentifier:n})}catch(e){}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:i});n.resolve(t)}catch(e){}}}}clearInstance(t=n){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...t.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return null!=this.component}isInitialized(t=n){return this.instances.has(t)}getOptions(t=n){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[s,r]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&r.resolve(i)}return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch(i){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:s(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(i){}return n||null}normalizeInstanceIdentifier(t=n){return this.component?this.component.multipleInstances?t:n:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function s(t){return t===n?void 0:t}function r(t){return"EAGER"===t.instantiationMode}exports.Provider=i;class o{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new i(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}exports.ComponentContainer=o;
},{"@firebase/util":"chA2"}],"JJem":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Logger=exports.LogLevel=void 0,exports.setLogLevel=i,exports.setUserLogHandler=g;const e=[];var r;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(r||(exports.LogLevel=r={}));const t={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},o=r.INFO,l={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},s=(e,r,...t)=>{if(r<e.logLevel)return;const o=(new Date).toISOString(),s=l[r];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${r})`);console[s](`[${o}]  ${e.name}:`,...t)};class n{constructor(r){this.name=r,this._logLevel=o,this._logHandler=s,this._userLogHandler=null,e.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in r))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?t[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...e),this._logHandler(this,r.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...e),this._logHandler(this,r.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,r.INFO,...e),this._logHandler(this,r.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,r.WARN,...e),this._logHandler(this,r.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...e),this._logHandler(this,r.ERROR,...e)}}function i(r){e.forEach(e=>{e.setLogLevel(r)})}function g(o,l){for(const s of e){let e=null;l&&l.level&&(e=t[l.level]),s.userLogHandler=null===o?null:(t,l,...s)=>{const n=s.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(r){return null}}).filter(e=>e).join(" ");l>=(null!=e?e:t.logLevel)&&o({level:r[l].toLowerCase(),message:n,args:s,type:t.name})}}}exports.Logger=n;
},{}],"F1qz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.i=exports.a=void 0,exports.r=v,exports.u=void 0,exports.w=I;const e=(e,t)=>t.some(t=>e instanceof t);let t,r;function n(){return t||(t=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function o(){return r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}exports.i=e;const s=new WeakMap,i=new WeakMap,a=new WeakMap,c=new WeakMap,u=exports.a=new WeakMap;function p(e){const t=new Promise((t,r)=>{const n=()=>{e.removeEventListener("success",o),e.removeEventListener("error",s)},o=()=>{t(I(e.result)),n()},s=()=>{r(e.error),n()};e.addEventListener("success",o),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&s.set(t,e)}).catch(()=>{}),u.set(t,e),t}function f(e){if(i.has(e))return;const t=new Promise((t,r)=>{const n=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",s),e.removeEventListener("abort",s)},o=()=>{t(),n()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",o),e.addEventListener("error",s),e.addEventListener("abort",s)});i.set(e,t)}let d={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return i.get(e);if("objectStoreNames"===t)return e.objectStoreNames||a.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return I(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function v(e){d=e(d)}function D(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?o().includes(e)?function(...t){return e.apply(B(this),t),I(s.get(this))}:function(...t){return I(e.apply(B(this),t))}:function(t,...r){const n=e.call(B(this),t,...r);return a.set(n,t.sort?t.sort():[t]),I(n)}}function m(t){return"function"==typeof t?D(t):(t instanceof IDBTransaction&&f(t),e(t,n())?new Proxy(t,d):t)}function I(e){if(e instanceof IDBRequest)return p(e);if(c.has(e))return c.get(e);const t=m(e);return t!==e&&(c.set(e,t),u.set(t,e)),t}const B=e=>u.get(e);exports.u=B;
},{}],"JZvK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.deleteDB=n,exports.openDB=t,Object.defineProperty(exports,"unwrap",{enumerable:!0,get:function(){return e.u}}),Object.defineProperty(exports,"wrap",{enumerable:!0,get:function(){return e.w}});var e=require("./wrap-idb-value.js");function t(t,n,{blocked:r,upgrade:o,blocking:i,terminated:s}={}){const d=indexedDB.open(t,n),a=(0,e.w)(d);return o&&d.addEventListener("upgradeneeded",t=>{o((0,e.w)(d.result),t.oldVersion,t.newVersion,(0,e.w)(d.transaction),t)}),r&&d.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}function n(t,{blocked:n}={}){const r=indexedDB.deleteDatabase(t);return n&&r.addEventListener("blocked",e=>n(e.oldVersion,e)),(0,e.w)(r).then(()=>void 0)}const r=["get","getKey","getAll","getAllKeys","count"],o=["put","add","delete","clear"],i=new Map;function s(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(i.get(t))return i.get(t);const n=t.replace(/FromIndex$/,""),s=t!==n,d=o.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!d&&!r.includes(n))return;const a=async function(e,...t){const r=this.transaction(e,d?"readwrite":"readonly");let o=r.store;return s&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),d&&r.done]))[0]};return i.set(t,a),a}(0,e.r)(e=>({...e,get:(t,n,r)=>s(t,n)||e.get(t,n,r),has:(t,n)=>!!s(t,n)||e.has(t,n)}));
},{"./wrap-idb-value.js":"F1qz"}],"h2Mb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"FirebaseError",{enumerable:!0,get:function(){return a.FirebaseError}}),exports._DEFAULT_ENTRY_NAME=exports.SDK_VERSION=void 0,exports._addComponent=L,exports._addOrOverwriteComponent=z,exports._apps=void 0,exports._clearComponents=K,exports._components=void 0,exports._getProvider=U,exports._isFirebaseApp=q,exports._isFirebaseServerApp=J,exports._registerComponent=T,exports._removeServiceInstance=V,exports._serverApps=void 0,exports.deleteApp=re,exports.getApp=te,exports.getApps=ae,exports.initializeApp=Z,exports.initializeServerApp=ee,exports.onLog=ne,exports.registerVersion=ie,exports.setLogLevel=se;var e=require("@firebase/component"),t=require("@firebase/logger"),a=require("@firebase/util"),r=require("idb");class i{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(n(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}function n(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}const s="@firebase/app",o="0.10.5",c=new t.Logger("@firebase/app"),p="@firebase/app-compat",l="@firebase/analytics-compat",h="@firebase/analytics",d="@firebase/app-check-compat",f="@firebase/app-check",u="@firebase/auth",b="@firebase/auth-compat",g="@firebase/database",m="@firebase/database-compat",v="@firebase/functions",_="@firebase/functions-compat",w="@firebase/installations",C="@firebase/installations-compat",D="@firebase/messaging",y="@firebase/messaging-compat",E="@firebase/performance",x="@firebase/performance-compat",O="@firebase/remote-config",S="@firebase/remote-config-compat",A="@firebase/storage",I="@firebase/storage-compat",P="@firebase/firestore",F="@firebase/vertexai-preview",N="@firebase/firestore-compat",$="firebase",j="10.12.2",R=exports._DEFAULT_ENTRY_NAME="[DEFAULT]",k={[s]:"fire-core",[p]:"fire-core-compat",[h]:"fire-analytics",[l]:"fire-analytics-compat",[f]:"fire-app-check",[d]:"fire-app-check-compat",[u]:"fire-auth",[b]:"fire-auth-compat",[g]:"fire-rtdb",[m]:"fire-rtdb-compat",[v]:"fire-fn",[_]:"fire-fn-compat",[w]:"fire-iid",[C]:"fire-iid-compat",[D]:"fire-fcm",[y]:"fire-fcm-compat",[E]:"fire-perf",[x]:"fire-perf-compat",[O]:"fire-rc",[S]:"fire-rc-compat",[A]:"fire-gcs",[I]:"fire-gcs-compat",[P]:"fire-fst",[N]:"fire-fst-compat",[F]:"fire-vertex","fire-js":"fire-js",[$]:"fire-js-all"},B=exports._apps=new Map,M=exports._serverApps=new Map,H=exports._components=new Map;function L(e,t){try{e.container.addComponent(t)}catch(a){c.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,a)}}function z(e,t){e.container.addOrOverwriteComponent(t)}function T(e){const t=e.name;if(H.has(t))return c.debug(`There were multiple attempts to register component ${t}.`),!1;H.set(t,e);for(const a of B.values())L(a,e);for(const a of M.values())L(a,e);return!0}function U(e,t){const a=e.container.getProvider("heartbeat").getImmediate({optional:!0});return a&&a.triggerHeartbeat(),e.container.getProvider(t)}function V(e,t,a=R){U(e,t).clearInstance(a)}function q(e){return void 0!==e.options}function J(e){return void 0!==e.settings}function K(){H.clear()}const W={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Y=new a.ErrorFactory("app","Firebase",W);class G{constructor(t,a,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},a),this._name=a.name,this._automaticDataCollectionEnabled=a.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new e.Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Y.create("app-deleted",{appName:this._name})}}class Q extends G{constructor(e,t,a,r){const i=void 0!==t.automaticDataCollectionEnabled&&t.automaticDataCollectionEnabled,n={name:a,automaticDataCollectionEnabled:i};if(void 0!==e.apiKey)super(e,n,r);else{super(e.options,n,r)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:i},t),this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()}),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,ie(s,o,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){re(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Y.create("server-app-deleted")}}const X=exports.SDK_VERSION=j;function Z(t,r={}){let i=t;if("object"!=typeof r){r={name:r}}const n=Object.assign({name:R,automaticDataCollectionEnabled:!1},r),s=n.name;if("string"!=typeof s||!s)throw Y.create("bad-app-name",{appName:String(s)});if(i||(i=(0,a.getDefaultAppConfig)()),!i)throw Y.create("no-options");const o=B.get(s);if(o){if((0,a.deepEqual)(i,o.options)&&(0,a.deepEqual)(n,o.config))return o;throw Y.create("duplicate-app",{appName:s})}const c=new e.ComponentContainer(s);for(const e of H.values())c.addComponent(e);const p=new G(i,n,c);return B.set(s,p),p}function ee(t,r){if((0,a.isBrowser)())throw Y.create("invalid-server-app-environment");let i;void 0===r.automaticDataCollectionEnabled&&(r.automaticDataCollectionEnabled=!1),i=q(t)?t.options:t;const n=Object.assign(Object.assign({},r),i);void 0!==n.releaseOnDeref&&delete n.releaseOnDeref;if(void 0!==r.releaseOnDeref&&"undefined"==typeof FinalizationRegistry)throw Y.create("finalization-registry-not-supported",{});const s=""+(e=>[...e].reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0))(JSON.stringify(n)),o=M.get(s);if(o)return o.incRefCount(r.releaseOnDeref),o;const c=new e.ComponentContainer(s);for(const e of H.values())c.addComponent(e);const p=new Q(i,r,s,c);return M.set(s,p),p}function te(e=R){const t=B.get(e);if(!t&&e===R&&(0,a.getDefaultAppConfig)())return Z();if(!t)throw Y.create("no-app",{appName:e});return t}function ae(){return Array.from(B.values())}async function re(e){let t=!1;const a=e.name;if(B.has(a))t=!0,B.delete(a);else if(M.has(a)){e.decRefCount()<=0&&(M.delete(a),t=!0)}t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function ie(t,a,r){var i;let n=null!==(i=k[t])&&void 0!==i?i:t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),o=a.match(/\s|\//);if(s||o){const e=[`Unable to register library "${n}" with version "${a}":`];return s&&e.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${a}" contains illegal characters (whitespace or "/")`),void c.warn(e.join(" "))}T(new e.Component(`${n}-version`,()=>({library:n,version:a}),"VERSION"))}function ne(e,a){if(null!==e&&"function"!=typeof e)throw Y.create("invalid-log-argument");(0,t.setUserLogHandler)(e,a)}function se(e){(0,t.setLogLevel)(e)}const oe="firebase-heartbeat-database",ce=1,pe="firebase-heartbeat-store";let le=null;function he(){return le||(le=(0,r.openDB)(oe,ce,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(pe)}catch(a){console.warn(a)}}}}).catch(e=>{throw Y.create("idb-open",{originalErrorMessage:e.message})})),le}async function de(e){try{const r=(await he()).transaction(pe),i=await r.objectStore(pe).get(ue(e));return await r.done,i}catch(t){if(t instanceof a.FirebaseError)c.warn(t.message);else{const e=Y.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});c.warn(e.message)}}}async function fe(e,t){try{const i=(await he()).transaction(pe,"readwrite"),n=i.objectStore(pe);await n.put(t,ue(e)),await i.done}catch(r){if(r instanceof a.FirebaseError)c.warn(r.message);else{const e=Y.create("idb-set",{originalErrorMessage:null==r?void 0:r.message});c.warn(e.message)}}}function ue(e){return`${e.name}!${e.options.appId}`}const be=1024,ge=2592e6;class me{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new we(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ve();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some(e=>e.date===r))return this._heartbeatsCache.heartbeats.push({date:r,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=ge}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=ve(),{heartbeatsToSend:r,unsentEntries:i}=_e(this._heartbeatsCache.heartbeats),n=(0,a.base64urlEncodeWithoutPadding)(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}}function ve(){return(new Date).toISOString().substring(0,10)}function _e(e,t=be){const a=[];let r=e.slice();for(const i of e){const e=a.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),Ce(a)>t){e.dates.pop();break}}else if(a.push({agent:i.agent,dates:[i.date]}),Ce(a)>t){a.pop();break}r=r.slice(1)}return{heartbeatsToSend:a,unsentEntries:r}}class we{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,a.isIndexedDBAvailable)()&&(0,a.validateIndexedDBOpenable)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await de(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return fe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return fe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}}}function Ce(e){return(0,a.base64urlEncodeWithoutPadding)(JSON.stringify({version:2,heartbeats:e})).length}function De(t){T(new e.Component("platform-logger",e=>new i(e),"PRIVATE")),T(new e.Component("heartbeat",e=>new me(e),"PRIVATE")),ie(s,o,t),ie(s,o,"esm2017"),ie("fire-js","")}De("");
},{"@firebase/component":"vhY9","@firebase/logger":"JJem","@firebase/util":"chA2","idb":"JZvK"}],"QtzL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/app");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r="firebase",t="10.12.2";(0,e.registerVersion)(r,t,"app");
},{"@firebase/app":"h2Mb"}],"WPde":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.Md5=exports.Integer=void 0;var r,o,i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e=exports.default={};(function(){var t;function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(t,r,o){o||(o=0);var i=Array(16);if("string"==typeof r)for(var e=0;16>e;++e)i[e]=r.charCodeAt(o++)|r.charCodeAt(o++)<<8|r.charCodeAt(o++)<<16|r.charCodeAt(o++)<<24;else for(e=0;16>e;++e)i[e]=r[o++]|r[o++]<<8|r[o++]<<16|r[o++]<<24;r=t.g[0],o=t.g[1],e=t.g[2];var n=t.g[3],h=r+(n^o&(e^n))+i[0]+3614090360&4294967295;h=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=o+(h<<7&4294967295|h>>>25))+((h=n+(e^r&(o^e))+i[1]+3905402710&4294967295)<<12&4294967295|h>>>20))+((h=e+(o^n&(r^o))+i[2]+606105819&4294967295)<<17&4294967295|h>>>15))+((h=o+(r^e&(n^r))+i[3]+3250441966&4294967295)<<22&4294967295|h>>>10))+((h=r+(n^o&(e^n))+i[4]+4118548399&4294967295)<<7&4294967295|h>>>25))+((h=n+(e^r&(o^e))+i[5]+1200080426&4294967295)<<12&4294967295|h>>>20))+((h=e+(o^n&(r^o))+i[6]+2821735955&4294967295)<<17&4294967295|h>>>15))+((h=o+(r^e&(n^r))+i[7]+4249261313&4294967295)<<22&4294967295|h>>>10))+((h=r+(n^o&(e^n))+i[8]+1770035416&4294967295)<<7&4294967295|h>>>25))+((h=n+(e^r&(o^e))+i[9]+2336552879&4294967295)<<12&4294967295|h>>>20))+((h=e+(o^n&(r^o))+i[10]+4294925233&4294967295)<<17&4294967295|h>>>15))+((h=o+(r^e&(n^r))+i[11]+2304563134&4294967295)<<22&4294967295|h>>>10))+((h=r+(n^o&(e^n))+i[12]+1804603682&4294967295)<<7&4294967295|h>>>25))+((h=n+(e^r&(o^e))+i[13]+4254626195&4294967295)<<12&4294967295|h>>>20))+((h=e+(o^n&(r^o))+i[14]+2792965006&4294967295)<<17&4294967295|h>>>15))+((h=o+(r^e&(n^r))+i[15]+1236535329&4294967295)<<22&4294967295|h>>>10))+((h=r+(e^n&(o^e))+i[1]+4129170786&4294967295)<<5&4294967295|h>>>27))+((h=n+(o^e&(r^o))+i[6]+3225465664&4294967295)<<9&4294967295|h>>>23))+((h=e+(r^o&(n^r))+i[11]+643717713&4294967295)<<14&4294967295|h>>>18))+((h=o+(n^r&(e^n))+i[0]+3921069994&4294967295)<<20&4294967295|h>>>12))+((h=r+(e^n&(o^e))+i[5]+3593408605&4294967295)<<5&4294967295|h>>>27))+((h=n+(o^e&(r^o))+i[10]+38016083&4294967295)<<9&4294967295|h>>>23))+((h=e+(r^o&(n^r))+i[15]+3634488961&4294967295)<<14&4294967295|h>>>18))+((h=o+(n^r&(e^n))+i[4]+3889429448&4294967295)<<20&4294967295|h>>>12))+((h=r+(e^n&(o^e))+i[9]+568446438&4294967295)<<5&4294967295|h>>>27))+((h=n+(o^e&(r^o))+i[14]+3275163606&4294967295)<<9&4294967295|h>>>23))+((h=e+(r^o&(n^r))+i[3]+4107603335&4294967295)<<14&4294967295|h>>>18))+((h=o+(n^r&(e^n))+i[8]+1163531501&4294967295)<<20&4294967295|h>>>12))+((h=r+(e^n&(o^e))+i[13]+2850285829&4294967295)<<5&4294967295|h>>>27))+((h=n+(o^e&(r^o))+i[2]+4243563512&4294967295)<<9&4294967295|h>>>23))+((h=e+(r^o&(n^r))+i[7]+1735328473&4294967295)<<14&4294967295|h>>>18))+((h=o+(n^r&(e^n))+i[12]+2368359562&4294967295)<<20&4294967295|h>>>12))+((h=r+(o^e^n)+i[5]+4294588738&4294967295)<<4&4294967295|h>>>28))+((h=n+(r^o^e)+i[8]+2272392833&4294967295)<<11&4294967295|h>>>21))+((h=e+(n^r^o)+i[11]+1839030562&4294967295)<<16&4294967295|h>>>16))+((h=o+(e^n^r)+i[14]+4259657740&4294967295)<<23&4294967295|h>>>9))+((h=r+(o^e^n)+i[1]+2763975236&4294967295)<<4&4294967295|h>>>28))+((h=n+(r^o^e)+i[4]+1272893353&4294967295)<<11&4294967295|h>>>21))+((h=e+(n^r^o)+i[7]+4139469664&4294967295)<<16&4294967295|h>>>16))+((h=o+(e^n^r)+i[10]+3200236656&4294967295)<<23&4294967295|h>>>9))+((h=r+(o^e^n)+i[13]+681279174&4294967295)<<4&4294967295|h>>>28))+((h=n+(r^o^e)+i[0]+3936430074&4294967295)<<11&4294967295|h>>>21))+((h=e+(n^r^o)+i[3]+3572445317&4294967295)<<16&4294967295|h>>>16))+((h=o+(e^n^r)+i[6]+76029189&4294967295)<<23&4294967295|h>>>9))+((h=r+(o^e^n)+i[9]+3654602809&4294967295)<<4&4294967295|h>>>28))+((h=n+(r^o^e)+i[12]+3873151461&4294967295)<<11&4294967295|h>>>21))+((h=e+(n^r^o)+i[15]+530742520&4294967295)<<16&4294967295|h>>>16))+((h=o+(e^n^r)+i[2]+3299628645&4294967295)<<23&4294967295|h>>>9))+((h=r+(e^(o|~n))+i[0]+4096336452&4294967295)<<6&4294967295|h>>>26))+((h=n+(o^(r|~e))+i[7]+1126891415&4294967295)<<10&4294967295|h>>>22))+((h=e+(r^(n|~o))+i[14]+2878612391&4294967295)<<15&4294967295|h>>>17))+((h=o+(n^(e|~r))+i[5]+4237533241&4294967295)<<21&4294967295|h>>>11))+((h=r+(e^(o|~n))+i[12]+1700485571&4294967295)<<6&4294967295|h>>>26))+((h=n+(o^(r|~e))+i[3]+2399980690&4294967295)<<10&4294967295|h>>>22))+((h=e+(r^(n|~o))+i[10]+4293915773&4294967295)<<15&4294967295|h>>>17))+((h=o+(n^(e|~r))+i[1]+2240044497&4294967295)<<21&4294967295|h>>>11))+((h=r+(e^(o|~n))+i[8]+1873313359&4294967295)<<6&4294967295|h>>>26))+((h=n+(o^(r|~e))+i[15]+4264355552&4294967295)<<10&4294967295|h>>>22))+((h=e+(r^(n|~o))+i[6]+2734768916&4294967295)<<15&4294967295|h>>>17))+((h=o+(n^(e|~r))+i[13]+1309151649&4294967295)<<21&4294967295|h>>>11))+((n=(r=o+((h=r+(e^(o|~n))+i[4]+4149444226&4294967295)<<6&4294967295|h>>>26))+((h=n+(o^(r|~e))+i[11]+3174756917&4294967295)<<10&4294967295|h>>>22))^((e=n+((h=e+(r^(n|~o))+i[2]+718787259&4294967295)<<15&4294967295|h>>>17))|~r))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+r&4294967295,t.g[1]=t.g[1]+(e+(h<<21&4294967295|h>>>11))&4294967295,t.g[2]=t.g[2]+e&4294967295,t.g[3]=t.g[3]+n&4294967295}function h(t,r){this.h=r;for(var o=[],i=!0,e=t.length-1;0<=e;e--){var n=0|t[e];i&&n==r||(o[e]=n,i=!1)}this.g=o}!function(t,r){function o(){}o.prototype=r.prototype,t.D=r.prototype,t.prototype=new o,t.prototype.constructor=t,t.C=function(t,o,i){for(var e=Array(arguments.length-2),n=2;n<arguments.length;n++)e[n-2]=arguments[n];return r.prototype[o].apply(t,e)}}(i,function(){this.blockSize=-1}),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},i.prototype.u=function(t,r){void 0===r&&(r=t.length);for(var o=r-this.blockSize,i=this.B,e=this.h,h=0;h<r;){if(0==e)for(;h<=o;)n(this,t,h),h+=this.blockSize;if("string"==typeof t){for(;h<r;)if(i[e++]=t.charCodeAt(h++),e==this.blockSize){n(this,i),e=0;break}}else for(;h<r;)if(i[e++]=t[h++],e==this.blockSize){n(this,i),e=0;break}}this.h=e,this.o+=r},i.prototype.v=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var r=1;r<t.length-8;++r)t[r]=0;var o=8*this.o;for(r=t.length-8;r<t.length;++r)t[r]=255&o,o/=256;for(this.u(t),t=Array(16),r=o=0;4>r;++r)for(var i=0;32>i;i+=8)t[o++]=this.g[r]>>>i&255;return t};var f={};function s(t){return-128<=t&&128>t?function(t,r){var o=f;return Object.prototype.hasOwnProperty.call(o,t)?o[t]:o[t]=r(t)}(t,function(t){return new h([0|t],0>t?-1:0)}):new h([0|t],0>t?-1:0)}function a(t){if(isNaN(t)||!isFinite(t))return g;if(0>t)return d(a(-t));for(var r=[],o=1,i=0;t>=o;i++)r[i]=t/o|0,o*=4294967296;return new h(r,0)}var g=s(0),u=s(1),p=s(16777216);function l(t){if(0!=t.h)return!1;for(var r=0;r<t.g.length;r++)if(0!=t.g[r])return!1;return!0}function c(t){return-1==t.h}function d(t){for(var r=t.g.length,o=[],i=0;i<r;i++)o[i]=~t.g[i];return new h(o,~t.h).add(u)}function y(t,r){return t.add(d(r))}function v(t,r){for(;(65535&t[r])!=t[r];)t[r+1]+=t[r]>>>16,t[r]&=65535,r++}function w(t,r){this.g=t,this.h=r}function m(t,r){if(l(r))throw Error("division by zero");if(l(t))return new w(g,g);if(c(t))return r=m(d(t),r),new w(d(r.g),d(r.h));if(c(r))return r=m(t,d(r)),new w(d(r.g),r.h);if(30<t.g.length){if(c(t)||c(r))throw Error("slowDivide_ only works with positive integers.");for(var o=u,i=r;0>=i.l(t);)o=b(o),i=b(i);var e=M(o,1),n=M(i,1);for(i=M(i,2),o=M(o,2);!l(i);){var h=n.add(i);0>=h.l(t)&&(e=e.add(o),n=h),i=M(i,1),o=M(o,1)}return r=y(t,e.j(r)),new w(e,r)}for(e=g;0<=t.l(r);){for(o=Math.max(1,Math.floor(t.m()/r.m())),i=48>=(i=Math.ceil(Math.log(o)/Math.LN2))?1:Math.pow(2,i-48),h=(n=a(o)).j(r);c(h)||0<h.l(t);)h=(n=a(o-=i)).j(r);l(n)&&(n=u),e=e.add(n),t=y(t,h)}return new w(e,t)}function b(t){for(var r=t.g.length+1,o=[],i=0;i<r;i++)o[i]=t.i(i)<<1|t.i(i-1)>>>31;return new h(o,t.h)}function M(t,r){var o=r>>5;r%=32;for(var i=t.g.length-o,e=[],n=0;n<i;n++)e[n]=0<r?t.i(n+o)>>>r|t.i(n+o+1)<<32-r:t.i(n+o);return new h(e,t.h)}(t=h.prototype).m=function(){if(c(this))return-d(this).m();for(var t=0,r=1,o=0;o<this.g.length;o++){var i=this.i(o);t+=(0<=i?i:4294967296+i)*r,r*=4294967296}return t},t.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(l(this))return"0";if(c(this))return"-"+d(this).toString(t);for(var r=a(Math.pow(t,6)),o=this,i="";;){var e=m(o,r).g,n=((0<(o=y(o,e.j(r))).g.length?o.g[0]:o.h)>>>0).toString(t);if(l(o=e))return n+i;for(;6>n.length;)n="0"+n;i=n+i}},t.i=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},t.l=function(t){return c(t=y(this,t))?-1:l(t)?0:1},t.abs=function(){return c(this)?d(this):this},t.add=function(t){for(var r=Math.max(this.g.length,t.g.length),o=[],i=0,e=0;e<=r;e++){var n=i+(65535&this.i(e))+(65535&t.i(e)),f=(n>>>16)+(this.i(e)>>>16)+(t.i(e)>>>16);i=f>>>16,n&=65535,f&=65535,o[e]=f<<16|n}return new h(o,-2147483648&o[o.length-1]?-1:0)},t.j=function(t){if(l(this)||l(t))return g;if(c(this))return c(t)?d(this).j(d(t)):d(d(this).j(t));if(c(t))return d(this.j(d(t)));if(0>this.l(p)&&0>t.l(p))return a(this.m()*t.m());for(var r=this.g.length+t.g.length,o=[],i=0;i<2*r;i++)o[i]=0;for(i=0;i<this.g.length;i++)for(var e=0;e<t.g.length;e++){var n=this.i(i)>>>16,f=65535&this.i(i),s=t.i(e)>>>16,u=65535&t.i(e);o[2*i+2*e]+=f*u,v(o,2*i+2*e),o[2*i+2*e+1]+=n*u,v(o,2*i+2*e+1),o[2*i+2*e+1]+=f*s,v(o,2*i+2*e+1),o[2*i+2*e+2]+=n*s,v(o,2*i+2*e+2)}for(i=0;i<r;i++)o[i]=o[2*i+1]<<16|o[2*i];for(i=r;i<2*r;i++)o[i]=0;return new h(o,0)},t.A=function(t){return m(this,t).h},t.and=function(t){for(var r=Math.max(this.g.length,t.g.length),o=[],i=0;i<r;i++)o[i]=this.i(i)&t.i(i);return new h(o,this.h&t.h)},t.or=function(t){for(var r=Math.max(this.g.length,t.g.length),o=[],i=0;i<r;i++)o[i]=this.i(i)|t.i(i);return new h(o,this.h|t.h)},t.xor=function(t){for(var r=Math.max(this.g.length,t.g.length),o=[],i=0;i<r;i++)o[i]=this.i(i)^t.i(i);return new h(o,this.h^t.h)},i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,exports.Md5=o=e.Md5=i,h.prototype.add=h.prototype.add,h.prototype.multiply=h.prototype.j,h.prototype.modulo=h.prototype.A,h.prototype.compare=h.prototype.l,h.prototype.toNumber=h.prototype.m,h.prototype.toString=h.prototype.toString,h.prototype.getBits=h.prototype.i,h.fromNumber=a,h.fromString=function t(r,o){if(0==r.length)throw Error("number format error: empty string");if(2>(o=o||10)||36<o)throw Error("radix out of range: "+o);if("-"==r.charAt(0))return d(t(r.substring(1),o));if(0<=r.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=a(Math.pow(o,8)),e=g,n=0;n<r.length;n+=8){var h=Math.min(8,r.length-n),f=parseInt(r.substring(n,n+h),o);8>h?(h=a(Math.pow(o,h)),e=e.j(h).add(a(f))):e=(e=e.j(i)).add(a(f))}return e},exports.Integer=r=e.Integer=h}).apply(void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});
},{}],"gTzP":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStatEventTarget=exports.default=exports.createWebChannelTransport=exports.XhrIo=exports.WebChannel=exports.Stat=exports.FetchXmlHttpFactory=exports.EventType=exports.Event=exports.ErrorCode=void 0;var e,i,n,s,r,o,h,a,l,u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},c=exports.default={};(function(){var t,f="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,i){return t==Array.prototype||t==Object.prototype?t:(t[e]=i.value,t)};var p=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof u&&u];for(var e=0;e<t.length;++e){var i=t[e];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}(this);!function(t,e){if(e)t:{var i=p;t=t.split(".");for(var n=0;n<t.length-1;n++){var s=t[n];if(!(s in i))break t;i=i[s]}(e=e(n=i[t=t[t.length-1]]))!=n&&null!=e&&f(i,t,{configurable:!0,writable:!0,value:e})}}("Array.prototype.values",function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var i=0,n=!1,s={next:function(){if(!n&&i<t.length){var s=i++;return{value:e(s,t[s]),done:!1}}return n=!0,{done:!0,value:void 0}}};return s[Symbol.iterator]=function(){return s},s}(this,function(t,e){return e})}});var g=g||{},d=this||self;function y(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function v(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function m(t,e,i){return t.call.apply(t.bind,arguments)}function b(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function w(t,e,i){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:b).apply(null,arguments)}function T(t,e){var i=Array.prototype.slice.call(arguments,1);return function(){var e=i.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function E(t,e){function i(){}i.prototype=e.prototype,t.aa=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.Qb=function(t,i,n){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return e.prototype[i].apply(t,s)}}function S(t){const e=t.length;if(0<e){const i=Array(e);for(let n=0;n<e;n++)i[n]=t[n];return i}return[]}function j(t,e){for(let i=1;i<arguments.length;i++){const e=arguments[i];if(y(e)){const i=t.length||0,n=e.length||0;t.length=i+n;for(let s=0;s<n;s++)t[i+s]=e[s]}else t.push(e)}}function C(t){return/^[\s\xa0]*$/.test(t)}function x(){var t=d.navigator;return t&&(t=t.userAgent)?t:""}function A(t){return A[" "](t),t}A[" "]=function(){};var I=!(-1==x().indexOf("Gecko")||-1!=x().toLowerCase().indexOf("webkit")&&-1==x().indexOf("Edge")||-1!=x().indexOf("Trident")||-1!=x().indexOf("MSIE")||-1!=x().indexOf("Edge"));function R(t,e,i){for(const n in t)e.call(i,t[n],n,t)}function O(t){const e={};for(const i in t)e[i]=t[i];return e}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(t,e){let i,n;for(let s=1;s<arguments.length;s++){for(i in n=arguments[s])t[i]=n[i];for(let e=0;e<P.length;e++)i=P[e],Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}}function _(t){var e=1;t=t.split(":");const i=[];for(;0<e&&t.length;)i.push(t.shift()),e--;return t.length&&i.push(t.join(":")),i}function D(t){d.setTimeout(()=>{throw t},0)}function L(){var t=F;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var H=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new X,t=>t.reset());class X{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}let k,B=!1,F=new class{constructor(){this.h=this.g=null}add(t,e){const i=H.get();i.set(t,e),this.h?this.h.next=i:this.g=i,this.h=i}},N=()=>{const t=d.Promise.resolve(void 0);k=(()=>{t.then(U)})};var U=()=>{for(var t;t=L();){try{t.h.call(t.g)}catch(i){D(i)}var e=H;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}B=!1};function K(){this.s=this.s,this.C=this.C}function G(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}K.prototype.s=!1,K.prototype.ma=function(){this.s||(this.s=!0,this.N())},K.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},G.prototype.h=function(){this.defaultPrevented=!0};var Y=function(){if(!d.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};d.addEventListener("test",t,e),d.removeEventListener("test",t,e)}catch(i){}return t}();function J(t,e){if(G.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var i=this.type=t.type,n=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(I){t:{try{A(e.nodeName);var s=!0;break t}catch(r){}s=!1}s||(e=null)}}else"mouseover"==i?e=t.fromElement:"mouseout"==i&&(e=t.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:W[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&J.aa.h.call(this)}}E(J,G);var W={2:"touch",3:"pen",4:"mouse"};J.prototype.h=function(){J.aa.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var q="closure_listenable_"+(1e6*Math.random()|0),V=0;function z(t,e,i,n,s){this.listener=t,this.proxy=null,this.src=e,this.type=i,this.capture=!!n,this.ha=s,this.key=++V,this.da=this.fa=!1}function Z(t){t.da=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function $(t){this.src=t,this.g={},this.h=0}function Q(t,e){var i=e.type;if(i in t.g){var n,s=t.g[i],r=Array.prototype.indexOf.call(s,e,void 0);(n=0<=r)&&Array.prototype.splice.call(s,r,1),n&&(Z(e),0==t.g[i].length&&(delete t.g[i],t.h--))}}function tt(t,e,i,n){for(var s=0;s<t.length;++s){var r=t[s];if(!r.da&&r.listener==e&&r.capture==!!i&&r.ha==n)return s}return-1}$.prototype.add=function(t,e,i,n,s){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var o=tt(t,e,n,s);return-1<o?(e=t[o],i||(e.fa=!1)):((e=new z(e,this.src,r,!!n,s)).fa=i,t.push(e)),e};var et="closure_lm_"+(1e6*Math.random()|0),it={};function nt(t,e,i,n,s){if(n&&n.once)return function t(e,i,n,s,r){if(Array.isArray(i)){for(var o=0;o<i.length;o++)t(e,i[o],n,s,r);return null}n=ut(n);return e&&e[q]?e.L(i,n,v(s)?!!s.capture:!!s,r):st(e,i,n,!0,s,r)}(t,e,i,n,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)nt(t,e[r],i,n,s);return null}return i=ut(i),t&&t[q]?t.K(e,i,v(n)?!!n.capture:!!n,s):st(t,e,i,!1,n,s)}function st(t,e,i,n,s,r){if(!e)throw Error("Invalid event type");var o=v(s)?!!s.capture:!!s,h=at(t);if(h||(t[et]=h=new $(t)),(i=h.add(e,i,n,o,r)).proxy)return i;if(n=function(){const t=ht;return function e(i){return t.call(e.src,e.listener,i)}}(),i.proxy=n,n.src=t,n.listener=i,t.addEventListener)Y||(s=o),void 0===s&&(s=!1),t.addEventListener(e.toString(),n,s);else if(t.attachEvent)t.attachEvent(ot(e.toString()),n);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(n)}return i}function rt(t){if("number"!=typeof t&&t&&!t.da){var e=t.src;if(e&&e[q])Q(e.i,t);else{var i=t.type,n=t.proxy;e.removeEventListener?e.removeEventListener(i,n,t.capture):e.detachEvent?e.detachEvent(ot(i),n):e.addListener&&e.removeListener&&e.removeListener(n),(i=at(e))?(Q(i,t),0==i.h&&(i.src=null,e[et]=null)):Z(t)}}}function ot(t){return t in it?it[t]:it[t]="on"+t}function ht(t,e){if(t.da)t=!0;else{e=new J(e,this);var i=t.listener,n=t.ha||t.src;t.fa&&rt(t),t=i.call(n,e)}return t}function at(t){return(t=t[et])instanceof $?t:null}var lt="__closure_events_fn_"+(1e9*Math.random()>>>0);function ut(t){return"function"==typeof t?t:(t[lt]||(t[lt]=function(e){return t.handleEvent(e)}),t[lt])}function ct(){K.call(this),this.i=new $(this),this.M=this,this.F=null}function ft(t,e){var i,n=t.F;if(n)for(i=[];n;n=n.F)i.push(n);if(t=t.M,n=e.type||e,"string"==typeof e)e=new G(e,t);else if(e instanceof G)e.target=e.target||t;else{var s=e;M(e=new G(n,t),s)}if(s=!0,i)for(var r=i.length-1;0<=r;r--){var o=e.g=i[r];s=pt(o,n,!0,e)&&s}if(s=pt(o=e.g=t,n,!0,e)&&s,s=pt(o,n,!1,e)&&s,i)for(r=0;r<i.length;r++)s=pt(o=e.g=i[r],n,!1,e)&&s}function pt(t,e,i,n){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.da&&o.capture==i){var h=o.listener,a=o.ha||o.src;o.fa&&Q(t.i,o),s=!1!==h.call(a,n)&&s}}return s&&!n.defaultPrevented}function gt(t,e,i){if("function"==typeof t)i&&(t=w(t,i));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=w(t.handleEvent,t)}return 2147483647<Number(e)?-1:d.setTimeout(t,e||0)}E(ct,K),ct.prototype[q]=!0,ct.prototype.removeEventListener=function(t,e,i,n){!function t(e,i,n,s,r){if(Array.isArray(i))for(var o=0;o<i.length;o++)t(e,i[o],n,s,r);else s=v(s)?!!s.capture:!!s,n=ut(n),e&&e[q]?(e=e.i,(i=String(i).toString())in e.g&&-1<(n=tt(o=e.g[i],n,s,r))&&(Z(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.g[i],e.h--))):e&&(e=at(e))&&(i=e.g[i.toString()],e=-1,i&&(e=tt(i,n,s,r)),(n=-1<e?i[e]:null)&&rt(n))}(this,t,e,i,n)},ct.prototype.N=function(){if(ct.aa.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var i=e.g[t],n=0;n<i.length;n++)Z(i[n]);delete e.g[t],e.h--}}this.F=null},ct.prototype.K=function(t,e,i,n){return this.i.add(String(t),e,!1,i,n)},ct.prototype.L=function(t,e,i,n){return this.i.add(String(t),e,!0,i,n)};class dt extends K{constructor(t,e){super(),this.m=t,this.l=e,this.h=null,this.i=!1,this.g=null}j(t){this.h=arguments,this.g?this.i=!0:function t(e){e.g=gt(()=>{e.g=null,e.i&&(e.i=!1,t(e))},e.l);const i=e.h;e.h=null,e.m.apply(null,i)}(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yt(t){K.call(this),this.h=t,this.g={}}E(yt,K);var vt=[];function mt(t){R(t.g,function(t,e){this.g.hasOwnProperty(e)&&rt(t)},t),t.g={}}yt.prototype.N=function(){yt.aa.N.call(this),mt(this)},yt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var bt=d.JSON.stringify,wt=d.JSON.parse,Tt=class{stringify(t){return d.JSON.stringify(t,void 0)}parse(t){return d.JSON.parse(t,void 0)}};function Et(){}function St(t){return t.h||(t.h=t.i())}function jt(){}Et.prototype.h=null;var Ct={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xt(){G.call(this,"d")}function At(){G.call(this,"c")}E(xt,G),E(At,G);var It={},Rt=null;function Ot(){return Rt=Rt||new ct}function Pt(t){G.call(this,It.La,t)}function Mt(t){const e=Ot();ft(e,new Pt(e))}function _t(t,e){G.call(this,It.STAT_EVENT,t),this.stat=e}function Dt(t){const e=Ot();ft(e,new _t(e,t))}function Lt(t,e){G.call(this,It.Ma,t),this.size=e}function Ht(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){t()},e)}function Xt(){this.g=!0}function kt(t,e,i,n){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var i=JSON.parse(e);if(i)for(t=0;t<i.length;t++)if(Array.isArray(i[t])){var n=i[t];if(!(2>n.length)){var s=n[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<s.length;o++)s[o]=""}}}return bt(i)}catch(h){return e}}(t,i)+(n?" "+n:"")})}It.La="serverreachability",E(Pt,G),It.STAT_EVENT="statevent",E(_t,G),It.Ma="timingevent",E(Lt,G),Xt.prototype.xa=function(){this.g=!1},Xt.prototype.info=function(){};var Bt,Ft={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Nt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Ut(){}function Kt(t,e,i,n){this.j=t,this.i=e,this.l=i,this.R=n||1,this.U=new yt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gt}function Gt(){this.i=null,this.g="",this.h=!1}E(Ut,Et),Ut.prototype.g=function(){return new XMLHttpRequest},Ut.prototype.i=function(){return{}},Bt=new Ut;var Yt={},Jt={};function Wt(t,e,i){t.L=1,t.v=me(pe(e)),t.m=i,t.P=!0,qt(t,null)}function qt(t,e){t.F=Date.now(),Zt(t),t.A=pe(t.v);var i=t.A,n=t.R;Array.isArray(n)||(n=[String(n)]),Me(i.i,"t",n),t.C=0,i=t.j.J,t.h=new Gt,t.g=bi(t.j,i?e:null,!t.m),0<t.O&&(t.M=new dt(w(t.Y,t,t.g),t.O)),e=t.U,i=t.g,n=t.ca;var s="readystatechange";Array.isArray(s)||(s&&(vt[0]=s.toString()),s=vt);for(var r=0;r<s.length;r++){var o=nt(i,s[r],n||e.handleEvent,!1,e.h||e);if(!o)break;e.g[o.key]=o}e=t.H?O(t.H):{},t.m?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.m,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Mt(),function(t,e,i,n,s,r){t.info(function(){if(t.g)if(r)for(var o="",h=r.split("&"),a=0;a<h.length;a++){var l=h[a].split("=");if(1<l.length){var u=l[0];l=l[1];var c=u.split("_");o=2<=c.length&&"type"==c[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+n+") [attempt "+s+"]: "+e+"\n"+i+"\n"+o})}(t.i,t.u,t.A,t.l,t.R,t.m)}function Vt(t){return!!t.g&&("GET"==t.u&&2!=t.L&&t.j.Ca)}function zt(t,e){var i=t.C,n=e.indexOf("\n",i);return-1==n?Jt:(i=Number(e.substring(i,n)),isNaN(i)?Yt:(n+=1)+i>e.length?Jt:(e=e.slice(n,n+i),t.C=n+i,e))}function Zt(t){t.S=Date.now()+t.I,$t(t,t.I)}function $t(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Ht(w(t.ba,t),e)}function Qt(t){t.B&&(d.clearTimeout(t.B),t.B=null)}function te(t){0==t.j.G||t.J||gi(t.j,t)}function ee(t){Qt(t);var e=t.M;e&&"function"==typeof e.ma&&e.ma(),t.M=null,mt(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.ma())}function ie(t,e){try{var i=t.j;if(0!=i.G&&(i.g==t||oe(i.h,t)))if(!t.K&&oe(i.h,t)&&3==i.G){try{var n=i.Da.g.parse(e)}catch(l){n=null}if(Array.isArray(n)&&3==n.length){var s=n;if(0==s[0]){t:if(!i.u){if(i.g){if(!(i.g.F+3e3<t.F))break t;pi(i),ni(i)}ui(i),Dt(18)}}else i.za=s[1],0<i.za-i.T&&37500>s[2]&&i.F&&0==i.v&&!i.C&&(i.C=Ht(w(i.Za,i),6e3));if(1>=re(i.h)&&i.ca){try{i.ca()}catch(l){}i.ca=void 0}}else yi(i,11)}else if((t.K||i.g==t)&&pi(i),!C(e))for(s=i.Da.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(i.T=l[0],l=l[1],2==i.G)if("c"==l[0]){i.K=l[1],i.ia=l[2];const e=l[3];null!=e&&(i.la=e,i.j.info("VER="+i.la));const s=l[4];null!=s&&(i.Aa=s,i.j.info("SVER="+i.Aa));const u=l[5];null!=u&&"number"==typeof u&&0<u&&(n=1.5*u,i.L=n,i.j.info("backChannelRequestTimeoutMs_="+n)),n=i;const c=t.g;if(c){const t=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=n.h;r.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(he(r,r.h),r.h=null))}if(n.D){const t=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(n.ya=t,ve(n.I,n.D,t))}}i.G=3,i.l&&i.l.ua(),i.ba&&(i.R=Date.now()-t.F,i.j.info("Handshake RTT: "+i.R+"ms"));var o=t;if((n=i).qa=mi(n,n.J?n.ia:null,n.W),o.K){ae(n.h,o);var h=o,a=n.L;a&&(h.I=a),h.B&&(Qt(h),Zt(h)),n.g=o}else li(n);0<i.i.length&&ri(i)}else"stop"!=l[0]&&"close"!=l[0]||yi(i,7);else 3==i.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?yi(i,7):ii(i):"noop"!=l[0]&&i.l&&i.l.ta(l),i.v=0)}Mt()}catch(l){}}Kt.prototype.ca=function(t){t=t.target;const e=this.M;e&&3==$e(t)?e.j():this.Y(t)},Kt.prototype.Y=function(t){try{if(t==this.g)t:{const c=$e(this.g);var e=this.g.Ba();this.g.Z();if(!(3>c)&&(3!=c||this.g&&(this.h.h||this.g.oa()||Qe(this.g)))){this.J||4!=c||7==e||Mt(),Qt(this);var i=this.g.Z();this.X=i;e:if(Vt(this)){var n=Qe(this.g);t="";var s=n.length,r=4==$e(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ee(this),te(this);var o="";break e}this.h.i=new d.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(n[e],{stream:!(r&&e==s-1)});n.length=0,this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==i,function(t,e,i,n,s,r,o){t.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+s+"]: "+e+"\n"+i+"\n"+r+" "+o})}(this.i,this.u,this.A,this.l,this.R,c,i),this.o){if(this.T&&!this.K){e:{if(this.g){var h,a=this.g;if((h=a.g?a.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(h)){var l=h;break e}}l=null}if(!(i=l)){this.o=!1,this.s=3,Dt(12),ee(this),te(this);break t}kt(this.i,this.l,i,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ie(this,i)}if(this.P){let t;for(i=!0;!this.J&&this.C<o.length;){if((t=zt(this,o))==Jt){4==c&&(this.s=4,Dt(14),i=!1),kt(this.i,this.l,null,"[Incomplete Response]");break}if(t==Yt){this.s=4,Dt(15),kt(this.i,this.l,o,"[Invalid Chunk]"),i=!1;break}kt(this.i,this.l,t,null),ie(this,t)}if(Vt(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=c||0!=o.length||this.h.h||(this.s=1,Dt(16),i=!1),this.o=this.o&&i,i){if(0<o.length&&!this.W){this.W=!0;var u=this.j;u.g==this&&u.ba&&!u.M&&(u.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),ci(u),u.M=!0,Dt(11))}}else kt(this.i,this.l,o,"[Invalid Chunked Response]"),ee(this),te(this)}else kt(this.i,this.l,o,null),ie(this,o);4==c&&ee(this),this.o&&!this.J&&(4==c?gi(this.j,this):(this.o=!1,Zt(this)))}else(function(t){const e={};t=(t.g&&2<=$e(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<t.length;n++){if(C(t[n]))continue;var i=_(t[n]);const s=i[0];if("string"!=typeof(i=i[1]))continue;i=i.trim();const r=e[s]||[];e[s]=r,r.push(i)}!function(t,e){for(const i in t)e.call(void 0,t[i],i,t)}(e,function(t){return t.join(", ")})})(this.g),400==i&&0<o.indexOf("Unknown SID")?(this.s=3,Dt(12)):(this.s=0,Dt(13)),ee(this),te(this)}}}catch(c){}},Kt.prototype.cancel=function(){this.J=!0,ee(this)},Kt.prototype.ba=function(){this.B=null;const t=Date.now();0<=t-this.S?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.i,this.A),2!=this.L&&(Mt(),Dt(17)),ee(this),this.s=2,te(this)):$t(this,this.S-t)};function ne(t){this.l=t||10,d.PerformanceNavigationTiming?t=0<(t=d.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function se(t){return!!t.h||!!t.g&&t.g.size>=t.j}function re(t){return t.h?1:t.g?t.g.size:0}function oe(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function he(t,e){t.g?t.g.add(e):t.h=e}function ae(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function le(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const i of t.g.values())e=e.concat(i.D);return e}return S(t.i)}function ue(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(y(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var i=function(t){if(t.na&&"function"==typeof t.na)return t.na();if(!t.V||"function"!=typeof t.V){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(y(t)||"string"==typeof t){var e=[];t=t.length;for(var i=0;i<t;i++)e.push(i);return e}e=[],i=0;for(const n in t)e[i++]=n;return e}}}(t),n=function(t){if(t.V&&"function"==typeof t.V)return t.V();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(y(t)){for(var e=[],i=t.length,n=0;n<i;n++)e.push(t[n]);return e}for(n in e=[],i=0,t)e[i++]=t[n];return e}(t),s=n.length,r=0;r<s;r++)e.call(void 0,n[r],i&&i[r],t)}ne.prototype.cancel=function(){if(this.i=le(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var ce=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fe(t){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,t instanceof fe){this.h=t.h,ge(this,t.j),this.o=t.o,this.g=t.g,de(this,t.s),this.l=t.l;var e=t.i,i=new Ie;i.i=e.i,e.g&&(i.g=new Map(e.g),i.h=e.h),ye(this,i),this.m=t.m}else t&&(e=String(t).match(ce))?(this.h=!1,ge(this,e[1]||"",!0),this.o=be(e[2]||""),this.g=be(e[3]||"",!0),de(this,e[4]),this.l=be(e[5]||"",!0),ye(this,e[6]||"",!0),this.m=be(e[7]||"")):(this.h=!1,this.i=new Ie(null,this.h))}function pe(t){return new fe(t)}function ge(t,e,i){t.j=i?be(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function de(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.s=e}else t.s=null}function ye(t,e,i){e instanceof Ie?(t.i=e,function(t,e){e&&!t.j&&(Re(t),t.i=null,t.g.forEach(function(t,e){var i=e.toLowerCase();e!=i&&(Oe(this,e),Me(this,i,t))},t)),t.j=e}(t.i,t.h)):(i||(e=we(e,xe)),t.i=new Ie(e,t.h))}function ve(t,e,i){t.i.set(e,i)}function me(t){return ve(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function be(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function we(t,e,i){return"string"==typeof t?(t=encodeURI(t).replace(e,Te),i&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Te(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}fe.prototype.toString=function(){var t=[],e=this.j;e&&t.push(we(e,Se,!0),":");var i=this.g;return(i||"file"==e)&&(t.push("//"),(e=this.o)&&t.push(we(e,Se,!0),"@"),t.push(encodeURIComponent(String(i)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(i=this.s)&&t.push(":",String(i))),(i=this.l)&&(this.g&&"/"!=i.charAt(0)&&t.push("/"),t.push(we(i,"/"==i.charAt(0)?Ce:je,!0))),(i=this.i.toString())&&t.push("?",i),(i=this.m)&&t.push("#",we(i,Ae)),t.join("")};var Ee,Se=/[#\/\?@]/g,je=/[#\?:]/g,Ce=/[#\?]/g,xe=/[#\?@]/g,Ae=/#/g;function Ie(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Re(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var i=0;i<t.length;i++){var n=t[i].indexOf("="),s=null;if(0<=n){var r=t[i].substring(0,n);s=t[i].substring(n+1)}else r=t[i];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.i,function(e,i){t.add(decodeURIComponent(e.replace(/\+/g," ")),i)}))}function Oe(t,e){Re(t),e=_e(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Pe(t,e){return Re(t),e=_e(t,e),t.g.has(e)}function Me(t,e,i){Oe(t,e),0<i.length&&(t.i=null,t.g.set(_e(t,e),S(i)),t.h+=i.length)}function _e(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function De(t,e,i,n,s){try{s&&(s.onload=null,s.onerror=null,s.onabort=null,s.ontimeout=null),n(i)}catch(r){}}function Le(){this.g=new Tt}function He(t,e,i){const n=i||"";try{ue(t,function(t,i){let s=t;v(t)&&(s=bt(t)),e.push(n+i+"="+encodeURIComponent(s))})}catch(s){throw e.push(n+"type="+encodeURIComponent("_badmap")),s}}function Xe(t){this.l=t.Ub||null,this.j=t.eb||!1}function ke(t,e){ct.call(this),this.D=t,this.o=e,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Be(t){t.j.read().then(t.Pa.bind(t)).catch(t.ga.bind(t))}function Fe(t){t.readyState=4,t.l=null,t.j=null,t.v=null,Ne(t)}function Ne(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Ue(t){let e="";return R(t,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function Ke(t,e,i){t:{for(n in i){var n=!1;break t}n=!0}n||(i=Ue(i),"string"==typeof t?null!=i&&encodeURIComponent(String(i)):ve(t,e,i))}function Ge(t){ct.call(this),this.headers=new Map,this.o=t||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(t=Ie.prototype).add=function(t,e){Re(this),this.i=null,t=_e(this,t);var i=this.g.get(t);return i||this.g.set(t,i=[]),i.push(e),this.h+=1,this},t.forEach=function(t,e){Re(this),this.g.forEach(function(i,n){i.forEach(function(i){t.call(e,i,n,this)},this)},this)},t.na=function(){Re(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),i=[];for(let n=0;n<e.length;n++){const s=t[n];for(let t=0;t<s.length;t++)i.push(e[n])}return i},t.V=function(t){Re(this);let e=[];if("string"==typeof t)Pe(this,t)&&(e=e.concat(this.g.get(_e(this,t))));else{t=Array.from(this.g.values());for(let i=0;i<t.length;i++)e=e.concat(t[i])}return e},t.set=function(t,e){return Re(this),this.i=null,Pe(this,t=_e(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var i=0;i<e.length;i++){var n=e[i];const r=encodeURIComponent(String(n)),o=this.V(n);for(n=0;n<o.length;n++){var s=r;""!==o[n]&&(s+="="+encodeURIComponent(String(o[n]))),t.push(s)}}return this.i=t.join("&")},E(Xe,Et),Xe.prototype.g=function(){return new ke(this.l,this.j)},Xe.prototype.i=(Ee={},function(){return Ee}),E(ke,ct),(t=ke.prototype).open=function(t,e){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=t,this.A=e,this.readyState=1,Ne(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.u,method:this.B,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||d).fetch(new Request(this.A,e)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Fe(this)),this.readyState=0},t.Sa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ne(this)),this.g&&(this.readyState=3,Ne(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==d.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Be(this)}else t.text().then(this.Ra.bind(this),this.ga.bind(this))},t.Pa=function(t){if(this.g){if(this.o&&t.value)this.response.push(t.value);else if(!this.o){var e=t.value?t.value:new Uint8Array(0);(e=this.v.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Fe(this):Ne(this),3==this.readyState&&Be(this)}},t.Ra=function(t){this.g&&(this.response=this.responseText=t,Fe(this))},t.Qa=function(t){this.g&&(this.response=t,Fe(this))},t.ga=function(){this.g&&Fe(this)},t.setRequestHeader=function(t,e){this.u.append(t,e)},t.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var i=e.next();!i.done;)i=i.value,t.push(i[0]+": "+i[1]),i=e.next();return t.join("\r\n")},Object.defineProperty(ke.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}}),E(Ge,ct);var Ye=/^https?$/i,Je=["POST","PUT"];function We(t,e){t.h=!1,t.g&&(t.j=!0,t.g.abort(),t.j=!1),t.l=e,t.m=5,qe(t),ze(t)}function qe(t){t.A||(t.A=!0,ft(t,"complete"),ft(t,"error"))}function Ve(t){if(t.h&&void 0!==g&&(!t.v[1]||4!=$e(t)||2!=t.Z()))if(t.u&&4==$e(t))gt(t.Ea,0,t);else if(ft(t,"readystatechange"),4==$e(t)){t.h=!1;try{const h=t.Z();t:switch(h){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var i;if(!(i=e)){var n;if(n=0===h){var s=String(t.D).match(ce)[1]||null;!s&&d.self&&d.self.location&&(s=d.self.location.protocol.slice(0,-1)),n=!Ye.test(s?s.toLowerCase():"")}i=n}if(i)ft(t,"complete"),ft(t,"success");else{t.m=6;try{var r=2<$e(t)?t.g.statusText:""}catch(o){r=""}t.l=r+" ["+t.Z()+"]",qe(t)}}finally{ze(t)}}}function ze(t,e){if(t.g){Ze(t);const n=t.g,s=t.v[0]?()=>{}:null;t.g=null,t.v=null,e||ft(t,"ready");try{n.onreadystatechange=s}catch(i){}}}function Ze(t){t.I&&(d.clearTimeout(t.I),t.I=null)}function $e(t){return t.g?t.g.readyState:0}function Qe(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.H){case"":case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function ti(t,e,i){return i&&i.internalChannelParams&&i.internalChannelParams[t]||e}function ei(t){this.Aa=0,this.i=[],this.j=new Xt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ti("failFast",!1,t),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ti("baseRetryDelayMs",5e3,t),this.cb=ti("retryDelaySeedMs",1e4,t),this.Wa=ti("forwardChannelMaxRetries",2,t),this.wa=ti("forwardChannelRequestTimeoutMs",2e4,t),this.pa=t&&t.xmlHttpFactory||void 0,this.Xa=t&&t.Tb||void 0,this.Ca=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.h=new ne(t&&t.concurrentRequestLimit),this.Da=new Le,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=t&&t.Rb||!1,t&&t.xa&&this.j.xa(),t&&t.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&t&&t.detectBufferingProxy||!1,this.ja=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.ja=t.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function ii(t){if(si(t),3==t.G){var e=t.U++,i=pe(t.I);if(ve(i,"SID",t.K),ve(i,"RID",e),ve(i,"TYPE","terminate"),hi(t,i),(e=new Kt(t,t.j,e)).L=2,e.v=me(pe(i)),i=!1,d.navigator&&d.navigator.sendBeacon)try{i=d.navigator.sendBeacon(e.v.toString(),"")}catch(n){}!i&&d.Image&&((new Image).src=e.v,i=!0),i||(e.g=bi(e.j,null),e.g.ea(e.v)),e.F=Date.now(),Zt(e)}vi(t)}function ni(t){t.g&&(ci(t),t.g.cancel(),t.g=null)}function si(t){ni(t),t.u&&(d.clearTimeout(t.u),t.u=null),pi(t),t.h.cancel(),t.s&&("number"==typeof t.s&&d.clearTimeout(t.s),t.s=null)}function ri(t){if(!se(t.h)&&!t.s){t.s=!0;var e=t.Ga;k||N(),B||(k(),B=!0),F.add(e,t),t.B=0}}function oi(t,e){var i;i=e?e.l:t.U++;const n=pe(t.I);ve(n,"SID",t.K),ve(n,"RID",i),ve(n,"AID",t.T),hi(t,n),t.m&&t.o&&Ke(n,t.m,t.o),i=new Kt(t,t.j,i,t.B+1),null===t.m&&(i.H=t.o),e&&(t.i=e.D.concat(t.i)),e=ai(t,i,1e3),i.I=Math.round(.5*t.wa)+Math.round(.5*t.wa*Math.random()),he(t.h,i),Wt(i,n,e)}function hi(t,e){t.H&&R(t.H,function(t,i){ve(e,i,t)}),t.l&&ue({},function(t,i){ve(e,i,t)})}function ai(t,e,i){i=Math.min(t.i.length,i);var n=t.l?w(t.l.Na,t.l,t):null;t:{var s=t.i;let e=-1;for(;;){const t=["count="+i];-1==e?0<i?(e=s[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let o=!0;for(let h=0;h<i;h++){let i=s[h].g;const a=s[h].map;if(0>(i-=e))e=Math.max(0,s[h].g-100),o=!1;else try{He(a,t,"req"+i+"_")}catch(r){n&&n(a)}}if(o){n=t.join("&");break t}}}return t=t.i.splice(0,i),e.D=t,n}function li(t){if(!t.g&&!t.u){t.Y=1;var e=t.Fa;k||N(),B||(k(),B=!0),F.add(e,t),t.v=0}}function ui(t){return!(t.g||t.u||3<=t.v)&&(t.Y++,t.u=Ht(w(t.Fa,t),di(t,t.v)),t.v++,!0)}function ci(t){null!=t.A&&(d.clearTimeout(t.A),t.A=null)}function fi(t){t.g=new Kt(t,t.j,"rpc",t.Y),null===t.m&&(t.g.H=t.o),t.g.O=0;var e=pe(t.qa);ve(e,"RID","rpc"),ve(e,"SID",t.K),ve(e,"AID",t.T),ve(e,"CI",t.F?"0":"1"),!t.F&&t.ja&&ve(e,"TO",t.ja),ve(e,"TYPE","xmlhttp"),hi(t,e),t.m&&t.o&&Ke(e,t.m,t.o),t.L&&(t.g.I=t.L);var i=t.g;t=t.ia,i.L=1,i.v=me(pe(e)),i.m=null,i.P=!0,qt(i,t)}function pi(t){null!=t.C&&(d.clearTimeout(t.C),t.C=null)}function gi(t,e){var i=null;if(t.g==e){pi(t),ci(t),t.g=null;var n=2}else{if(!oe(t.h,e))return;i=e.D,ae(t.h,e),n=1}if(0!=t.G)if(e.o)if(1==n){i=e.m?e.m.length:0,e=Date.now()-e.F;var s=t.B;ft(n=Ot(),new Lt(n,i)),ri(t)}else li(t);else if(3==(s=e.s)||0==s&&0<e.X||!(1==n&&function(t,e){return!(re(t.h)>=t.h.j-(t.s?1:0)||(t.s?(t.i=e.D.concat(t.i),0):1==t.G||2==t.G||t.B>=(t.Va?0:t.Wa)||(t.s=Ht(w(t.Ga,t,e),di(t,t.B)),t.B++,0)))}(t,e)||2==n&&ui(t)))switch(i&&0<i.length&&(e=t.h,e.i=e.i.concat(i)),s){case 1:yi(t,5);break;case 4:yi(t,10);break;case 3:yi(t,6);break;default:yi(t,2)}}function di(t,e){let i=t.Ta+Math.floor(Math.random()*t.cb);return t.isActive()||(i*=2),i*e}function yi(t,e){if(t.j.info("Error code "+e),2==e){var i=w(t.fb,t),n=t.Xa;const e=!n;n=new fe(n||"//www.google.com/images/cleardot.gif"),d.location&&"http"==d.location.protocol||ge(n,"https"),me(n),e?function(t,e){const i=new Xt;if(d.Image){const n=new Image;n.onload=T(De,i,"TestLoadImage: loaded",!0,e,n),n.onerror=T(De,i,"TestLoadImage: error",!1,e,n),n.onabort=T(De,i,"TestLoadImage: abort",!1,e,n),n.ontimeout=T(De,i,"TestLoadImage: timeout",!1,e,n),d.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=t}else e(!1)}(n.toString(),i):function(t,e){new Xt;const i=new AbortController,n=setTimeout(()=>{i.abort(),De(0,0,!1,e)},1e4);fetch(t,{signal:i.signal}).then(t=>{clearTimeout(n),t.ok?De(0,0,!0,e):De(0,0,!1,e)}).catch(()=>{clearTimeout(n),De(0,0,!1,e)})}(n.toString(),i)}else Dt(2);t.G=0,t.l&&t.l.sa(e),vi(t),si(t)}function vi(t){if(t.G=0,t.ka=[],t.l){const e=le(t.h);0==e.length&&0==t.i.length||(j(t.ka,e),j(t.ka,t.i),t.h.i.length=0,S(t.i),t.i.length=0),t.l.ra()}}function mi(t,e,i){var n=i instanceof fe?pe(i):new fe(i);if(""!=n.g)e&&(n.g=e+"."+n.g),de(n,n.s);else{var s=d.location;n=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var r=new fe(null);n&&ge(r,n),e&&(r.g=e),s&&de(r,s),i&&(r.l=i),n=r}return i=t.D,e=t.ya,i&&e&&ve(n,i,e),ve(n,"VER",t.la),hi(t,n),n}function bi(t,e,i){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ca&&!t.pa?new Ge(new Xe({eb:i})):new Ge(t.pa)).Ha(t.J),e}function wi(){}function Ti(){}function Ei(t,e){ct.call(this),this.g=new ei(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.o=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.va&&(t?t["X-WebChannel-Client-Profile"]=e.va:t={"X-WebChannel-Client-Profile":e.va}),this.g.S=t,(t=e&&e.Sb)&&!C(t)&&(this.g.m=t),this.v=e&&e.supportsCrossDomainXhr||!1,this.u=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!C(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Ci(this)}function Si(t){xt.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const i in e){t=i;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function ji(){At.call(this),this.status=1}function Ci(t){this.g=t}(t=Ge.prototype).Ha=function(t){this.J=t},t.ea=function(t,e,i,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Bt.g(),this.v=this.o?St(this.o):St(Bt),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(e,String(t),!0),this.B=!1}catch(r){return void We(this,r)}if(t=i||"",i=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var s in n)i.set(s,n[s]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const t of n.keys())i.set(t,n.get(t))}n=Array.from(i.keys()).find(t=>"content-type"==t.toLowerCase()),s=d.FormData&&t instanceof d.FormData,!(0<=Array.prototype.indexOf.call(Je,e,void 0))||n||s||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,h]of i)this.g.setRequestHeader(o,h);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ze(this),this.u=!0,this.g.send(t),this.u=!1}catch(r){We(this,r)}},t.abort=function(t){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=t||7,ft(this,"complete"),ft(this,"abort"),ze(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ze(this,!0)),Ge.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ve(this):this.bb())},t.bb=function(){Ve(this)},t.isActive=function(){return!!this.g},t.Z=function(){try{return 2<$e(this)?this.g.status:-1}catch(Ee){return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch(Ee){return""}},t.Oa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),wt(e)}},t.Ba=function(){return this.m},t.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(t=ei.prototype).la=8,t.G=1,t.connect=function(t,e,i,n){Dt(0),this.W=t,this.H=e||{},i&&void 0!==n&&(this.H.OSID=i,this.H.OAID=n),this.F=this.X,this.I=mi(this,null,this.W),ri(this)},t.Ga=function(t){if(this.s)if(this.s=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const s=new Kt(this,this.j,t);let r=this.o;if(this.S&&(r?M(r=O(r),this.S):r=this.S),null!==this.m||this.O||(s.H=r,r=null),this.P)t:{for(var e=0,i=0;i<this.i.length;i++){var n=this.i[i];if(void 0===(n="__data__"in n.map&&"string"==typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=i;break t}if(4096===e||i===this.i.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=ai(this,s,e),ve(i=pe(this.I),"RID",t),ve(i,"CVER",22),this.D&&ve(i,"X-HTTP-Session-Id",this.D),hi(this,i),r&&(this.O?e="headers="+encodeURIComponent(String(Ue(r)))+"&"+e:this.m&&Ke(i,this.m,r)),he(this.h,s),this.Ua&&ve(i,"TYPE","init"),this.P?(ve(i,"$req",e),ve(i,"SID","null"),s.T=!0,Wt(s,i,null)):Wt(s,i,e),this.G=2}}else 3==this.G&&(t?oi(this,t):0==this.i.length||se(this.h)||oi(this))},t.Fa=function(){if(this.u=null,fi(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var t=2*this.R;this.j.info("BP detection timer enabled: "+t),this.A=Ht(w(this.ab,this),t)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Dt(10),ni(this),fi(this))},t.Za=function(){null!=this.C&&(this.C=null,ni(this),ui(this),Dt(19))},t.fb=function(t){t?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=wi.prototype).ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){},Ti.prototype.g=function(t,e){return new Ei(t,e)},E(Ei,ct),Ei.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ei.prototype.close=function(){ii(this.g)},Ei.prototype.o=function(t){var e=this.g;if("string"==typeof t){var i={};i.__data__=t,t=i}else this.u&&((i={}).__data__=bt(t),t=i);e.i.push(new class{constructor(t,e){this.g=t,this.map=e}}(e.Ya++,t)),3==e.G&&ri(e)},Ei.prototype.N=function(){this.g.l=null,delete this.j,ii(this.g),delete this.g,Ei.aa.N.call(this)},E(Si,xt),E(ji,At),E(Ci,wi),Ci.prototype.ua=function(){ft(this.g,"a")},Ci.prototype.ta=function(t){ft(this.g,new Si(t))},Ci.prototype.sa=function(t){ft(this.g,new ji)},Ci.prototype.ra=function(){ft(this.g,"b")},Ti.prototype.createWebChannel=Ti.prototype.g,Ei.prototype.send=Ei.prototype.o,Ei.prototype.open=Ei.prototype.m,Ei.prototype.close=Ei.prototype.close,exports.createWebChannelTransport=l=c.createWebChannelTransport=function(){return new Ti},exports.getStatEventTarget=a=c.getStatEventTarget=function(){return Ot()},exports.Event=h=c.Event=It,exports.Stat=o=c.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ft.NO_ERROR=0,Ft.TIMEOUT=8,Ft.HTTP_ERROR=6,exports.ErrorCode=r=c.ErrorCode=Ft,Nt.COMPLETE="complete",exports.EventType=s=c.EventType=Nt,jt.EventType=Ct,Ct.OPEN="a",Ct.CLOSE="b",Ct.ERROR="c",Ct.MESSAGE="d",ct.prototype.listen=ct.prototype.K,exports.WebChannel=n=c.WebChannel=jt,exports.FetchXmlHttpFactory=i=c.FetchXmlHttpFactory=Xe,Ge.prototype.listenOnce=Ge.prototype.L,Ge.prototype.getLastError=Ge.prototype.Ka,Ge.prototype.getLastErrorCode=Ge.prototype.Ba,Ge.prototype.getStatus=Ge.prototype.Z,Ge.prototype.getResponseJson=Ge.prototype.Oa,Ge.prototype.getResponseText=Ge.prototype.oa,Ge.prototype.send=Ge.prototype.ea,Ge.prototype.setWithCredentials=Ge.prototype.Ha,exports.XhrIo=e=c.XhrIo=Ge}).apply(void 0!==u?u:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});
},{}],"yh9p":[function(require,module,exports) {
"use strict";exports.byteLength=u,exports.toByteArray=i,exports.fromByteArray=d;for(var r=[],t=[],e="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)r[o]=n[o],t[n.charCodeAt(o)]=o;function h(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}function u(r){var t=h(r),e=t[0],n=t[1];return 3*(e+n)/4-n}function c(r,t,e){return 3*(t+e)/4-e}function i(r){var n,o,a=h(r),u=a[0],i=a[1],f=new e(c(r,u,i)),A=0,d=i>0?u-4:u;for(o=0;o<d;o+=4)n=t[r.charCodeAt(o)]<<18|t[r.charCodeAt(o+1)]<<12|t[r.charCodeAt(o+2)]<<6|t[r.charCodeAt(o+3)],f[A++]=n>>16&255,f[A++]=n>>8&255,f[A++]=255&n;return 2===i&&(n=t[r.charCodeAt(o)]<<2|t[r.charCodeAt(o+1)]>>4,f[A++]=255&n),1===i&&(n=t[r.charCodeAt(o)]<<10|t[r.charCodeAt(o+1)]<<4|t[r.charCodeAt(o+2)]>>2,f[A++]=n>>8&255,f[A++]=255&n),f}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function A(r,t,e){for(var n,o=[],a=t;a<e;a+=3)n=(r[a]<<16&16711680)+(r[a+1]<<8&65280)+(255&r[a+2]),o.push(f(n));return o.join("")}function d(t){for(var e,n=t.length,o=n%3,a=[],h=0,u=n-o;h<u;h+=16383)a.push(A(t,h,h+16383>u?u:h+16383));return 1===o?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),a.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;
},{}],"JgNJ":[function(require,module,exports) {
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],"REa7":[function(require,module,exports) {
var r={}.toString;module.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)};
},{}],"dskh":[function(require,module,exports) {

var global = arguments[3];
var t=arguments[3],r=require("base64-js"),e=require("ieee754"),n=require("isarray");function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(r){return!1}}function o(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,r){if(o()<r)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=f.prototype:(null===t&&(t=new f(r)),t.length=r),t}function f(t,r,e){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,r,e)}function s(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?g(t,r,e,n):"string"==typeof r?l(t,r,e):y(t,r)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function a(t,r,e,n){return h(r),r<=0?u(t,r):void 0!==e?"string"==typeof n?u(t,r).fill(e,n):u(t,r).fill(e):u(t,r)}function c(t,r){if(h(r),t=u(t,r<0?0:0|w(r)),!f.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t}function l(t,r,e){if("string"==typeof e&&""!==e||(e="utf8"),!f.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(r,e),i=(t=u(t,n)).write(r,e);return i!==n&&(t=t.slice(0,i)),t}function p(t,r){var e=r.length<0?0:0|w(r.length);t=u(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t}function g(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n),f.TYPED_ARRAY_SUPPORT?(t=r).__proto__=f.prototype:t=p(t,r),t}function y(t,r){if(f.isBuffer(r)){var e=0|w(r.length);return 0===(t=u(t,e)).length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||W(r.length)?u(t,0):p(t,r);if("Buffer"===r.type&&n(r.data))return p(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function w(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function d(t){return+t!=t&&(t=0),f.alloc(+t)}function v(t,r){if(f.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return K(t).length;default:if(n)return $(t).length;r=(""+r).toLowerCase(),n=!0}}function E(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return x(this,r,e);case"utf8":case"utf-8":return Y(this,r,e);case"ascii":return L(this,r,e);case"latin1":case"binary":return D(this,r,e);case"base64":return S(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function R(t,r,e,n,i){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0){if(!i)return-1;e=0}if("string"==typeof r&&(r=f.from(r,n)),f.isBuffer(r))return 0===r.length?-1:_(t,r,e,n,i);if("number"==typeof r)return r&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):_(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer")}function _(t,r,e,n,i){var o,u=1,f=t.length,s=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;u=2,f/=2,s/=2,e/=2}function h(t,r){return 1===u?t[r]:t.readUInt16BE(r*u)}if(i){var a=-1;for(o=e;o<f;o++)if(h(t,o)===h(r,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===s)return a*u}else-1!==a&&(o-=o-a),a=-1}else for(e+s>f&&(e=f-s),o=e;o>=0;o--){for(var c=!0,l=0;l<s;l++)if(h(t,o+l)!==h(r,l)){c=!1;break}if(c)return o}return-1}function A(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var f=parseInt(r.substr(2*u,2),16);if(isNaN(f))return u;t[e+u]=f}return u}function m(t,r,e,n){return Q($(r,t.length-e),t,e,n)}function P(t,r,e,n){return Q(G(r),t,e,n)}function T(t,r,e,n){return P(t,r,e,n)}function B(t,r,e,n){return Q(K(r),t,e,n)}function U(t,r,e,n){return Q(H(r,t.length-e),t,e,n)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function Y(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,u,f,s,h=t[i],a=null,c=h>239?4:h>223?3:h>191?2:1;if(i+c<=e)switch(c){case 1:h<128&&(a=h);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&h)<<6|63&o)>127&&(a=s);break;case 3:o=t[i+1],u=t[i+2],128==(192&o)&&128==(192&u)&&(s=(15&h)<<12|(63&o)<<6|63&u)>2047&&(s<55296||s>57343)&&(a=s);break;case 4:o=t[i+1],u=t[i+2],f=t[i+3],128==(192&o)&&128==(192&u)&&128==(192&f)&&(s=(15&h)<<18|(63&o)<<12|(63&u)<<6|63&f)>65535&&s<1114112&&(a=s)}null===a?(a=65533,c=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=c}return O(n)}exports.Buffer=f,exports.SlowBuffer=d,exports.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:i(),exports.kMaxLength=o(),f.poolSize=8192,f._augment=function(t){return t.__proto__=f.prototype,t},f.from=function(t,r,e){return s(null,t,r,e)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(t,r,e){return a(null,t,r,e)},f.allocUnsafe=function(t){return c(null,t)},f.allocUnsafeSlow=function(t){return c(null,t)},f.isBuffer=function(t){return!(null==t||!t._isBuffer)},f.compare=function(t,r){if(!f.isBuffer(t)||!f.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,i=0,o=Math.min(e,n);i<o;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break}return e<n?-1:n<e?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,r){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return f.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var i=f.allocUnsafe(r),o=0;for(e=0;e<t.length;++e){var u=t[e];if(!f.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,o),o+=u.length}return i},f.byteLength=v,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)b(this,r,r+1);return this},f.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)b(this,r,r+3),b(this,r+1,r+2);return this},f.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)b(this,r,r+7),b(this,r+1,r+6),b(this,r+2,r+5),b(this,r+3,r+4);return this},f.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Y(this,0,t):E.apply(this,arguments)},f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===f.compare(this,t)},f.prototype.inspect=function(){var t="",r=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},f.prototype.compare=function(t,r,e,n,i){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),r<0||e>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),u=(e>>>=0)-(r>>>=0),s=Math.min(o,u),h=this.slice(n,i),a=t.slice(r,e),c=0;c<s;++c)if(h[c]!==a[c]){o=h[c],u=a[c];break}return o<u?-1:u<o?1:0},f.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},f.prototype.indexOf=function(t,r,e){return R(this,t,r,e,!0)},f.prototype.lastIndexOf=function(t,r,e){return R(this,t,r,e,!1)},f.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,t,r,e);case"utf8":case"utf-8":return m(this,t,r,e);case"ascii":return P(this,t,r,e);case"latin1":case"binary":return T(this,t,r,e);case"base64":return B(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function O(t){var r=t.length;if(r<=I)return String.fromCharCode.apply(String,t);for(var e="",n=0;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=I));return e}function L(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n}function D(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function x(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=Z(t[o]);return i}function C(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function k(t,r,e,n,i,o){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<o)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function N(t,r,e,n){r<0&&(r=65535+r+1);for(var i=0,o=Math.min(t.length-e,2);i<o;++i)t[e+i]=(r&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function z(t,r,e,n){r<0&&(r=4294967295+r+1);for(var i=0,o=Math.min(t.length-e,4);i<o;++i)t[e+i]=r>>>8*(n?i:3-i)&255}function F(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function j(t,r,n,i,o){return o||F(t,r,n,4,3.4028234663852886e38,-3.4028234663852886e38),e.write(t,r,n,i,23,4),n+4}function q(t,r,n,i,o){return o||F(t,r,n,8,1.7976931348623157e308,-1.7976931348623157e308),e.write(t,r,n,i,52,8),n+8}f.prototype.slice=function(t,r){var e,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t),f.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,r)).__proto__=f.prototype;else{var i=r-t;e=new f(i,void 0);for(var o=0;o<i;++o)e[o]=this[o+t]}return e},f.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},f.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},f.prototype.readUInt8=function(t,r){return r||M(t,1,this.length),this[t]},f.prototype.readUInt16LE=function(t,r){return r||M(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUInt16BE=function(t,r){return r||M(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUInt32LE=function(t,r){return r||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},f.prototype.readUInt32BE=function(t,r){return r||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n},f.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o},f.prototype.readInt8=function(t,r){return r||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},f.prototype.readInt16LE=function(t,r){r||M(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(t,r){r||M(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(t,r){return r||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,r){return r||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readFloatLE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!1,52,8)},f.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e},f.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e},f.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},f.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):z(this,t,r,!0),r+4},f.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=0,u=1,f=0;for(this[r]=255&t;++o<e&&(u*=256);)t<0&&0===f&&0!==this[r+o-1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=e-1,u=1,f=0;for(this[r+o]=255&t;--o>=0&&(u*=256);)t<0&&0===f&&0!==this[r+o+1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},f.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):z(this,t,r,!0),r+4},f.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeFloatLE=function(t,r,e){return j(this,t,r,!0,e)},f.prototype.writeFloatBE=function(t,r,e){return j(this,t,r,!1,e)},f.prototype.writeDoubleLE=function(t,r,e){return q(this,t,r,!0,e)},f.prototype.writeDoubleBE=function(t,r,e){return q(this,t,r,!1,e)},f.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i,o=n-e;if(this===t&&e<r&&r<n)for(i=o-1;i>=0;--i)t[i+r]=this[i+e];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+r]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),r);return o},f.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var o;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(o=r;o<e;++o)this[o]=t;else{var u=f.isBuffer(t)?t:$(new f(t,n).toString()),s=u.length;for(o=0;o<e-r;++o)this[o+r]=u[o%s]}return this};var V=/[^+\/0-9A-Za-z-_]/g;function X(t){if((t=J(t).replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function J(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Z(t){return t<16?"0"+t.toString(16):t.toString(16)}function $(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],u=0;u<n;++u){if((e=t.charCodeAt(u))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=65536+(i-55296<<10|e-56320)}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function G(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}function H(t,r){for(var e,n,i,o=[],u=0;u<t.length&&!((r-=2)<0);++u)n=(e=t.charCodeAt(u))>>8,i=e%256,o.push(i),o.push(n);return o}function K(t){return r.toByteArray(X(t))}function Q(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function W(t){return t!=t}
},{"base64-js":"yh9p","ieee754":"JgNJ","isarray":"REa7","buffer":"dskh"}],"lBbe":[function(require,module,exports) {
var define;
var process = require("process");
var Buffer = require("buffer").Buffer;
var e,t=require("process"),n=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports._TestingHooks=exports._FieldPath=exports._EmptyAuthCredentialsProvider=exports._EmptyAppCheckTokenProvider=exports._DocumentKey=exports._DatabaseId=exports._ByteString=exports._AutoId=exports.WriteBatch=exports.Transaction=exports.Timestamp=exports.SnapshotMetadata=exports.QueryStartAtConstraint=exports.QuerySnapshot=exports.QueryOrderByConstraint=exports.QueryLimitConstraint=exports.QueryFieldFilterConstraint=exports.QueryEndAtConstraint=exports.QueryDocumentSnapshot=exports.QueryConstraint=exports.QueryCompositeFilterConstraint=exports.Query=exports.PersistentCacheIndexManager=exports.LoadBundleTask=exports.GeoPoint=exports.FirestoreError=exports.Firestore=exports.FieldValue=exports.FieldPath=exports.DocumentSnapshot=exports.DocumentReference=exports.CollectionReference=exports.CACHE_SIZE_UNLIMITED=exports.Bytes=exports.AggregateQuerySnapshot=exports.AggregateField=exports.AbstractUserDataWriter=void 0,exports._cast=Cf,exports._debugAssert=$,exports._internalAggregationQueryToProtoRunAggregationQueryRequest=_v,exports._internalQueryToProtoQueryTarget=Iv,exports._isBase64Available=Qt,exports._logWarn=J,exports._validateIsNotUsedTogether=_f,exports.addDoc=Vd,exports.aggregateFieldEqual=wd,exports.aggregateQuerySnapshotEqual=xd,exports.and=Xh,exports.arrayRemove=fv,exports.arrayUnion=lv,exports.average=gd,exports.clearIndexedDbPersistence=$f,exports.collection=Rf,exports.collectionGroup=Of,exports.connectFirestoreEmulator=Mf,exports.count=kd,exports.deleteAllPersistentCacheIndexes=wv,exports.deleteDoc=Od,exports.deleteField=sv,exports.disableNetwork=nh,exports.disablePersistentCacheIndexAutoCreation=kv,exports.doc=Vf,exports.documentId=fh,exports.enableIndexedDbPersistence=Yf,exports.enableMultiTabIndexedDbPersistence=Xf,exports.enableNetwork=th,exports.enablePersistentCacheIndexAutoCreation=gv,exports.endAt=sd,exports.endBefore=od,exports.ensureFirestoreConfigured=Hf,exports.executeWrite=Bd,exports.getAggregateFromServer=Kd,exports.getCountFromServer=Gd,exports.getDoc=Cd,exports.getDocFromCache=Ad,exports.getDocFromServer=Nd,exports.getDocs=Md,exports.getDocsFromCache=Fd,exports.getDocsFromServer=Ld,exports.getFirestore=Wf,exports.getPersistentCacheIndexManager=mv,exports.increment=hv,exports.initializeFirestore=jf,exports.limit=td,exports.limitToLast=nd,exports.loadBundle=ih,exports.memoryEagerGarbageCollector=Jd,exports.memoryLocalCache=Xd,exports.memoryLruGarbageCollector=Yd,exports.namedQuery=ah,exports.onSnapshot=qd,exports.onSnapshotsInSync=Ud,exports.or=Yh,exports.orderBy=$h,exports.persistentLocalCache=Zd,exports.persistentMultipleTabManager=nv,exports.persistentSingleTabManager=tv,exports.query=jh,exports.queryEqual=Uf,exports.refEqual=qf,exports.runTransaction=ov,exports.serverTimestamp=cv,exports.setDoc=Pd,exports.setIndexConfiguration=vv,exports.setLogLevel=j,exports.snapshotEqual=Sd,exports.startAfter=ad,exports.startAt=id,exports.sum=md,exports.terminate=rh,exports.updateDoc=Rd,exports.waitForPendingWrites=eh,exports.where=Hh,exports.writeBatch=dv;var r=require("@firebase/app"),i=require("@firebase/component"),a=require("@firebase/logger"),u=require("@firebase/util"),o=require("@firebase/webchannel-wrapper/bloom-blob"),s=require("@firebase/webchannel-wrapper/webchannel-blob");function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=l(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(null,arguments)}function l(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=T(e)););return e}function f(e,t){return v(e)||d(e,t)||N(e,t)||h()}function h(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,u,o=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);s=!0);}catch(e){c=!0,i=e}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw i}}return o}}function v(e){if(Array.isArray(e))return e}function p(e){var t="function"==typeof Map?new Map:void 0;return(p=function(e){if(null===e||!m(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return y(e,arguments,T(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),C(n,e)})(e)}function y(e,t,n){if(E())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&C(i,n.prototype),i}function m(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}function g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=N(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){o=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(o)throw a}}}}function k(){"use strict";k=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var a=t&&t.prototype instanceof m?t:m,u=Object.create(a.prototype),o=new N(r||[]);return i(u,"_invoke",{value:S(e,n,o)}),u}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",d="suspendedYield",v="executing",p="completed",y={};function m(){}function g(){}function w(){}var x={};c(x,u,function(){return this});var b=Object.getPrototypeOf,I=b&&b(b(M([])));I&&I!==n&&r.call(I,u)&&(x=I);var _=w.prototype=m.prototype=Object.create(x);function E(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function T(e,t){function n(i,a,u,o){var s=f(e[i],e,a);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==P(l)&&r.call(l,"__await")?t.resolve(l.__await).then(function(e){n("next",e,u,o)},function(e){n("throw",e,u,o)}):t.resolve(l).then(function(e){c.value=e,u(c)},function(e){return n("throw",e,u,o)})}o(s.arg)}var a;i(this,"_invoke",{value:function(e,r){function i(){return new t(function(t,i){n(e,r,t,i)})}return a=a?a.then(i,i):i()}})}function S(t,n,r){var i=h;return function(a,u){if(i===v)throw Error("Generator is already running");if(i===p){if("throw"===a)throw u;return{value:e,done:!0}}for(r.method=a,r.arg=u;;){var o=r.delegate;if(o){var s=C(o,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var c=f(t,n,r);if("normal"===c.type){if(i=r.done?p:d,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=p,r.method="throw",r.arg=c.arg)}}}function C(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var a=f(i,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var u=a.arg;return u?u.done?(n[t.resultName]=u.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):u:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function M(t){if(t||""===t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(P(t)+" is not iterable")}return g.prototype=w,i(_,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:g,configurable:!0}),g.displayName=c(w,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},E(T.prototype),c(T.prototype,o,function(){return this}),t.AsyncIterator=T,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var u=new T(l(e,n,r,i),a);return t.isGeneratorFunction(n)?u:u.next().then(function(e){return e.done?e.value:u.next()})},E(_),c(_,s,"Generator"),c(_,u,function(){return this}),c(_,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=M,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return o.type="throw",o.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var u=this.tryEntries[a],o=u.completion;if("root"===u.tryLoc)return i("end");if(u.tryLoc<=this.prev){var s=r.call(u,"catchLoc"),c=r.call(u,"finallyLoc");if(s&&c){if(this.prev<u.catchLoc)return i(u.catchLoc,!0);if(this.prev<u.finallyLoc)return i(u.finallyLoc)}else if(s){if(this.prev<u.catchLoc)return i(u.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return i(u.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var u=a?a.completion:{};return u.type=e,u.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(u)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:M(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function w(e,t,n,r,i,a,u){try{var o=e[a](u),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(r,i)}function x(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function u(e){w(a,r,i,u,o,"next",e)}function o(e){w(a,r,i,u,o,"throw",e)}u(void 0)})}}function b(e,t,n){return t=T(t),I(e,E()?Reflect.construct(t,n||[],T(e).constructor):t.apply(e,n))}function I(e,t){if(t&&("object"==P(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _(e)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(E=function(){return!!e})()}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}function C(e,t){return(C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function D(e){return F(e)||M(e)||N(e)||A()}function A(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function N(e,t){if(e){if("string"==typeof e)return L(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}function M(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function F(e){if(Array.isArray(e))return L(e)}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,q(r.key),r)}}function V(e,t,n){return t&&O(e.prototype,t),n&&O(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function q(e){var t=U(e,"string");return"symbol"==P(t)?t:t+""}function U(e,t){if("object"!=P(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var B="@firebase/firestore",z=function(){return V(function e(t){R(this,e),this.uid=t},[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}])}();z.UNAUTHENTICATED=new z(null),z.GOOGLE_CREDENTIALS=new z("google-credentials-uid"),z.FIRST_PARTY=new z("first-party-uid"),z.MOCK_USER=new z("mock-user");var G="10.12.1",K=new a.Logger("@firebase/firestore");function Q(){return K.logLevel}function j(e){K.setLogLevel(e)}function W(e){if(K.logLevel<=a.LogLevel.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Y);K.debug.apply(K,["Firestore (".concat(G,"): ").concat(e)].concat(D(i)))}}function H(e){if(K.logLevel<=a.LogLevel.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Y);K.error.apply(K,["Firestore (".concat(G,"): ").concat(e)].concat(D(i)))}}function J(e){if(K.logLevel<=a.LogLevel.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Y);K.warn.apply(K,["Firestore (".concat(G,"): ").concat(e)].concat(D(i)))}}function Y(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function X(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(G,") INTERNAL ASSERTION FAILED: ")+e;throw H(t),new Error(t)}function Z(e,t){e||X()}function $(e,t){e||X()}function ee(e,t){return e}var te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ne=exports.FirestoreError=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t,[e,n])).code=e,r.message=n,r.toString=function(){return"".concat(r.name,": [code=").concat(r.code,"]: ").concat(r.message)},r}return S(t,u.FirebaseError),V(t)}(),re=V(function e(){var t=this;R(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),ie=V(function e(t,n){R(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),ae=exports._EmptyAuthCredentialsProvider=function(){return V(function e(){R(this,e)},[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(z.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}])}(),ue=function(){return V(function e(t){R(this,e),this.token=t,this.changeListener=null},[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable(function(){return t(n.token.user)})}},{key:"shutdown",value:function(){this.changeListener=null}}])}(),oe=function(){return V(function e(t){R(this,e),this.t=t,this.currentUser=z.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null},[{key:"start",value:function(e,t){var n=this,r=this.i,i=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},a=new re;this.o=function(){n.i++,n.currentUser=n.u(),a.resolve(),a=new re,e.enqueueRetryable(function(){return i(n.currentUser)})};var u=function(){var t=a;e.enqueueRetryable(x(k().mark(function e(){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,i(n.currentUser);case 4:case"end":return e.stop()}},e)})))},o=function(e){W("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),u()};this.t.onInit(function(e){return o(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?o(e):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new re)}},0),u()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Z("string"==typeof n.accessToken),new ie(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Z(null===e||"string"==typeof e),new z(e)}}])}(),se=function(){return V(function e(t,n,r){R(this,e),this.l=t,this.h=n,this.P=r,this.type="FirstParty",this.user=z.FIRST_PARTY,this.I=new Map},[{key:"T",value:function(){return this.P?this.P():null}},{key:"headers",get:function(){this.I.set("X-Goog-AuthUser",this.l);var e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}])}(),ce=function(){return V(function e(t,n,r){R(this,e),this.l=t,this.h=n,this.P=r},[{key:"getToken",value:function(){return Promise.resolve(new se(this.l,this.h,this.P))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(z.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}])}(),le=V(function e(t){R(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),fe=function(){return V(function e(t){R(this,e),this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null},[{key:"start",value:function(e,t){var n=this,r=function(e){null!=e.error&&W("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.R;return n.R=e.token,W("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=function(t){e.enqueueRetryable(function(){return r(t)})};var i=function(e){W("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.A.onInit(function(e){return i(e)}),setTimeout(function(){if(!n.appCheck){var e=n.A.getImmediate({optional:!0});e?i(e):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(function(t){return t?(Z("string"==typeof t.token),e.R=t.token,new le(t.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}])}(),he=exports._EmptyAppCheckTokenProvider=function(){return V(function e(){R(this,e)},[{key:"getToken",value:function(){return Promise.resolve(new le(""))}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){}},{key:"shutdown",value:function(){}}])}();function de(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var ve=exports._AutoId=function(){return V(function e(){R(this,e)},null,[{key:"newId",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=de(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}])}();function pe(e,t){return e<t?-1:e>t?1:0}function ye(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}function me(e){return e+"\0"}var ge=exports.Timestamp=function(){function e(t,n){if(R(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new ne(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ne(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new ne(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ne(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return V(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?pe(this.nanoseconds,e.nanoseconds):pe(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}])}(),ke=function(){function e(t){R(this,e),this.timestamp=t}return V(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new ge(0,0))}},{key:"max",value:function(){return new e(new ge(253402300799,999999999))}}])}(),we=function(){function e(t,n,r){R(this,e),void 0===n?n=0:n>t.length&&X(),void 0===r?r=t.length-n:r>t.length-n&&X(),this.segments=t,this.offset=n,this.len=r}return V(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}])}(),xe=function(e){function t(){return R(this,t),b(this,t,arguments)}return S(t,we),V(t,[{key:"construct",value:function(e,n,r){return new t(e,n,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"toUriEncodedString",value:function(){return this.toArray().map(encodeURIComponent).join("/")}}],[{key:"fromString",value:function(){for(var e=[],n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var a=0,u=r;a<u.length;a++){var o=u[a];if(o.indexOf("//")>=0)throw new ne(te.INVALID_ARGUMENT,"Invalid segment (".concat(o,"). Paths must not contain // in them."));e.push.apply(e,D(o.split("/").filter(function(e){return e.length>0})))}return new t(e)}},{key:"emptyPath",value:function(){return new t([])}}])}(),be=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ie=exports._FieldPath=function(e){function t(){return R(this,t),b(this,t,arguments)}return S(t,we),V(t,[{key:"construct",value:function(e,n,r){return new t(e,n,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return be.test(e)}},{key:"keyField",value:function(){return new t(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var n=[],r="",i=0,a=function(){if(0===r.length)throw new ne(te.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));n.push(r),r=""},u=!1;i<e.length;){var o=e[i];if("\\"===o){if(i+1===e.length)throw new ne(te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[i+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new ne(te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=s,i+=2}else"`"===o?(u=!u,i++):"."!==o||u?(r+=o,i++):(a(),i++)}if(a(),u)throw new ne(te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}},{key:"emptyPath",value:function(){return new t([])}}])}(),_e=exports._DocumentKey=function(){function e(t){R(this,e),this.path=t}return V(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===xe.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(xe.fromString(t))}},{key:"fromName",value:function(t){return new e(xe.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(xe.emptyPath())}},{key:"comparator",value:function(e,t){return xe.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new xe(t.slice()))}}])}(),Ee=V(function e(t,n,r,i){R(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=i});function Te(e){return e.fields.find(function(e){return 2===e.kind})}function Se(e){return e.fields.filter(function(e){return 2!==e.kind})}function Ce(e,t){var n=pe(e.collectionGroup,t.collectionGroup);if(0!==n)return n;for(var r=0;r<Math.min(e.fields.length,t.fields.length);++r)if(0!==(n=Ae(e.fields[r],t.fields[r])))return n;return pe(e.fields.length,t.fields.length)}Ee.UNKNOWN_ID=-1;var De=V(function e(t,n){R(this,e),this.fieldPath=t,this.kind=n});function Ae(e,t){var n=Ie.comparator(e.fieldPath,t.fieldPath);return 0!==n?n:pe(e.kind,t.kind)}var Ne=function(){function e(t,n){R(this,e),this.sequenceNumber=t,this.offset=n}return V(e,null,[{key:"empty",value:function(){return new e(0,Le.min())}}])}();function Me(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=ke.fromTimestamp(1e9===r?new ge(n+1,0):new ge(n,r));return new Le(i,_e.empty(),t)}function Fe(e){return new Le(e.readTime,e.key,-1)}var Le=function(){function e(t,n,r){R(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return V(e,null,[{key:"min",value:function(){return new e(ke.min(),_e.empty(),-1)}},{key:"max",value:function(){return new e(ke.max(),_e.empty(),-1)}}])}();function Pe(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=_e.comparator(e.documentKey,t.documentKey))?n:pe(e.largestBatchId,t.largestBatchId)}var Re="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Oe=function(){return V(function e(){R(this,e),this.onCommittedListeners=[]},[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}])}();function Ve(e){return qe.apply(this,arguments)}function qe(){return(qe=x(k().mark(function e(t){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===te.FAILED_PRECONDITION&&t.message===Re){e.next=2;break}throw t;case 2:W("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ue=function(){function e(t){var n=this;R(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return V(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&X(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=g(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(u){i.e(u)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e(function(e,r){for(var i=t.length,a=new Array(i),u=0,o=function(){var o=s;n(t[o]).next(function(t){a[o]=t,++u===i&&e(a)},function(e){return r(e)})},s=0;s<i;s++)o()})}},{key:"doWhile",value:function(t,n){return new e(function(e,r){!function i(){!0===t()?n().next(function(){i()},r):e()}()})}}])}(),Be=function(){function e(t,n){var r=this;R(this,e),this.action=t,this.transaction=n,this.aborted=!1,this.V=new re,this.transaction.oncomplete=function(){r.V.resolve()},this.transaction.onabort=function(){n.error?r.V.reject(new Qe(t,n.error)):r.V.resolve()},this.transaction.onerror=function(e){var n=Ye(e.target.error);r.V.reject(new Qe(t,n))}}return V(e,[{key:"m",get:function(){return this.V.promise}},{key:"abort",value:function(e){e&&this.V.reject(e),this.aborted||(W("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"g",value:function(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new We(t)}}],[{key:"open",value:function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new Qe(n,t)}}}])}(),ze=function(){function e(t,n,r){R(this,e),this.name=t,this.version=n,this.p=r,12.2===e.S((0,u.getUA)())&&H("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return V(e,[{key:"M",value:function(){var e=x(k().mark(function e(t){var n=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.db,e.t0){e.next=6;break}return W("SimpleDb","Opening database:",this.name),e.next=5,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Qe(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new ne(te.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new ne(te.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new Qe(t,n))},i.onupgradeneeded=function(e){W("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.p.O(t,i.transaction,e.oldVersion,n.version).next(function(){W("SimpleDb","Database upgrade to version "+n.version+" complete")})}});case 5:this.db=e.sent;case 6:return this.N&&(this.db.onversionchange=function(e){return n.N(e)}),e.abrupt("return",this.db);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"L",value:function(e){this.N=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(){var e=x(k().mark(function e(t,n,r,i){var a,u,o,s,c=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a="readonly"===n,u=0,o=k().mark(function e(){var n,o,s,l;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return++u,e.prev=1,e.next=4,c.M(t);case 4:return c.db=e.sent,n=Be.open(c.db,t,a?"readonly":"readwrite",r),(o=i(n).next(function(e){return n.g(),e}).catch(function(e){return n.abort(e),Ue.reject(e)}).toPromise()).catch(function(){}),e.next=9,n.m;case 9:return e.t0=o,e.abrupt("return",{v:e.t0});case 13:if(e.prev=13,e.t1=e.catch(1),s=e.t1,l="FirebaseError"!==s.name&&u<3,W("SimpleDb","Transaction failed with error:",s.message,"Retrying:",l),c.close(),l){e.next=18;break}return e.abrupt("return",{v:Promise.reject(s)});case 18:case"end":return e.stop()}},e,null,[[1,13]])});case 3:return e.delegateYield(o(),"t0",4);case 4:if(!(s=e.t0)){e.next=7;break}return e.abrupt("return",s.v);case 7:e.next=3;break;case 9:case"end":return e.stop()}},e)}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return W("SimpleDb","Removing database:",e),He(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"D",value:function(){if(!(0,u.isIndexedDBAvailable)())return!1;if(e.C())return!0;var t=(0,u.getUA)(),n=e.S(t),r=0<n&&n<10,i=Ge(t),a=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||a)}},{key:"C",value:function(){var e;return void 0!==t&&"YES"===(null===(e=t.__PRIVATE_env)||void 0===e?void 0:e.v)}},{key:"F",value:function(e,t){return e.store(t)}},{key:"S",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}}])}();function Ge(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}var Ke=function(){return V(function e(t){R(this,e),this.B=t,this.k=!1,this.q=null},[{key:"isDone",get:function(){return this.k}},{key:"K",get:function(){return this.q}},{key:"cursor",set:function(e){this.B=e}},{key:"done",value:function(){this.k=!0}},{key:"$",value:function(e){this.q=e}},{key:"delete",value:function(){return He(this.B.delete())}}])}(),Qe=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t,[te.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(n)])).name="IndexedDbTransactionError",r}return S(t,ne),V(t)}();function je(e){return"IndexedDbTransactionError"===e.name}var We=function(){return V(function e(t){R(this,e),this.store=t},[{key:"put",value:function(e,t){var n;return void 0!==t?(W("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(W("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),He(n)}},{key:"add",value:function(e){return W("SimpleDb","ADD",this.store.name,e,e),He(this.store.add(e))}},{key:"get",value:function(e){var t=this;return He(this.store.get(e)).next(function(n){return void 0===n&&(n=null),W("SimpleDb","GET",t.store.name,e,n),n})}},{key:"delete",value:function(e){return W("SimpleDb","DELETE",this.store.name,e),He(this.store.delete(e))}},{key:"count",value:function(){return W("SimpleDb","COUNT",this.store.name),He(this.store.count())}},{key:"U",value:function(e,t){var n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){var i=r.getAll(n.range);return new Ue(function(e,t){i.onerror=function(e){t(e.target.error)},i.onsuccess=function(t){e(t.target.result)}})}var a=this.cursor(n),u=[];return this.W(a,function(e,t){u.push(t)}).next(function(){return u})}},{key:"G",value:function(e,t){var n=this.store.getAll(e,null===t?void 0:t);return new Ue(function(e,t){n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)}})}},{key:"j",value:function(e,t){W("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.H=!1;var r=this.cursor(n);return this.W(r,function(e,t,n){return n.delete()})}},{key:"J",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.W(r,t)}},{key:"Y",value:function(e){var t=this.cursor({});return new Ue(function(n,r){t.onerror=function(e){var t=Ye(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next(function(e){e?r.continue():n()}):n()}})}},{key:"W",value:function(e,t){var n=[];return new Ue(function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var a=new Ke(i),u=t(i.primaryKey,i.value,a);if(u instanceof Ue){var o=u.catch(function(e){return a.done(),Ue.reject(e)});n.push(o)}a.isDone?r():null===a.K?i.continue():i.continue(a.K)}else r()}}).next(function(){return Ue.waitFor(n)})}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}])}();function He(e){return new Ue(function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=Ye(e.target.error);n(t)}})}var Je=!1;function Ye(e){var t=ze.S((0,u.getUA)());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new ne("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return Je||(Je=!0,setTimeout(function(){throw r},0)),r}}return e}var Xe=function(){return V(function e(t,n){R(this,e),this.asyncQueue=t,this.Z=n,this.task=null},[{key:"start",value:function(){this.X(15e3)}},{key:"stop",value:function(){this.task&&(this.task.cancel(),this.task=null)}},{key:"started",get:function(){return null!==this.task}},{key:"X",value:function(e){var t=this;W("IndexBackfiller","Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,x(k().mark(function e(){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.task=null,e.prev=1,e.t0=W,e.t1="Documents written: ",e.next=6,t.Z.ee();case 6:e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),(0,e.t0)("IndexBackfiller",e.t3),e.next=19;break;case 11:if(e.prev=11,e.t4=e.catch(1),!je(e.t4)){e.next=17;break}W("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e.t4),e.next=19;break;case 17:return e.next=19,Ve(e.t4);case 19:return e.next=21,t.X(6e4);case 21:case"end":return e.stop()}},e,null,[[1,11]])})))}}])}(),Ze=function(){return V(function e(t,n){R(this,e),this.localStore=t,this.persistence=n},[{key:"ee",value:function(){var e=x(k().mark(function e(){var t,n=this,r=arguments;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:50,e.abrupt("return",this.persistence.runTransaction("Backfill Indexes","readwrite-primary",function(e){return n.te(e,t)}));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"te",value:function(e,t){var n=this,r=new Set,i=t,a=!0;return Ue.doWhile(function(){return!0===a&&i>0},function(){return n.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(function(t){if(null!==t&&!r.has(t))return W("IndexBackfiller","Processing collection: ".concat(t)),n.ne(e,t,i).next(function(e){i-=e,r.add(t)});a=!1})}).next(function(){return t-i})}},{key:"ne",value:function(e,t,n){var r=this;return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(function(i){return r.localStore.localDocuments.getNextDocuments(e,t,i,n).next(function(n){var a=n.changes;return r.localStore.indexManager.updateIndexEntries(e,a).next(function(){return r.re(i,n)}).next(function(n){return W("IndexBackfiller","Updating offset: ".concat(n)),r.localStore.indexManager.updateCollectionGroup(e,t,n)}).next(function(){return a.size})})})}},{key:"re",value:function(e,t){var n=e;return t.changes.forEach(function(e,t){var r=Fe(t);Pe(r,n)>0&&(n=r)}),new Le(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}])}(),$e=function(){return V(function e(t,n){var r=this;R(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.ie(e)},this.se=function(e){return n.writeSequenceNumber(e)})},[{key:"ie",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.se&&this.se(e),e}}])}();function et(e){return null==e}function tt(e){return 0===e&&1/e==-1/0}function nt(e){return"number"==typeof e&&Number.isInteger(e)&&!tt(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function rt(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=at(t)),t=it(e.get(n),t);return at(t)}function it(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="";break;case"":n+="";break;default:n+=a}}return n}function at(e){return e+""}function ut(e){var t=e.length;if(Z(t>=2),2===t)return Z(""===e.charAt(0)&&""===e.charAt(1)),xe.emptyPath();for(var n=t-2,r=[],i="",a=0;a<t;){var u=e.indexOf("",a);switch((u<0||u>n)&&X(),e.charAt(u+1)){case"":var o=e.substring(a,u),s=void 0;0===i.length?s=o:(s=i+=o,i=""),r.push(s);break;case"":i+=e.substring(a,u),i+="\0";break;case"":i+=e.substring(a,u+1);break;default:X()}a=u+2}return new xe(r)}$e.oe=-1;var ot=["userId","batchId"];function st(e,t){return[e,rt(t)]}function ct(e,t,n){return[e,rt(t),n]}var lt={},ft=["prefixPath","collectionGroup","readTime","documentId"],ht=["prefixPath","collectionGroup","documentId"],dt=["collectionGroup","readTime","prefixPath","documentId"],vt=["canonicalId","targetId"],pt=["targetId","path"],yt=["path","targetId"],mt=["collectionId","parent"],gt=["indexId","uid"],kt=["uid","sequenceNumber"],wt=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],xt=["indexId","uid","orderedDocumentKey"],bt=["userId","collectionPath","documentId"],It=["userId","collectionPath","largestBatchId"],_t=["userId","collectionGroup","largestBatchId"],Et=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),Tt=[].concat(D(Et),["documentOverlays"]),St=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ct=St,Dt=[].concat(Ct,["indexConfiguration","indexState","indexEntries"]),At=Dt,Nt=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t))._e=e,r.currentSequenceNumber=n,r}return S(t,Oe),V(t)}();function Mt(e,t){var n=ee(e);return ze.F(n._e,t)}function Ft(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Lt(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Pt(e,t){var n=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(t(e[r],r,e));return n}function Rt(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var Ot=function(){function e(t,n){R(this,e),this.comparator=t,this.root=n||qt.EMPTY}return V(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,qt.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,qt.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new Vt(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new Vt(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new Vt(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new Vt(this.root,e,this.comparator,!0)}}])}(),Vt=function(){return V(function e(t,n,r,i){R(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}},[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}])}(),qt=function(){function e(t,n,r,i,a){R(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return V(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw X();if(this.right.isRed())throw X();var e=this.left.check();if(e!==this.right.check())throw X();return e+(this.isRed()?0:1)}}])}();qt.EMPTY=null,qt.RED=!0,qt.BLACK=!1,qt.EMPTY=new(function(){return V(function e(){R(this,e),this.size=0},[{key:"key",get:function(){throw X()}},{key:"value",get:function(){throw X()}},{key:"color",get:function(){throw X()}},{key:"left",get:function(){throw X()}},{key:"right",get:function(){throw X()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new qt(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}])}());var Ut=function(){function e(t){R(this,e),this.comparator=t,this.data=new Ot(this.comparator)}return V(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new Bt(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new Bt(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}])}(),Bt=function(){return V(function e(t){R(this,e),this.iter=t},[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}])}();function zt(e){return e.hasNext()?e.getNext():void 0}var Gt=function(){function e(t){R(this,e),this.fields=t,t.sort(Ie.comparator)}return V(e,[{key:"unionWith",value:function(t){var n,r=new Ut(Ie.comparator),i=g(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var u,o=g(t);try{for(o.s();!(u=o.n()).done;){var s=u.value;r=r.add(s)}}catch(c){o.e(c)}finally{o.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=g(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return ye(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}],[{key:"empty",value:function(){return new e([])}}])}(),Kt=function(e){function t(){var e;return R(this,t),(e=b(this,t,arguments)).name="Base64DecodeError",e}return S(t,p(Error)),V(t)}();function Qt(){return"undefined"!=typeof atob}var jt=exports._ByteString=function(){function e(t){R(this,e),this.binaryString=t}return V(e,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return pe(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(t){return new e(function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Kt("Invalid base64 string: "+e):e}}(t))}},{key:"fromUint8Array",value:function(t){return new e(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(t))}}])}();jt.EMPTY_BYTE_STRING=new jt("");var Wt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ht(e){if(Z(!!e),"string"==typeof e){var t=0,n=Wt.exec(e);if(Z(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Jt(e.seconds),nanos:Jt(e.nanos)}}function Jt(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Yt(e){return"string"==typeof e?jt.fromBase64String(e):jt.fromUint8Array(e)}function Xt(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Zt(e){var t=e.mapValue.fields.__previous_value__;return Xt(t)?Zt(t):t}function $t(e){var t=Ht(e.mapValue.fields.__local_write_time__.timestampValue);return new ge(t.seconds,t.nanos)}var en=V(function e(t,n,r,i,a,u,o,s,c){R(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=u,this.autoDetectLongPolling=o,this.longPollingOptions=s,this.useFetchStreams=c}),tn=exports._DatabaseId=function(){function e(t,n){R(this,e),this.projectId=t,this.database=n||"(default)"}return V(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}])}(),nn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},rn={nullValue:"NULL_VALUE"};function an(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Xt(e)?4:wn(e)?9007199254740991:10:X()}function un(e,t){if(e===t)return!0;var n=an(e);if(n!==an(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return $t(e).isEqual($t(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=Ht(e.timestampValue),r=Ht(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Yt(e.bytesValue).isEqual(Yt(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Jt(e.geoPointValue.latitude)===Jt(t.geoPointValue.latitude)&&Jt(e.geoPointValue.longitude)===Jt(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Jt(e.integerValue)===Jt(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=Jt(e.doubleValue),r=Jt(t.doubleValue);return n===r?tt(n)===tt(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ye(e.arrayValue.values||[],t.arrayValue.values||[],un);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Ft(n)!==Ft(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!un(n[i],r[i])))return!1;return!0}(e,t);default:return X()}}function on(e,t){return void 0!==(e.values||[]).find(function(e){return un(e,t)})}function sn(e,t){if(e===t)return 0;var n=an(e),r=an(t);if(n!==r)return pe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return pe(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=Jt(e.integerValue||e.doubleValue),r=Jt(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return cn(e.timestampValue,t.timestampValue);case 4:return cn($t(e),$t(t));case 5:return pe(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Yt(e),r=Yt(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=pe(n[i],r[i]);if(0!==a)return a}return pe(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=pe(Jt(e.latitude),Jt(t.latitude));return 0!==n?n:pe(Jt(e.longitude),Jt(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=sn(n[i],r[i]);if(a)return a}return pe(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===nn.mapValue&&t===nn.mapValue)return 0;if(e===nn.mapValue)return 1;if(t===nn.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var u=0;u<r.length&&u<a.length;++u){var o=pe(r[u],a[u]);if(0!==o)return o;var s=sn(n[r[u]],i[a[u]]);if(0!==s)return s}return pe(r.length,a.length)}(e.mapValue,t.mapValue);default:throw X()}}function cn(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return pe(e,t);var n=Ht(e),r=Ht(t),i=pe(n.seconds,r.seconds);return 0!==i?i:pe(n.nanos,r.nanos)}function ln(e){return fn(e)}function fn(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=Ht(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Yt(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return _e.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){var t,n="[",r=!0,i=g(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=fn(a)}}catch(u){i.e(u)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=g(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(fn(e.fields[a]))}}catch(u){i.e(u)}finally{i.f()}return n+"}"}(e.mapValue):X()}function hn(e){switch(an(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:var t=Zt(e);return t?16+hn(t):16;case 5:return 2*e.stringValue.length;case 6:return Yt(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(function(e,t){return e+hn(t)},0)}(e.arrayValue);case 10:return function(e){var t=0;return Lt(e.fields,function(e,n){t+=e.length+hn(n)}),t}(e.mapValue);default:throw X()}}function dn(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function vn(e){return!!e&&"integerValue"in e}function pn(e){return!!e&&"arrayValue"in e}function yn(e){return!!e&&"nullValue"in e}function mn(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function gn(e){return!!e&&"mapValue"in e}function kn(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==P(e.timestampValue))return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return Lt(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=kn(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=kn(e.arrayValue.values[r]);return n}return Object.assign({},e)}function wn(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function xn(e){return"nullValue"in e?rn:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?dn(tn.empty(),_e.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:X()}function bn(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?dn(tn.empty(),_e.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?nn:X()}function In(e,t){var n=sn(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function _n(e,t){var n=sn(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}var En=function(){function e(t){R(this,e),this.value=t}return V(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!gn(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=kn(t)}},{key:"setAll",value:function(e){var t=this,n=Ie.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var u=t.getFieldsMap(n);t.applyChanges(u,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=kn(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());gn(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return un(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];gn(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){Lt(t,function(t,n){return e[t]=n});var r,i=g(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(u){i.e(u)}finally{i.f()}}},{key:"clone",value:function(){return new e(kn(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}])}();function Tn(e){var t=[];return Lt(e.fields,function(e,n){var r=new Ie([e]);if(gn(n)){var i=Tn(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,u=g(i);try{for(u.s();!(a=u.n()).done;){var o=a.value;t.push(r.child(o))}}catch(s){u.e(s)}finally{u.f()}}}else t.push(r)}),new Gt(t)}var Sn=function(){function e(t,n,r,i,a,u,o){R(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=a,this.data=u,this.documentState=o}return V(e,[{key:"convertToFoundDocument",value:function(e,t){return!this.createTime.isEqual(ke.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=En.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=En.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=ke.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,ke.min(),ke.min(),ke.min(),En.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r,i){return new e(t,1,n,ke.min(),r,i,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,ke.min(),ke.min(),En.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,ke.min(),ke.min(),En.empty(),2)}}])}(),Cn=V(function e(t,n){R(this,e),this.position=t,this.inclusive=n});function Dn(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],u=e.position[i];if(r=a.field.isKeyField()?_e.comparator(_e.fromName(u.referenceValue),n.key):sn(u,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function An(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!un(e.position[n],t.position[n]))return!1;return!0}var Nn=V(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";R(this,e),this.field=t,this.dir=n});function Mn(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var Fn=V(function e(){R(this,e)}),Ln=function(e){function t(e,n,r){var i;return R(this,t),(i=b(this,t)).field=e,i.op=n,i.value=r,i}return S(t,Fn),V(t,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(sn(t,this.value)):null!==t&&an(this.value)===an(t)&&this.matchesComparison(sn(t,this.value))}},{key:"matchesComparison",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return X()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}}],[{key:"create",value:function(e,n,r){return e.isKeyField()?"in"===n||"not-in"===n?this.createKeyFieldInFilter(e,n,r):new Kn(e,n,r):"array-contains"===n?new Hn(e,r):"in"===n?new Jn(e,r):"not-in"===n?new Yn(e,r):"array-contains-any"===n?new Xn(e,r):new t(e,n,r)}},{key:"createKeyFieldInFilter",value:function(e,t,n){return"in"===t?new Qn(e,n):new jn(e,n)}}])}(),Pn=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t)).filters=e,r.op=n,r.ae=null,r}return S(t,Fn),V(t,[{key:"matches",value:function(e){return Rn(this)?void 0===this.filters.find(function(t){return!t.matches(e)}):void 0!==this.filters.find(function(t){return t.matches(e)})}},{key:"getFlattenedFilters",value:function(){return null!==this.ae||(this.ae=this.filters.reduce(function(e,t){return e.concat(t.getFlattenedFilters())},[])),this.ae}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}}],[{key:"create",value:function(e,n){return new t(e,n)}}])}();function Rn(e){return"and"===e.op}function On(e){return"or"===e.op}function Vn(e){return qn(e)&&Rn(e)}function qn(e){var t,n=g(e.filters);try{for(n.s();!(t=n.n()).done;){if(t.value instanceof Pn)return!1}}catch(r){n.e(r)}finally{n.f()}return!0}function Un(e){if(e instanceof Ln)return e.field.canonicalString()+e.op.toString()+ln(e.value);if(Vn(e))return e.filters.map(function(e){return Un(e)}).join(",");var t=e.filters.map(function(e){return Un(e)}).join(",");return"".concat(e.op,"(").concat(t,")")}function Bn(e,t){return e instanceof Ln?function(e,t){return t instanceof Ln&&e.op===t.op&&e.field.isEqual(t.field)&&un(e.value,t.value)}(e,t):e instanceof Pn?function(e,t){return t instanceof Pn&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(function(e,n,r){return e&&Bn(n,t.filters[r])},!0)}(e,t):void X()}function zn(e,t){var n=e.filters.concat(t);return Pn.create(n,e.op)}function Gn(e){return e instanceof Ln?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(ln(e.value))}(e):e instanceof Pn?function(e){return e.op.toString()+" {"+e.getFilters().map(Gn).join(" ,")+"}"}(e):"Filter"}var Kn=function(e){function t(e,n,r){var i;return R(this,t),(i=b(this,t,[e,n,r])).key=_e.fromName(r.referenceValue),i}return S(t,Ln),V(t,[{key:"matches",value:function(e){var t=_e.comparator(e.key,this.key);return this.matchesComparison(t)}}])}(),Qn=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t,[e,"in",n])).keys=Wn("in",n),r}return S(t,Ln),V(t,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}])}(),jn=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t,[e,"not-in",n])).keys=Wn("not-in",n),r}return S(t,Ln),V(t,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}])}();function Wn(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return _e.fromName(e.referenceValue)})}var Hn=function(e){function t(e,n){return R(this,t),b(this,t,[e,"array-contains",n])}return S(t,Ln),V(t,[{key:"matches",value:function(e){var t=e.data.field(this.field);return pn(t)&&on(t.arrayValue,this.value)}}])}(),Jn=function(e){function t(e,n){return R(this,t),b(this,t,[e,"in",n])}return S(t,Ln),V(t,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&on(this.value.arrayValue,t)}}])}(),Yn=function(e){function t(e,n){return R(this,t),b(this,t,[e,"not-in",n])}return S(t,Ln),V(t,[{key:"matches",value:function(e){if(on(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!on(this.value.arrayValue,t)}}])}(),Xn=function(e){function t(e,n){return R(this,t),b(this,t,[e,"array-contains-any",n])}return S(t,Ln),V(t,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!pn(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return on(t.value.arrayValue,e)})}}])}(),Zn=V(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;R(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=u,this.endAt=o,this.ue=null});function $n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new Zn(e,t,n,r,i,a,u)}function er(e){var t=ee(e);if(null===t.ue){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return Un(e)}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return function(e){return e.field.canonicalString()+e.dir}(e)}).join(","),et(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(function(e){return ln(e)}).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(function(e){return ln(e)}).join(",")),t.ue=n}return t.ue}function tr(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!Mn(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(!Bn(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!An(e.startAt,t.startAt)&&An(e.endAt,t.endAt)}function nr(e){return _e.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function rr(e,t){return e.filters.filter(function(e){return e instanceof Ln&&e.field.isEqual(t)})}function ir(e,t,n){var r,i=rn,a=!0,u=g(rr(e,t));try{for(u.s();!(r=u.n()).done;){var o=r.value,s=rn,c=!0;switch(o.op){case"<":case"<=":s=xn(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,c=!1;break;case"!=":case"not-in":s=rn}In({value:i,inclusive:a},{value:s,inclusive:c})<0&&(i=s,a=c)}}catch(h){u.e(h)}finally{u.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var f=n.position[l];In({value:i,inclusive:a},{value:f,inclusive:n.inclusive})<0&&(i=f,a=n.inclusive);break}return{value:i,inclusive:a}}function ar(e,t,n){var r,i=nn,a=!0,u=g(rr(e,t));try{for(u.s();!(r=u.n()).done;){var o=r.value,s=nn,c=!0;switch(o.op){case">=":case">":s=bn(o.value),c=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,c=!1;break;case"!=":case"not-in":s=nn}_n({value:i,inclusive:a},{value:s,inclusive:c})>0&&(i=s,a=c)}}catch(h){u.e(h)}finally{u.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var f=n.position[l];_n({value:i,inclusive:a},{value:f,inclusive:n.inclusive})>0&&(i=f,a=n.inclusive);break}return{value:i,inclusive:a}}var ur=V(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;R(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=u,this.startAt=o,this.endAt=s,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt});function or(e,t,n,r,i,a,u,o){return new ur(e,t,n,r,i,a,u,o)}function sr(e){return new ur(e)}function cr(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function lr(e){return null!==e.collectionGroup}function fr(e){var t=ee(e);if(null===t.ce){t.ce=[];var n,r=new Set,i=g(t.explicitOrderBy);try{for(i.s();!(n=i.n()).done;){var a=n.value;t.ce.push(a),r.add(a.field.canonicalString())}}catch(o){i.e(o)}finally{i.f()}var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(e){var t=new Ut(Ie.comparator);return e.filters.forEach(function(e){e.getFlattenedFilters().forEach(function(e){e.isInequality()&&(t=t.add(e.field))})}),t})(t).forEach(function(e){r.has(e.canonicalString())||e.isKeyField()||t.ce.push(new Nn(e,u))}),r.has(Ie.keyField().canonicalString())||t.ce.push(new Nn(Ie.keyField(),u))}return t.ce}function hr(e){var t=ee(e);return t.le||(t.le=vr(t,fr(e))),t.le}function dr(e){var t=ee(e);return t.he||(t.he=vr(t,e.explicitOrderBy)),t.he}function vr(e,t){if("F"===e.limitType)return $n(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);t=t.map(function(e){var t="desc"===e.dir?"asc":"desc";return new Nn(e.field,t)});var n=e.endAt?new Cn(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Cn(e.startAt.position,e.startAt.inclusive):null;return $n(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}function pr(e,t){var n=e.filters.concat([t]);return new ur(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function yr(e,t,n){return new ur(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function mr(e,t){return tr(hr(e),hr(t))&&e.limitType===t.limitType}function gr(e){return"".concat(er(hr(e)),"|lt:").concat(e.limitType)}function kr(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return Gn(e)}).join(", "),"]")),et(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)}).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(function(e){return ln(e)}).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(function(e){return ln(e)}).join(",")),"Target(".concat(t,")")}(hr(e)),"; limitType=").concat(e.limitType,")")}function wr(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):_e.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=g(fr(e));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=g(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){var r=Dn(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,fr(e),t))&&!(e.endAt&&!function(e,t,n){var r=Dn(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,fr(e),t))}(e,t)}function xr(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function br(e){return function(t,n){var r,i=!1,a=g(fr(e));try{for(a.s();!(r=a.n()).done;){var u=r.value,o=Ir(u,t,n);if(0!==o)return o;i=i||u.field.isKeyField()}}catch(s){a.e(s)}finally{a.f()}return 0}}function Ir(e,t,n){var r=e.field.isKeyField()?_e.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?sn(r,i):X()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return X()}}var _r=function(){return V(function e(t,n){R(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0},[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=g(n);try{for(i.s();!(r=i.n()).done;){var a=f(r.value,2),u=a[0],o=a[1];if(this.equalsFn(u,e))return o}}catch(s){i.e(s)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){Lt(this.inner,function(t,n){var r,i=g(n);try{for(i.s();!(r=i.n()).done;){var a=f(r.value,2),u=a[0],o=a[1];e(u,o)}}catch(s){i.e(s)}finally{i.f()}})}},{key:"isEmpty",value:function(){return Rt(this.inner)}},{key:"size",value:function(){return this.innerSize}}])}(),Er=new Ot(_e.comparator);function Tr(){return Er}var Sr=new Ot(_e.comparator);function Cr(){for(var e=Sr,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var u=a[i];e=e.insert(u.key,u)}return e}function Dr(e){var t=Sr;return e.forEach(function(e,n){return t=t.insert(e,n.overlayedDocument)}),t}function Ar(){return Mr()}function Nr(){return Mr()}function Mr(){return new _r(function(e){return e.toString()},function(e,t){return e.isEqual(t)})}var Fr=new Ot(_e.comparator),Lr=new Ut(_e.comparator);function Pr(){for(var e=Lr,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var u=a[i];e=e.add(u)}return e}var Rr=new Ut(pe);function Or(){return Rr}function Vr(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tt(t)?"-0":t}}function qr(e){return{integerValue:""+e}}function Ur(e,t){return nt(t)?qr(t):Vr(e,t)}var Br=V(function e(){R(this,e),this._=void 0});function zr(e,t,n){return e instanceof Qr?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Xt(t)&&(t=Zt(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof jr?Wr(e,t):e instanceof Hr?Jr(e,t):function(e,t){var n=Kr(e,t),r=Xr(n)+Xr(e.Pe);return vn(n)&&vn(e.Pe)?qr(r):Vr(e.serializer,r)}(e,t)}function Gr(e,t,n){return e instanceof jr?Wr(e,t):e instanceof Hr?Jr(e,t):n}function Kr(e,t){return e instanceof Yr?function(e){return vn(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}var Qr=function(e){function t(){return R(this,t),b(this,t,arguments)}return S(t,Br),V(t)}(),jr=function(e){function t(e){var n;return R(this,t),(n=b(this,t)).elements=e,n}return S(t,Br),V(t)}();function Wr(e,t){var n,r=Zr(t),i=g(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return un(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(u){i.e(u)}finally{i.f()}return{arrayValue:{values:r}}}var Hr=function(e){function t(e){var n;return R(this,t),(n=b(this,t)).elements=e,n}return S(t,Br),V(t)}();function Jr(e,t){var n,r=Zr(t),i=g(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!un(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(u){i.e(u)}finally{i.f()}return{arrayValue:{values:r}}}var Yr=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t)).serializer=e,r.Pe=n,r}return S(t,Br),V(t)}();function Xr(e){return Jt(e.integerValue||e.doubleValue)}function Zr(e){return pn(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var $r=V(function e(t,n){R(this,e),this.field=t,this.transform=n});function ei(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof jr&&t instanceof jr||e instanceof Hr&&t instanceof Hr?ye(e.elements,t.elements,un):e instanceof Yr&&t instanceof Yr?un(e.Pe,t.Pe):e instanceof Qr&&t instanceof Qr}(e.transform,t.transform)}var ti=V(function e(t,n){R(this,e),this.version=t,this.transformResults=n}),ni=function(){function e(t,n){R(this,e),this.updateTime=t,this.exists=n}return V(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}])}();function ri(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var ii=V(function e(){R(this,e)});function ai(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new mi(e.key,ni.none()):new li(e.key,e.data,ni.none());var n,r=e.data,i=En.empty(),a=new Ut(Ie.comparator),u=g(t.fields);try{for(u.s();!(n=u.n()).done;){var o=n.value;if(!a.has(o)){var s=r.field(o);null===s&&o.length>1&&(o=o.popLast(),s=r.field(o)),null===s?i.delete(o):i.set(o,s),a=a.add(o)}}}catch(c){u.e(c)}finally{u.f()}return new fi(e.key,i,new Gt(a.toArray()),ni.none())}function ui(e,t,n){e instanceof li?function(e,t,n){var r=e.value.clone(),i=di(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof fi?function(e,t,n){if(ri(e.precondition,t)){var r=di(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(hi(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function oi(e,t,n,r){return e instanceof li?function(e,t,n,r){if(!ri(e.precondition,t))return n;var i=e.value.clone(),a=vi(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof fi?function(e,t,n,r){if(!ri(e.precondition,t))return n;var i=vi(e.fieldTransforms,r,t),a=t.data;return a.setAll(hi(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(function(e){return e.field}))}(e,t,n,r):function(e,t,n){return ri(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function si(e,t){var n,r=null,i=g(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,u=t.data.field(a.field),o=Kr(a.transform,u||null);null!=o&&(null===r&&(r=En.empty()),r.set(a.field,o))}}catch(s){i.e(s)}finally{i.f()}return r||null}function ci(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ye(e,t,function(e,t){return ei(e,t)})}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var li=function(e){function t(e,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return R(this,t),(i=b(this,t)).key=e,i.value=n,i.precondition=r,i.fieldTransforms=a,i.type=0,i}return S(t,ii),V(t,[{key:"getFieldMask",value:function(){return null}}])}(),fi=function(e){function t(e,n,r,i){var a,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return R(this,t),(a=b(this,t)).key=e,a.data=n,a.fieldMask=r,a.precondition=i,a.fieldTransforms=u,a.type=1,a}return S(t,ii),V(t,[{key:"getFieldMask",value:function(){return this.fieldMask}}])}();function hi(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function di(e,t,n){var r=new Map;Z(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],u=a.transform,o=t.data.field(a.field);r.set(a.field,Gr(u,o,n[i]))}return r}function vi(e,t,n){var r,i=new Map,a=g(e);try{for(a.s();!(r=a.n()).done;){var u=r.value,o=u.transform,s=n.data.field(u.field);i.set(u.field,zr(o,s,t))}}catch(c){a.e(c)}finally{a.f()}return i}var pi,yi,mi=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t)).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return S(t,ii),V(t,[{key:"getFieldMask",value:function(){return null}}])}(),gi=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t)).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return S(t,ii),V(t,[{key:"getFieldMask",value:function(){return null}}])}(),ki=function(){return V(function e(t,n,r,i){R(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i},[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&ui(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=g(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=oi(i,e,t,this.localWriteTime))}}catch(s){r.e(s)}finally{r.f()}var a,u=g(this.mutations);try{for(u.s();!(a=u.n()).done;){var o=a.value;o.key.isEqual(e.key)&&(t=oi(o,e,t,this.localWriteTime))}}catch(s){u.e(s)}finally{u.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=Nr();return this.mutations.forEach(function(i){var a=e.get(i.key),u=a.overlayedDocument,o=n.applyToLocalView(u,a.mutatedFields),s=ai(u,o=t.has(i.key)?null:o);null!==s&&r.set(i.key,s),u.isValidDocument()||u.convertToNoDocument(ke.min())}),r}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},Pr())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&ye(this.mutations,e.mutations,function(e,t){return ci(e,t)})&&ye(this.baseMutations,e.baseMutations,function(e,t){return ci(e,t)})}}])}(),wi=function(){function e(t,n,r,i){R(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return V(e,null,[{key:"from",value:function(t,n,r){Z(t.mutations.length===r.length);for(var i=Fr,a=t.mutations,u=0;u<a.length;u++)i=i.insert(a[u].key,r[u].version);return new e(t,n,r,i)}}])}(),xi=function(){return V(function e(t,n){R(this,e),this.largestBatchId=t,this.mutation=n},[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}])}(),bi=V(function e(t,n,r){R(this,e),this.alias=t,this.aggregateType=n,this.fieldPath=r}),Ii=V(function e(t,n){R(this,e),this.count=t,this.unchangedNames=n});function _i(e){switch(e){default:return X();case te.CANCELLED:case te.UNKNOWN:case te.DEADLINE_EXCEEDED:case te.RESOURCE_EXHAUSTED:case te.INTERNAL:case te.UNAVAILABLE:case te.UNAUTHENTICATED:return!1;case te.INVALID_ARGUMENT:case te.NOT_FOUND:case te.ALREADY_EXISTS:case te.PERMISSION_DENIED:case te.FAILED_PRECONDITION:case te.ABORTED:case te.OUT_OF_RANGE:case te.UNIMPLEMENTED:case te.DATA_LOSS:return!0}}function Ei(e){if(void 0===e)return H("GRPC error has no .code"),te.UNKNOWN;switch(e){case pi.OK:return te.OK;case pi.CANCELLED:return te.CANCELLED;case pi.UNKNOWN:return te.UNKNOWN;case pi.DEADLINE_EXCEEDED:return te.DEADLINE_EXCEEDED;case pi.RESOURCE_EXHAUSTED:return te.RESOURCE_EXHAUSTED;case pi.INTERNAL:return te.INTERNAL;case pi.UNAVAILABLE:return te.UNAVAILABLE;case pi.UNAUTHENTICATED:return te.UNAUTHENTICATED;case pi.INVALID_ARGUMENT:return te.INVALID_ARGUMENT;case pi.NOT_FOUND:return te.NOT_FOUND;case pi.ALREADY_EXISTS:return te.ALREADY_EXISTS;case pi.PERMISSION_DENIED:return te.PERMISSION_DENIED;case pi.FAILED_PRECONDITION:return te.FAILED_PRECONDITION;case pi.ABORTED:return te.ABORTED;case pi.OUT_OF_RANGE:return te.OUT_OF_RANGE;case pi.UNIMPLEMENTED:return te.UNIMPLEMENTED;case pi.DATA_LOSS:return te.DATA_LOSS;default:return X()}}(yi=pi||(pi={}))[yi.OK=0]="OK",yi[yi.CANCELLED=1]="CANCELLED",yi[yi.UNKNOWN=2]="UNKNOWN",yi[yi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yi[yi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yi[yi.NOT_FOUND=5]="NOT_FOUND",yi[yi.ALREADY_EXISTS=6]="ALREADY_EXISTS",yi[yi.PERMISSION_DENIED=7]="PERMISSION_DENIED",yi[yi.UNAUTHENTICATED=16]="UNAUTHENTICATED",yi[yi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yi[yi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yi[yi.ABORTED=10]="ABORTED",yi[yi.OUT_OF_RANGE=11]="OUT_OF_RANGE",yi[yi.UNIMPLEMENTED=12]="UNIMPLEMENTED",yi[yi.INTERNAL=13]="INTERNAL",yi[yi.UNAVAILABLE=14]="UNAVAILABLE",yi[yi.DATA_LOSS=15]="DATA_LOSS";var Ti=null;function Si(){return new TextEncoder}var Ci=new o.Integer([4294967295,4294967295],0);function Di(e){var t=Si().encode(e),n=new o.Md5;return n.update(t),new Uint8Array(n.digest())}function Ai(e){var t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new o.Integer([n,r],0),new o.Integer([i,a],0)]}var Ni=function(){function e(t,n,r){if(R(this,e),this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Mi("Invalid padding: ".concat(n));if(r<0)throw new Mi("Invalid hash count: ".concat(r));if(t.length>0&&0===this.hashCount)throw new Mi("Invalid hash count: ".concat(r));if(0===t.length&&0!==n)throw new Mi("Invalid padding when bitmap length is 0: ".concat(n));this.Ie=8*t.length-n,this.Te=o.Integer.fromNumber(this.Ie)}return V(e,[{key:"Ee",value:function(e,t,n){var r=e.add(t.multiply(o.Integer.fromNumber(n)));return 1===r.compare(Ci)&&(r=new o.Integer([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}},{key:"de",value:function(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}},{key:"mightContain",value:function(e){if(0===this.Ie)return!1;for(var t=f(Ai(Di(e)),2),n=t[0],r=t[1],i=0;i<this.hashCount;i++){var a=this.Ee(n,r,i);if(!this.de(a))return!1}return!0}},{key:"insert",value:function(e){if(0!==this.Ie)for(var t=f(Ai(Di(e)),2),n=t[0],r=t[1],i=0;i<this.hashCount;i++){var a=this.Ee(n,r,i);this.Ae(a)}}},{key:"Ae",value:function(e){var t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}],[{key:"create",value:function(t,n,r){var i=t%8==0?0:8-t%8,a=new e(new Uint8Array(Math.ceil(t/8)),i,n);return r.forEach(function(e){return a.insert(e)}),a}}])}(),Mi=function(e){function t(){var e;return R(this,t),(e=b(this,t,arguments)).name="BloomFilterError",e}return S(t,p(Error)),V(t)}(),Fi=function(){function e(t,n,r,i,a){R(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return V(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n,r){var i=new Map;return i.set(t,Li.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e(ke.min(),i,new Ot(pe),Tr(),Pr())}}])}(),Li=function(){function e(t,n,r,i,a){R(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return V(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n,r){return new e(r,n,Pr(),Pr(),Pr())}}])}(),Pi=V(function e(t,n,r,i){R(this,e),this.Re=t,this.removedTargetIds=n,this.key=r,this.Ve=i}),Ri=V(function e(t,n){R(this,e),this.targetId=t,this.me=n}),Oi=V(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jt.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;R(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),Vi=function(){return V(function e(){R(this,e),this.fe=0,this.ge=Bi(),this.pe=jt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0},[{key:"current",get:function(){return this.ye}},{key:"resumeToken",get:function(){return this.pe}},{key:"Se",get:function(){return 0!==this.fe}},{key:"be",get:function(){return this.we}},{key:"De",value:function(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}},{key:"Ce",value:function(){var e=Pr(),t=Pr(),n=Pr();return this.ge.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:X()}}),new Li(this.pe,this.ye,e,t,n)}},{key:"ve",value:function(){this.we=!1,this.ge=Bi()}},{key:"Fe",value:function(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}},{key:"Me",value:function(e){this.we=!0,this.ge=this.ge.remove(e)}},{key:"xe",value:function(){this.fe+=1}},{key:"Oe",value:function(){this.fe-=1,Z(this.fe>=0)}},{key:"Ne",value:function(){this.we=!0,this.ye=!0}}])}(),qi=function(){return V(function e(t){R(this,e),this.Le=t,this.Be=new Map,this.ke=Tr(),this.qe=Ui(),this.Qe=new Ot(pe)},[{key:"Ke",value:function(e){var t,n=g(e.Re);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve)}}catch(o){n.e(o)}finally{n.f()}var i,a=g(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var u=i.value;this.Ue(u,e.key,e.Ve)}}catch(o){a.e(o)}finally{a.f()}}},{key:"We",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.Ge(n);switch(e.state){case 0:t.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||t.removeTarget(n);break;case 3:t.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:t.ze(n)&&(t.je(n),r.De(e.resumeToken));break;default:X()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(function(e,r){n.ze(r)&&t(r)})}},{key:"He",value:function(e){var t=e.targetId,n=e.me.count,r=this.Je(t);if(r){var i=r.target;if(nr(i))if(0===n){var a=new _e(i.path);this.Ue(t,a,Sn.newNoDocument(a,ke.min()))}else Z(1===n);else{var u=this.Ye(t);if(u!==n){var o=this.Ze(e),s=o?this.Xe(o,e,u):1;if(0!==s){this.je(t);var c=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}null==Ti||Ti.et(function(e,t,n,r,i){var a,u,o,s,c,l,f={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(f.bloomFilter={applied:0===i,hashCount:null!==(a=null==h?void 0:h.hashCount)&&void 0!==a?a:0,bitmapLength:null!==(s=null===(o=null===(u=null==h?void 0:h.bits)||void 0===u?void 0:u.bitmap)||void 0===o?void 0:o.length)&&void 0!==s?s:0,padding:null!==(l=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0,mightContain:function(e){var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),f}(u,e.me,this.Le.tt(),o,s))}}}}},{key:"Ze",value:function(e){var t=e.me.unchangedNames;if(!t||!t.bits)return null;var n,r,i=t.bits,a=i.bitmap,u=void 0===a?"":a,o=i.padding,s=void 0===o?0:o,c=t.hashCount,l=void 0===c?0:c;try{n=Yt(u).toUint8Array()}catch(e){if(e instanceof Kt)return J("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{r=new Ni(n,s,l)}catch(e){return J(e instanceof Mi?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===r.Ie?null:r}},{key:"Xe",value:function(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}},{key:"nt",value:function(e,t){var n=this,r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(function(r){var a=n.Le.tt(),u="projects/".concat(a.projectId,"/databases/").concat(a.database,"/documents/").concat(r.path.canonicalString());e.mightContain(u)||(n.Ue(t,r,null),i++)}),i}},{key:"rt",value:function(e){var t=this,n=new Map;this.Be.forEach(function(r,i){var a=t.Je(i);if(a){if(r.current&&nr(a.target)){var u=new _e(a.target.path);null!==t.ke.get(u)||t.it(i,u)||t.Ue(i,u,Sn.newNoDocument(u,e))}r.be&&(n.set(i,r.Ce()),r.ve())}});var r=Pr();this.qe.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.Je(e);return!n||"TargetPurposeLimboResolution"===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))}),this.ke.forEach(function(t,n){return n.setReadTime(e)});var i=new Fi(e,n,this.Qe,this.ke,r);return this.ke=Tr(),this.qe=Ui(),this.Qe=new Ot(pe),i}},{key:"$e",value:function(e,t){if(this.ze(e)){var n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}}},{key:"Ue",value:function(e,t,n){if(this.ze(e)){var r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Be.delete(e)}},{key:"Ye",value:function(e){var t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"xe",value:function(e){this.Ge(e).xe()}},{key:"Ge",value:function(e){var t=this.Be.get(e);return t||(t=new Vi,this.Be.set(e,t)),t}},{key:"st",value:function(e){var t=this.qe.get(e);return t||(t=new Ut(pe),this.qe=this.qe.insert(e,t)),t}},{key:"ze",value:function(e){var t=null!==this.Je(e);return t||W("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Je",value:function(e){var t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}},{key:"je",value:function(e){var t=this;this.Be.set(e,new Vi),this.Le.getRemoteKeysForTarget(e).forEach(function(n){t.Ue(e,n,null)})}},{key:"it",value:function(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}])}();function Ui(){return new Ot(_e.comparator)}function Bi(){return new Ot(_e.comparator)}var zi={asc:"ASCENDING",desc:"DESCENDING"},Gi={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ki={and:"AND",or:"OR"},Qi=V(function e(t,n){R(this,e),this.databaseId=t,this.useProto3Json=n});function ji(e,t){return e.useProto3Json||et(t)?t:{value:t}}function Wi(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Hi(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ji(e,t){return Wi(e,t.toTimestamp())}function Yi(e){return Z(!!e),ke.fromTimestamp(function(e){var t=Ht(e);return new ge(t.seconds,t.nanos)}(e))}function Xi(e,t){return Zi(e,t).canonicalString()}function Zi(e,t){var n=function(e){return new xe(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function $i(e){var t=xe.fromString(e);return Z(Ta(t)),t}function ea(e,t){return Xi(e.databaseId,t.path)}function ta(e,t){var n=$i(t);if(n.get(1)!==e.databaseId.projectId)throw new ne(te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new ne(te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new _e(aa(n))}function na(e,t){return Xi(e.databaseId,t)}function ra(e){var t=$i(e);return 4===t.length?xe.emptyPath():aa(t)}function ia(e){return new xe(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function aa(e){return Z(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function ua(e,t,n){return{name:ea(e,t),fields:n.value.mapValue.fields}}function oa(e,t,n){var r=ta(e,t.name),i=Yi(t.updateTime),a=t.createTime?Yi(t.createTime):ke.min(),u=new En({mapValue:{fields:t.fields}}),o=Sn.newFoundDocument(r,i,a,u);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function sa(e,t){return"found"in t?function(e,t){Z(!!t.found),t.found.name,t.found.updateTime;var n=ta(e,t.found.name),r=Yi(t.found.updateTime),i=t.found.createTime?Yi(t.found.createTime):ke.min(),a=new En({mapValue:{fields:t.found.fields}});return Sn.newFoundDocument(n,r,i,a)}(e,t):"missing"in t?function(e,t){Z(!!t.missing),Z(!!t.readTime);var n=ta(e,t.missing),r=Yi(t.readTime);return Sn.newNoDocument(n,r)}(e,t):X()}function ca(e,t){var r;if("targetChange"in t){t.targetChange;var i=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:X()}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],u=function(e,t){return e.useProto3Json?(Z(void 0===t||"string"==typeof t),jt.fromBase64String(t||"")):(Z(void 0===t||t instanceof n||t instanceof Uint8Array),jt.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&function(e){var t=void 0===e.code?te.UNKNOWN:Ei(e.code);return new ne(t,e.message||"")}(o);r=new Oi(i,a,u,s||null)}else if("documentChange"in t){t.documentChange;var c=t.documentChange;c.document,c.document.name,c.document.updateTime;var l=ta(e,c.document.name),f=Yi(c.document.updateTime),h=c.document.createTime?Yi(c.document.createTime):ke.min(),d=new En({mapValue:{fields:c.document.fields}}),v=Sn.newFoundDocument(l,f,h,d),p=c.targetIds||[],y=c.removedTargetIds||[];r=new Pi(p,y,v.key,v)}else if("documentDelete"in t){t.documentDelete;var m=t.documentDelete;m.document;var g=ta(e,m.document),k=m.readTime?Yi(m.readTime):ke.min(),w=Sn.newNoDocument(g,k),x=m.removedTargetIds||[];r=new Pi([],x,w.key,w)}else if("documentRemove"in t){t.documentRemove;var b=t.documentRemove;b.document;var I=ta(e,b.document),_=b.removedTargetIds||[];r=new Pi([],_,I,null)}else{if(!("filter"in t))return X();t.filter;var E=t.filter;E.targetId;var T=E.count,S=void 0===T?0:T,C=E.unchangedNames,D=new Ii(S,C),A=E.targetId;r=new Ri(A,D)}return r}function la(e,t){var n;if(t instanceof li)n={update:ua(e,t.key,t.value)};else if(t instanceof mi)n={delete:ea(e,t.key)};else if(t instanceof fi)n={update:ua(e,t.key,t.data),updateMask:Ea(t.fieldMask)};else{if(!(t instanceof gi))return X();n={verify:ea(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof Qr)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof jr)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Hr)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Yr)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw X()}(0,e)})),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ji(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:X()}(e,t.precondition)),n}function fa(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?ni.updateTime(Yi(e.updateTime)):void 0!==e.exists?ni.exists(e.exists):ni.none()}(t.currentDocument):ni.none(),r=t.updateTransforms?t.updateTransforms.map(function(t){return function(e,t){var n=null;if("setToServerValue"in t)Z("REQUEST_TIME"===t.setToServerValue),n=new Qr;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new jr(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new Hr(i)}else"increment"in t?n=new Yr(e,t.increment):X();var a=Ie.fromServerFormat(t.fieldPath);return new $r(a,n)}(e,t)}):[];if(t.update){t.update.name;var i=ta(e,t.update.name),a=new En({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=function(e){var t=e.fieldPaths||[];return new Gt(t.map(function(e){return Ie.fromServerFormat(e)}))}(t.updateMask);return new fi(i,a,u,n,r)}return new li(i,a,n,r)}if(t.delete){var o=ta(e,t.delete);return new mi(o,n)}if(t.verify){var s=ta(e,t.verify);return new gi(s,n)}return X()}function ha(e,t){return e&&e.length>0?(Z(void 0!==t),e.map(function(e){return function(e,t){var n=e.updateTime?Yi(e.updateTime):Yi(t);return n.isEqual(ke.min())&&(n=Yi(t)),new ti(n,e.transformResults||[])}(e,t)})):[]}function da(e,t){return{documents:[na(e,t.path)]}}function va(e,t){var n,r={structuredQuery:{}},i=t.path;null!==t.collectionGroup?(n=i,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n=i.popLast(),r.structuredQuery.from=[{collectionId:i.lastSegment()}]),r.parent=na(e,n);var a=function(e){if(0!==e.length)return _a(Pn.create(e,"and"))}(t.filters);a&&(r.structuredQuery.where=a);var u=function(e){if(0!==e.length)return e.map(function(e){return function(e){return{field:ba(e.field),direction:ka(e.dir)}}(e)})}(t.orderBy);u&&(r.structuredQuery.orderBy=u);var o=ji(e,t.limit);return null!==o&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:r,parent:n}}function pa(e,t,n,r){var i=va(e,t),a=i._t,u=i.parent,o={},s=[],c=0;return n.forEach(function(e){var t=r?e.alias:"aggregate_"+c++;o[t]=e.alias,"count"===e.aggregateType?s.push({alias:t,count:{}}):"avg"===e.aggregateType?s.push({alias:t,avg:{field:ba(e.fieldPath)}}):"sum"===e.aggregateType&&s.push({alias:t,sum:{field:ba(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:s,structuredQuery:a.structuredQuery},parent:a.parent},ut:o,parent:u}}function ya(e){var t=ra(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Z(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var u=[];n.where&&(u=function(e){var t=ga(e);return t instanceof Pn&&Vn(t)?t.getFilters():[t]}(n.where));var o=[];n.orderBy&&(o=function(e){return e.map(function(e){return function(e){return new Nn(Ia(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})}(n.orderBy));var s=null;n.limit&&(s=function(e){var t;return et(t="object"==P(e)?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=function(e){var t=!!e.before,n=e.values||[];return new Cn(n,t)}(n.startAt));var l=null;return n.endAt&&(l=function(e){var t=!e.before,n=e.values||[];return new Cn(n,t)}(n.endAt)),or(t,i,o,u,s,"F",c,l)}function ma(e,t){var n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return X()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}function ga(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Ia(e.unaryFilter.field);return Ln.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Ia(e.unaryFilter.field);return Ln.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ia(e.unaryFilter.field);return Ln.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ia(e.unaryFilter.field);return Ln.create(i,"!=",{nullValue:"NULL_VALUE"});default:return X()}}(e):void 0!==e.fieldFilter?function(e){return Ln.create(Ia(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return X()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Pn.create(e.compositeFilter.filters.map(function(e){return ga(e)}),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return X()}}(e.compositeFilter.op))}(e):X()}function ka(e){return zi[e]}function wa(e){return Gi[e]}function xa(e){return Ki[e]}function ba(e){return{fieldPath:e.canonicalString()}}function Ia(e){return Ie.fromServerFormat(e.fieldPath)}function _a(e){return e instanceof Ln?function(e){if("=="===e.op){if(mn(e.value))return{unaryFilter:{field:ba(e.field),op:"IS_NAN"}};if(yn(e.value))return{unaryFilter:{field:ba(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(mn(e.value))return{unaryFilter:{field:ba(e.field),op:"IS_NOT_NAN"}};if(yn(e.value))return{unaryFilter:{field:ba(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ba(e.field),op:wa(e.op),value:e.value}}}(e):e instanceof Pn?function(e){var t=e.getFilters().map(function(e){return _a(e)});return 1===t.length?t[0]:{compositeFilter:{op:xa(e.op),filters:t}}}(e):X()}function Ea(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function Ta(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var Sa=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ke.min(),u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ke.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:jt.EMPTY_BYTE_STRING,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;R(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=o,this.expectedCount=s}return V(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}},{key:"withExpectedCount",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}])}(),Ca=V(function e(t){R(this,e),this.ct=t});function Da(e,t){var n;if(t.document)n=oa(e.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){var r=_e.fromSegments(t.noDocument.path),i=Fa(t.noDocument.readTime);n=Sn.newNoDocument(r,i),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return X();var a=_e.fromSegments(t.unknownDocument.path),u=Fa(t.unknownDocument.version);n=Sn.newUnknownDocument(a,u)}return t.readTime&&n.setReadTime(function(e){var t=new ge(e[0],e[1]);return ke.fromTimestamp(t)}(t.readTime)),n}function Aa(e,t){var n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Na(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:ea(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Wi(e,t.version.toTimestamp()),createTime:Wi(e,t.createTime.toTimestamp())}}(e.ct,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ma(t.version)};else{if(!t.isUnknownDocument())return X();r.unknownDocument={path:n.path.toArray(),version:Ma(t.version)}}return r}function Na(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Ma(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Fa(e){var t=new ge(e.seconds,e.nanoseconds);return ke.fromTimestamp(t)}function La(e,t){for(var n=(t.baseMutations||[]).map(function(t){return fa(e.ct,t)}),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var a=t.mutations[r+1];i.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var u=t.mutations.map(function(t){return fa(e.ct,t)}),o=ge.fromMillis(t.localWriteTimeMs);return new ki(t.batchId,o,n,u)}function Pa(e){var t,n=Fa(e.readTime),r=void 0!==e.lastLimboFreeSnapshotVersion?Fa(e.lastLimboFreeSnapshotVersion):ke.min();return t=function(e){return void 0!==e.documents}(e.query)?function(e){return Z(1===e.documents.length),hr(sr(ra(e.documents[0])))}(e.query):function(e){return hr(ya(e))}(e.query),new Sa(t,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,n,r,jt.fromBase64String(e.resumeToken))}function Ra(e,t){var n,r=Ma(t.snapshotVersion),i=Ma(t.lastLimboFreeSnapshotVersion);n=nr(t.target)?da(e.ct,t.target):va(e.ct,t.target)._t;var a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:er(t.target),readTime:r,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function Oa(e){var t=ya({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?yr(t,t.limit,"L"):t}function Va(e,t){return new xi(t.largestBatchId,fa(e.ct,t.overlayMutation))}function qa(e,t){var n=t.path.lastSegment();return[e,rt(t.path.popLast()),n]}function Ua(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:Ma(r.readTime),documentKey:rt(r.documentKey.path),largestBatchId:r.largestBatchId}}var Ba=function(){return V(function e(){R(this,e)},[{key:"getBundleMetadata",value:function(e,t){return za(e).get(t).next(function(e){if(e)return function(e){return{id:e.bundleId,createTime:Fa(e.createTime),version:e.version}}(e)})}},{key:"saveBundleMetadata",value:function(e,t){return za(e).put(function(e){return{bundleId:e.id,createTime:Ma(Yi(e.createTime)),version:e.version}}(t))}},{key:"getNamedQuery",value:function(e,t){return Ga(e).get(t).next(function(e){if(e)return function(e){return{name:e.name,query:Oa(e.bundledQuery),readTime:Fa(e.readTime)}}(e)})}},{key:"saveNamedQuery",value:function(e,t){return Ga(e).put(function(e){return{name:e.name,readTime:Ma(Yi(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}])}();function za(e){return Mt(e,"bundles")}function Ga(e){return Mt(e,"namedQueries")}var Ka=function(){function e(t,n){R(this,e),this.serializer=t,this.userId=n}return V(e,[{key:"getOverlay",value:function(e,t){var n=this;return Qa(e).get(qa(this.userId,t)).next(function(e){return e?Va(n.serializer,e):null})}},{key:"getOverlays",value:function(e,t){var n=this,r=Ar();return Ue.forEach(t,function(t){return n.getOverlay(e,t).next(function(e){null!==e&&r.set(t,e)})}).next(function(){return r})}},{key:"saveOverlays",value:function(e,t,n){var r=this,i=[];return n.forEach(function(n,a){var u=new xi(t,a);i.push(r.ht(e,u))}),Ue.waitFor(i)}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=new Set;t.forEach(function(e){return i.add(rt(e.getCollectionPath()))});var a=[];return i.forEach(function(t){var i=IDBKeyRange.bound([r.userId,t,n],[r.userId,t,n+1],!1,!0);a.push(Qa(e).j("collectionPathOverlayIndex",i))}),Ue.waitFor(a)}},{key:"getOverlaysForCollection",value:function(e,t,n){var r=this,i=Ar(),a=rt(t),u=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Qa(e).U("collectionPathOverlayIndex",u).next(function(e){var t,n=g(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,u=Va(r.serializer,a);i.set(u.getKey(),u)}}catch(o){n.e(o)}finally{n.f()}return i})}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){var i,a=this,u=Ar(),o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Qa(e).J({index:"collectionGroupOverlayIndex",range:o},function(e,t,n){var o=Va(a.serializer,t);u.size()<r||o.largestBatchId===i?(u.set(o.getKey(),o),i=o.largestBatchId):n.done()}).next(function(){return u})}},{key:"ht",value:function(e,t){return Qa(e).put(function(e,t,n){var r=f(qa(t,n.mutation.key),3);r[0];return{userId:t,collectionPath:r[1],documentId:r[2],collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:la(e.ct,n.mutation)}}(this.serializer,this.userId,t))}}],[{key:"lt",value:function(t,n){return new e(t,n.uid||"")}}])}();function Qa(e){return Mt(e,"documentOverlays")}var ja=function(){return V(function e(){R(this,e)},[{key:"Pt",value:function(e,t){this.It(e,t),t.Tt()}},{key:"It",value:function(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(Jt(e.integerValue));else if("doubleValue"in e){var n=Jt(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),tt(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){var r=e.timestampValue;this.Et(t,20),"string"==typeof r&&(r=Ht(r)),t.At("".concat(r.seconds||"")),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Yt(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.Et(t,45),t.dt(i.latitude||0),t.dt(i.longitude||0)}else"mapValue"in e?wn(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):X()}},{key:"Rt",value:function(e,t){this.Et(t,25),this.St(e,t)}},{key:"St",value:function(e,t){t.At(e)}},{key:"yt",value:function(e,t){var n=e.fields||{};this.Et(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.Rt(a,t),this.It(n[a],t)}}},{key:"wt",value:function(e,t){var n=e.values||[];this.Et(t,50);var r,i=g(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.It(a,t)}}catch(u){i.e(u)}finally{i.f()}}},{key:"gt",value:function(e,t){var n=this;this.Et(t,37),_e.fromName(e).path.forEach(function(e){n.Et(t,60),n.St(e,t)})}},{key:"Et",value:function(e,t){e.dt(t)}},{key:"Vt",value:function(e){e.dt(2)}}])}();function Wa(e){if(0===e)return 8;var t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function Ha(e){var t=64-function(e){for(var t=0,n=0;n<8;++n){var r=Wa(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}ja.bt=new ja;var Ja=function(){return V(function e(){R(this,e),this.buffer=new Uint8Array(1024),this.position=0},[{key:"Dt",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Ct(n.value),n=t.next();this.vt()}},{key:"Ft",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Mt(n.value),n=t.next();this.xt()}},{key:"Ot",value:function(e){var t,n=g(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.Ct(i);else if(i<2048)this.Ct(960|i>>>6),this.Ct(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.Ct(480|i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i);else{var a=r.codePointAt(0);this.Ct(240|a>>>18),this.Ct(128|63&a>>>12),this.Ct(128|63&a>>>6),this.Ct(128|63&a)}}}catch(u){n.e(u)}finally{n.f()}this.vt()}},{key:"Nt",value:function(e){var t,n=g(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.Mt(i);else if(i<2048)this.Mt(960|i>>>6),this.Mt(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.Mt(480|i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i);else{var a=r.codePointAt(0);this.Mt(240|a>>>18),this.Mt(128|63&a>>>12),this.Mt(128|63&a>>>6),this.Mt(128|63&a)}}}catch(u){n.e(u)}finally{n.f()}this.xt()}},{key:"Lt",value:function(e){var t=this.Bt(e),n=Ha(t);this.kt(1+n),this.buffer[this.position++]=255&n;for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}},{key:"qt",value:function(e){var t=this.Bt(e),n=Ha(t);this.kt(1+n),this.buffer[this.position++]=~(255&n);for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}},{key:"Qt",value:function(){this.Kt(255),this.Kt(255)}},{key:"$t",value:function(){this.Ut(255),this.Ut(255)}},{key:"reset",value:function(){this.position=0}},{key:"seed",value:function(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}},{key:"Wt",value:function(){return this.buffer.slice(0,this.position)}},{key:"Bt",value:function(e){var t=function(e){var t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(var r=1;r<t.length;++r)t[r]^=n?255:0;return t}},{key:"Ct",value:function(e){var t=255&e;0===t?(this.Kt(0),this.Kt(255)):255===t?(this.Kt(255),this.Kt(0)):this.Kt(t)}},{key:"Mt",value:function(e){var t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(e)}},{key:"vt",value:function(){this.Kt(0),this.Kt(1)}},{key:"xt",value:function(){this.Ut(0),this.Ut(1)}},{key:"Kt",value:function(e){this.kt(1),this.buffer[this.position++]=e}},{key:"Ut",value:function(e){this.kt(1),this.buffer[this.position++]=~e}},{key:"kt",value:function(e){var t=e+this.position;if(!(t<=this.buffer.length)){var n=2*this.buffer.length;n<t&&(n=t);var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}}])}(),Ya=function(){return V(function e(t){R(this,e),this.Gt=t},[{key:"ft",value:function(e){this.Gt.Dt(e)}},{key:"At",value:function(e){this.Gt.Ot(e)}},{key:"dt",value:function(e){this.Gt.Lt(e)}},{key:"Tt",value:function(){this.Gt.Qt()}}])}(),Xa=function(){return V(function e(t){R(this,e),this.Gt=t},[{key:"ft",value:function(e){this.Gt.Ft(e)}},{key:"At",value:function(e){this.Gt.Nt(e)}},{key:"dt",value:function(e){this.Gt.qt(e)}},{key:"Tt",value:function(){this.Gt.$t()}}])}(),Za=function(){return V(function e(){R(this,e),this.Gt=new Ja,this.zt=new Ya(this.Gt),this.jt=new Xa(this.Gt)},[{key:"seed",value:function(e){this.Gt.seed(e)}},{key:"Ht",value:function(e){return 0===e?this.zt:this.jt}},{key:"Wt",value:function(){return this.Gt.Wt()}},{key:"reset",value:function(){this.Gt.reset()}}])}(),$a=function(){function e(t,n,r,i){R(this,e),this.indexId=t,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}return V(e,[{key:"Jt",value:function(){var t=this.directionalValue.length,n=0===t||255===this.directionalValue[t-1]?t+1:t,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==t?r.set([0],this.directionalValue.length):++r[r.length-1],new e(this.indexId,this.documentKey,this.arrayValue,r)}}])}();function eu(e,t){var n=e.indexId-t.indexId;return 0!==n?n:0!==(n=tu(e.arrayValue,t.arrayValue))?n:0!==(n=tu(e.directionalValue,t.directionalValue))?n:_e.comparator(e.documentKey,t.documentKey)}function tu(e,t){for(var n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}var nu=function(){return V(function e(t){R(this,e),this.Yt=new Ut(function(e,t){return Ie.comparator(e.field,t.field)}),this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Zt=t.orderBy,this.Xt=[];var n,r=g(t.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.isInequality()?this.Yt=this.Yt.add(i):this.Xt.push(i)}}catch(a){r.e(a)}finally{r.f()}},[{key:"en",get:function(){return this.Yt.size>1}},{key:"tn",value:function(e){if(Z(e.collectionGroup===this.collectionId),this.en)return!1;var t=Te(e);if(void 0!==t&&!this.nn(t))return!1;for(var n=Se(e),r=new Set,i=0,a=0;i<n.length&&this.nn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Yt.size>0){var u=this.Yt.getIterator().getNext();if(!r.has(u.field.canonicalString())){var o=n[i];if(!this.rn(u,o)||!this.sn(this.Zt[a++],o))return!1}++i}for(;i<n.length;++i){var s=n[i];if(a>=this.Zt.length||!this.sn(this.Zt[a++],s))return!1}return!0}},{key:"on",value:function(){if(this.en)return null;var e,t=new Ut(Ie.comparator),n=[],r=g(this.Xt);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(!i.field.isKeyField())if("array-contains"===i.op||"array-contains-any"===i.op)n.push(new De(i.field,2));else{if(t.has(i.field))continue;t=t.add(i.field),n.push(new De(i.field,0))}}}catch(s){r.e(s)}finally{r.f()}var a,u=g(this.Zt);try{for(u.s();!(a=u.n()).done;){var o=a.value;o.field.isKeyField()||t.has(o.field)||(t=t.add(o.field),n.push(new De(o.field,"asc"===o.dir?0:1)))}}catch(s){u.e(s)}finally{u.f()}return new Ee(Ee.UNKNOWN_ID,this.collectionId,n,Ne.empty())}},{key:"nn",value:function(e){var t,n=g(this.Xt);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.rn(r,e))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"rn",value:function(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}},{key:"sn",value:function(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}])}();function ru(e){var t,n;if(Z(e instanceof Ln||e instanceof Pn),e instanceof Ln){if(e instanceof Jn){var r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map(function(t){return Ln.create(e.field,"==",t)}))||[];return Pn.create(r,"or")}return e}var i=e.filters.map(function(e){return ru(e)});return Pn.create(i,e.op)}function iu(e){if(0===e.getFilters().length)return[];var t=su(ru(e));return Z(ou(t)),au(t)||uu(t)?[t]:t.getFilters()}function au(e){return e instanceof Ln}function uu(e){return e instanceof Pn&&Vn(e)}function ou(e){return au(e)||uu(e)||function(e){if(e instanceof Pn&&On(e)){var t,n=g(e.getFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!au(r)&&!uu(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}return!1}(e)}function su(e){if(Z(e instanceof Ln||e instanceof Pn),e instanceof Ln)return e;if(1===e.filters.length)return su(e.filters[0]);var t=e.filters.map(function(e){return su(e)}),n=Pn.create(t,e.op);return ou(n=fu(n))?n:(Z(n instanceof Pn),Z(Rn(n)),Z(n.filters.length>1),n.filters.reduce(function(e,t){return cu(e,t)}))}function cu(e,t){return Z(e instanceof Ln||e instanceof Pn),Z(t instanceof Ln||t instanceof Pn),fu(e instanceof Ln?t instanceof Ln?function(e,t){return Pn.create([e,t],"and")}(e,t):lu(e,t):t instanceof Ln?lu(t,e):function(e,t){if(Z(e.filters.length>0&&t.filters.length>0),Rn(e)&&Rn(t))return zn(e,t.getFilters());var n=On(e)?e:t,r=On(e)?t:e,i=n.filters.map(function(e){return cu(e,r)});return Pn.create(i,"or")}(e,t))}function lu(e,t){if(Rn(t))return zn(t,e.getFilters());var n=t.filters.map(function(t){return cu(e,t)});return Pn.create(n,"or")}function fu(e){if(Z(e instanceof Ln||e instanceof Pn),e instanceof Ln)return e;var t=e.getFilters();if(1===t.length)return fu(t[0]);if(qn(e))return e;var n=t.map(function(e){return fu(e)}),r=[];return n.forEach(function(t){t instanceof Ln?r.push(t):t instanceof Pn&&(t.op===e.op?r.push.apply(r,D(t.filters)):r.push(t))}),1===r.length?r[0]:Pn.create(r,e.op)}var hu=function(){return V(function e(){R(this,e),this._n=new du},[{key:"addToCollectionParentIndex",value:function(e,t){return this._n.add(t),Ue.resolve()}},{key:"getCollectionParents",value:function(e,t){return Ue.resolve(this._n.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Ue.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Ue.resolve()}},{key:"deleteAllFieldIndexes",value:function(e){return Ue.resolve()}},{key:"createTargetIndexes",value:function(e,t){return Ue.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Ue.resolve(null)}},{key:"getIndexType",value:function(e,t){return Ue.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return Ue.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Ue.resolve(null)}},{key:"getMinOffset",value:function(e,t){return Ue.resolve(Le.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return Ue.resolve(Le.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return Ue.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Ue.resolve()}}])}(),du=function(){return V(function e(){R(this,e),this.index={}},[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ut(xe.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new Ut(xe.comparator)).toArray()}}])}(),vu=new Uint8Array(0),pu=function(){return V(function e(t,n){R(this,e),this.databaseId=n,this.an=new du,this.un=new _r(function(e){return er(e)},function(e,t){return tr(e,t)}),this.uid=t.uid||""},[{key:"addToCollectionParentIndex",value:function(e,t){var n=this;if(!this.an.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(function(){n.an.add(t)});var a={collectionId:r,parent:rt(i)};return yu(e).put(a)}return Ue.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[me(t),""],!1,!0);return yu(e).U(r).next(function(e){var r,i=g(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.collectionId!==t)break;n.push(ut(a.parent))}}catch(u){i.e(u)}finally{i.f()}return n})}},{key:"addFieldIndex",value:function(e,t){var n=this,r=gu(e),i=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map(function(e){return[e.fieldPath.canonicalString(),e.kind]})}}(t);delete i.indexId;var a=r.add(i);if(t.indexState){var u=ku(e);return a.next(function(e){u.put(Ua(e,n.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}},{key:"deleteFieldIndex",value:function(e,t){var n=gu(e),r=ku(e),i=mu(e);return n.delete(t.indexId).next(function(){return r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))}).next(function(){return i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))})}},{key:"deleteAllFieldIndexes",value:function(e){var t=gu(e),n=mu(e),r=ku(e);return t.j().next(function(){return n.j()}).next(function(){return r.j()})}},{key:"createTargetIndexes",value:function(e,t){var n=this;return Ue.forEach(this.cn(t),function(t){return n.getIndexType(e,t).next(function(r){if(0===r||1===r){var i=new nu(t).on();if(null!=i)return n.addFieldIndex(e,i)}})})}},{key:"getDocumentsMatchingTarget",value:function(e,t){var n=this,r=mu(e),i=!0,a=new Map;return Ue.forEach(this.cn(t),function(t){return n.ln(e,t).next(function(e){i&&(i=!!e),a.set(t,e)})}).next(function(){if(i){var e=Pr(),u=[];return Ue.forEach(a,function(i,a){var o;W("IndexedDbIndexManager","Using index ".concat((o=i,"id=".concat(o.indexId,"|cg=").concat(o.collectionGroup,"|f=").concat(o.fields.map(function(e){return"".concat(e.fieldPath,":").concat(e.kind)}).join(",")))," to execute ").concat(er(t)));var s=function(e,t){var n=Te(t);if(void 0===n)return null;var r,i=g(rr(e,n.fieldPath));try{for(i.s();!(r=i.n()).done;){var a=r.value;switch(a.op){case"array-contains-any":return a.value.arrayValue.values||[];case"array-contains":return[a.value]}}}catch(u){i.e(u)}finally{i.f()}return null}(a,i),c=function(e,t){var n,r=new Map,i=g(Se(t));try{for(i.s();!(n=i.n()).done;){var a,u=n.value,o=g(rr(e,u.fieldPath));try{for(o.s();!(a=o.n()).done;){var s=a.value;switch(s.op){case"==":case"in":r.set(u.fieldPath.canonicalString(),s.value);break;case"not-in":case"!=":return r.set(u.fieldPath.canonicalString(),s.value),Array.from(r.values())}}}catch(c){o.e(c)}finally{o.f()}}}catch(c){i.e(c)}finally{i.f()}return null}(a,i),l=function(e,t){var n,r=[],i=!0,a=g(Se(t));try{for(a.s();!(n=a.n()).done;){var u=n.value,o=0===u.kind?ir(e,u.fieldPath,e.startAt):ar(e,u.fieldPath,e.startAt);r.push(o.value),i&&(i=o.inclusive)}}catch(s){a.e(s)}finally{a.f()}return new Cn(r,i)}(a,i),f=function(e,t){var n,r=[],i=!0,a=g(Se(t));try{for(a.s();!(n=a.n()).done;){var u=n.value,o=0===u.kind?ar(e,u.fieldPath,e.endAt):ir(e,u.fieldPath,e.endAt);r.push(o.value),i&&(i=o.inclusive)}}catch(s){a.e(s)}finally{a.f()}return new Cn(r,i)}(a,i),h=n.hn(i,a,l),d=n.hn(i,a,f),v=n.Pn(i,a,c),p=n.In(i.indexId,s,h,l.inclusive,d,f.inclusive,v);return Ue.forEach(p,function(n){return r.G(n,t.limit).next(function(t){t.forEach(function(t){var n=_e.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),u.push(n))})})})}).next(function(){return u})}return Ue.resolve(null)})}},{key:"cn",value:function(e){var t=this.un.get(e);return t||(t=0===e.filters.length?[e]:iu(Pn.create(e.filters,"and")).map(function(t){return $n(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)}),this.un.set(e,t),t)}},{key:"In",value:function(e,t,n,r,i,a,u){for(var o=this,s=(null!=t?t.length:1)*Math.max(n.length,i.length),c=s/(null!=t?t.length:1),l=[],f=function(){var s=t?o.Tn(t[h/c]):vu,f=o.En(e,s,n[h%c],r),d=o.dn(e,s,i[h%c],a),v=u.map(function(t){return o.En(e,s,t,!0)});l.push.apply(l,D(o.createRange(f,d,v)))},h=0;h<s;++h)f();return l}},{key:"En",value:function(e,t,n,r){var i=new $a(e,_e.empty(),t,n);return r?i:i.Jt()}},{key:"dn",value:function(e,t,n,r){var i=new $a(e,_e.empty(),t,n);return r?i.Jt():i}},{key:"ln",value:function(e,t){var n=new nu(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(function(e){var t,r=null,i=g(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;n.tn(a)&&(!r||a.fields.length>r.fields.length)&&(r=a)}}catch(u){i.e(u)}finally{i.f()}return r})}},{key:"getIndexType",value:function(e,t){var n=this,r=2,i=this.cn(t);return Ue.forEach(i,function(t){return n.ln(e,t).next(function(e){e?0!==r&&e.fields.length<function(e){var t,n=new Ut(Ie.comparator),r=!1,i=g(e.filters);try{for(i.s();!(t=i.n()).done;){var a,u=g(t.value.getFlattenedFilters());try{for(u.s();!(a=u.n()).done;){var o=a.value;o.field.isKeyField()||("array-contains"===o.op||"array-contains-any"===o.op?r=!0:n=n.add(o.field))}}catch(f){u.e(f)}finally{u.f()}}}catch(f){i.e(f)}finally{i.f()}var s,c=g(e.orderBy);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.field.isKeyField()||(n=n.add(l.field))}}catch(f){c.e(f)}finally{c.f()}return n.size+(r?1:0)}(t)&&(r=1):r=0})}).next(function(){return null!==t.limit&&i.length>1&&2===r?1:r})}},{key:"An",value:function(e,t){var n,r=new Za,i=g(Se(e));try{for(i.s();!(n=i.n()).done;){var a=n.value,u=t.data.field(a.fieldPath);if(null==u)return null;var o=r.Ht(a.kind);ja.bt.Pt(u,o)}}catch(s){i.e(s)}finally{i.f()}return r.Wt()}},{key:"Tn",value:function(e){var t=new Za;return ja.bt.Pt(e,t.Ht(0)),t.Wt()}},{key:"Rn",value:function(e,t){var n=new Za;return ja.bt.Pt(dn(this.databaseId,t),n.Ht(function(e){var t=Se(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Wt()}},{key:"Pn",value:function(e,t,n){if(null===n)return[];var r=[];r.push(new Za);var i,a=0,u=g(Se(e));try{for(u.s();!(i=u.n()).done;){var o,s=i.value,c=n[a++],l=g(r);try{for(l.s();!(o=l.n()).done;){var f=o.value;if(this.Vn(t,s.fieldPath)&&pn(c))r=this.mn(r,s,c);else{var h=f.Ht(s.kind);ja.bt.Pt(c,h)}}}catch(d){l.e(d)}finally{l.f()}}}catch(d){u.e(d)}finally{u.f()}return this.fn(r)}},{key:"hn",value:function(e,t,n){return this.Pn(e,t,n.position)}},{key:"fn",value:function(e){for(var t=[],n=0;n<e.length;++n)t[n]=e[n].Wt();return t}},{key:"mn",value:function(e,t,n){var r,i=D(e),a=[],u=g(n.arrayValue.values||[]);try{for(u.s();!(r=u.n()).done;){var o,s=r.value,c=g(i);try{for(c.s();!(o=c.n()).done;){var l=o.value,f=new Za;f.seed(l.Wt()),ja.bt.Pt(s,f.Ht(t.kind)),a.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){u.e(h)}finally{u.f()}return a}},{key:"Vn",value:function(e,t){return!!e.filters.find(function(e){return e instanceof Ln&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)})}},{key:"getFieldIndexes",value:function(e,t){var n=this,r=gu(e),i=ku(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(function(e){var t=[];return Ue.forEach(e,function(e){return i.get([e.indexId,n.uid]).next(function(n){t.push(function(e,t){var n=t?new Ne(t.sequenceNumber,new Le(Fa(t.readTime),new _e(ut(t.documentKey)),t.largestBatchId)):Ne.empty(),r=e.fields.map(function(e){var t=f(e,2),n=t[0],r=t[1];return new De(Ie.fromServerFormat(n),r)});return new Ee(e.indexId,e.collectionGroup,r,n)}(e,n))})}).next(function(){return t})})}},{key:"getNextCollectionGroupToUpdate",value:function(e){return this.getFieldIndexes(e).next(function(e){return 0===e.length?null:(e.sort(function(e,t){var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:pe(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup)})}},{key:"updateCollectionGroup",value:function(e,t,n){var r=this,i=gu(e),a=ku(e);return this.gn(e).next(function(e){return i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(function(t){return Ue.forEach(t,function(t){return a.put(Ua(t.indexId,r.uid,e,n))})})})}},{key:"updateIndexEntries",value:function(e,t){var n=this,r=new Map;return Ue.forEach(t,function(t,i){var a=r.get(t.collectionGroup);return(a?Ue.resolve(a):n.getFieldIndexes(e,t.collectionGroup)).next(function(a){return r.set(t.collectionGroup,a),Ue.forEach(a,function(r){return n.pn(e,t,r).next(function(t){var a=n.yn(i,r);return t.isEqual(a)?Ue.resolve():n.wn(e,i,r,t,a)})})})})}},{key:"Sn",value:function(e,t,n,r){return mu(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.Rn(n,t.key),documentKey:t.key.path.toArray()})}},{key:"bn",value:function(e,t,n,r){return mu(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.Rn(n,t.key),t.key.path.toArray()])}},{key:"pn",value:function(e,t,n){var r=mu(e),i=new Ut(eu);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.Rn(n,t)])},function(e,r){i=i.add(new $a(n.indexId,t,r.arrayValue,r.directionalValue))}).next(function(){return i})}},{key:"yn",value:function(e,t){var n=new Ut(eu),r=this.An(t,e);if(null==r)return n;var i=Te(t);if(null!=i){var a=e.data.field(i.fieldPath);if(pn(a)){var u,o=g(a.arrayValue.values||[]);try{for(o.s();!(u=o.n()).done;){var s=u.value;n=n.add(new $a(t.indexId,e.key,this.Tn(s),r))}}catch(c){o.e(c)}finally{o.f()}}}else n=n.add(new $a(t.indexId,e.key,vu,r));return n}},{key:"wn",value:function(e,t,n,r,i){var a=this;W("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);var u=[];return function(e,t,n,r,i){for(var a=e.getIterator(),u=t.getIterator(),o=zt(a),s=zt(u);o||s;){var c=!1,l=!1;if(o&&s){var f=n(o,s);f<0?l=!0:f>0&&(c=!0)}else null!=o?l=!0:c=!0;c?(r(s),s=zt(u)):l?(i(o),o=zt(a)):(o=zt(a),s=zt(u))}}(r,i,eu,function(r){u.push(a.Sn(e,t,n,r))},function(r){u.push(a.bn(e,t,n,r))}),Ue.waitFor(u)}},{key:"gn",value:function(e){var t=1;return ku(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},function(e,n,r){r.done(),t=n.sequenceNumber+1}).next(function(){return t})}},{key:"createRange",value:function(e,t,n){n=n.sort(function(e,t){return eu(e,t)}).filter(function(e,t,n){return!t||0!==eu(e,n[t-1])});var r=[];r.push(e);var i,a=g(n);try{for(a.s();!(i=a.n()).done;){var u=i.value,o=eu(u,e),s=eu(u,t);if(0===o)r[0]=e.Jt();else if(o>0&&s<0)r.push(u),r.push(u.Jt());else if(s>0)break}}catch(d){a.e(d)}finally{a.f()}r.push(t);for(var c=[],l=0;l<r.length;l+=2){if(this.Dn(r[l],r[l+1]))return[];var f=[r[l].indexId,this.uid,r[l].arrayValue,r[l].directionalValue,vu,[]],h=[r[l+1].indexId,this.uid,r[l+1].arrayValue,r[l+1].directionalValue,vu,[]];c.push(IDBKeyRange.bound(f,h))}return c}},{key:"Dn",value:function(e,t){return eu(e,t)>0}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return this.getFieldIndexes(e,t).next(wu)}},{key:"getMinOffset",value:function(e,t){var n=this;return Ue.mapArray(this.cn(t),function(t){return n.ln(e,t).next(function(e){return e||X()})}).next(wu)}}])}();function yu(e){return Mt(e,"collectionParents")}function mu(e){return Mt(e,"indexEntries")}function gu(e){return Mt(e,"indexConfiguration")}function ku(e){return Mt(e,"indexState")}function wu(e){Z(0!==e.length);for(var t=e[0].indexState.offset,n=t.largestBatchId,r=1;r<e.length;r++){var i=e[r].indexState.offset;Pe(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Le(t.readTime,t.documentKey,n)}var xu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},bu=function(){function e(t,n,r){R(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return V(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}])}();function Iu(e,t,n){var r=e.store("mutations"),i=e.store("documentMutations"),a=[],u=IDBKeyRange.only(n.batchId),o=0,s=r.J({range:u},function(e,t,n){return o++,n.delete()});a.push(s.next(function(){Z(1===o)}));var c,l=[],f=g(n.mutations);try{for(f.s();!(c=f.n()).done;){var h=c.value,d=ct(t,h.key.path,n.batchId);a.push(i.delete(d)),l.push(h.key)}}catch(v){f.e(v)}finally{f.f()}return Ue.waitFor(a).next(function(){return l})}function _u(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw X();t=e.noDocument}return JSON.stringify(t).length}bu.DEFAULT_COLLECTION_PERCENTILE=10,bu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bu.DEFAULT=new bu(41943040,bu.DEFAULT_COLLECTION_PERCENTILE,bu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bu.DISABLED=new bu(-1,0,0);var Eu=function(){function e(t,n,r,i){R(this,e),this.userId=t,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}return V(e,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Su(e).J({index:"userMutationsIndex",range:n},function(e,n,r){t=!1,r.done()}).next(function(){return t})}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this,a=Cu(e),u=Su(e);return u.add({}).next(function(o){Z("number"==typeof o);var s,c=new ki(o,t,n,r),l=function(e,t,n){var r=n.baseMutations.map(function(t){return la(e.ct,t)}),i=n.mutations.map(function(t){return la(e.ct,t)});return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(i.serializer,i.userId,c),f=[],h=new Ut(function(e,t){return pe(e.canonicalString(),t.canonicalString())}),d=g(r);try{for(d.s();!(s=d.n()).done;){var v=s.value,p=ct(i.userId,v.key.path,o);h=h.add(v.key.path.popLast()),f.push(u.put(l)),f.push(a.put(p,lt))}}catch(y){d.e(y)}finally{d.f()}return h.forEach(function(t){f.push(i.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(function(){i.Cn[o]=c.keys()}),Ue.waitFor(f).next(function(){return c})})}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return Su(e).get(t).next(function(e){return e?(Z(e.userId===n.userId),La(n.serializer,e)):null})}},{key:"vn",value:function(e,t){var n=this;return this.Cn[t]?Ue.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(function(e){if(e){var r=e.keys();return n.Cn[t]=r,r}return null})}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return Su(e).J({index:"userMutationsIndex",range:i},function(e,t,i){t.userId===n.userId&&(Z(t.batchId>=r),a=La(n.serializer,t)),i.done()}).next(function(){return a})}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Su(e).J({index:"userMutationsIndex",range:t,reverse:!0},function(e,t,r){n=t.batchId,r.done()}).next(function(){return n})}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Su(e).U("userMutationsIndex",n).next(function(e){return e.map(function(e){return La(t.serializer,e)})})}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=st(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Cu(e).J({range:i},function(r,i,u){var o=f(r,3),s=o[0],c=o[1],l=o[2],h=ut(c);if(s===n.userId&&t.path.isEqual(h))return Su(e).get(l).next(function(e){if(!e)throw X();Z(e.userId===n.userId),a.push(La(n.serializer,e))});u.done()}).next(function(){return a})}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Ut(pe),i=[];return t.forEach(function(t){var a=st(n.userId,t.path),u=IDBKeyRange.lowerBound(a),o=Cu(e).J({range:u},function(e,i,a){var u=f(e,3),o=u[0],s=u[1],c=u[2],l=ut(s);o===n.userId&&t.path.isEqual(l)?r=r.add(c):a.done()});i.push(o)}),Ue.waitFor(i).next(function(){return n.Fn(e,r)})}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=this,r=t.path,i=r.length+1,a=st(this.userId,r),u=IDBKeyRange.lowerBound(a),o=new Ut(pe);return Cu(e).J({range:u},function(e,t,a){var u=f(e,3),s=u[0],c=u[1],l=u[2],h=ut(c);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(o=o.add(l)):a.done()}).next(function(){return n.Fn(e,o)})}},{key:"Fn",value:function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Su(e).get(t).next(function(e){if(null===e)throw X();Z(e.userId===n.userId),r.push(La(n.serializer,e))}))}),Ue.waitFor(i).next(function(){return r})}},{key:"removeMutationBatch",value:function(e,t){var n=this;return Iu(e._e,this.userId,t).next(function(r){return e.addOnCommittedListener(function(){n.Mn(t.batchId)}),Ue.forEach(r,function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)})})}},{key:"Mn",value:function(e){delete this.Cn[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next(function(n){if(!n)return Ue.resolve();var r=IDBKeyRange.lowerBound(function(e){return[e]}(t.userId)),i=[];return Cu(e).J({range:r},function(e,n,r){if(e[0]===t.userId){var a=ut(e[1]);i.push(a)}else r.done()}).next(function(){Z(0===i.length)})})}},{key:"containsKey",value:function(e,t){return Tu(e,this.userId,t)}},{key:"xn",value:function(e){var t=this;return Du(e).get(this.userId).next(function(e){return e||{userId:t.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}})}}],[{key:"lt",value:function(t,n,r,i){return Z(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)}}])}();function Tu(e,t,n){var r=st(t,n.path),i=r[1],a=IDBKeyRange.lowerBound(r),u=!1;return Cu(e).J({range:a,H:!0},function(e,n,r){var a=f(e,3),o=a[0],s=a[1];a[2];o===t&&s===i&&(u=!0),r.done()}).next(function(){return u})}function Su(e){return Mt(e,"mutations")}function Cu(e){return Mt(e,"documentMutations")}function Du(e){return Mt(e,"mutationQueues")}var Au=function(){function e(t){R(this,e),this.On=t}return V(e,[{key:"next",value:function(){return this.On+=2,this.On}}],[{key:"Nn",value:function(){return new e(0)}},{key:"Ln",value:function(){return new e(-1)}}])}(),Nu=function(){return V(function e(t,n){R(this,e),this.referenceDelegate=t,this.serializer=n},[{key:"allocateTargetId",value:function(e){var t=this;return this.Bn(e).next(function(n){var r=new Au(n.highestTargetId);return n.highestTargetId=r.next(),t.kn(e,n).next(function(){return n.highestTargetId})})}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.Bn(e).next(function(e){return ke.fromTimestamp(new ge(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))})}},{key:"getHighestSequenceNumber",value:function(e){return this.Bn(e).next(function(e){return e.highestListenSequenceNumber})}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.Bn(e).next(function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.kn(e,i)})}},{key:"addTargetData",value:function(e,t){var n=this;return this.qn(e,t).next(function(){return n.Bn(e).next(function(r){return r.targetCount+=1,n.Qn(t,r),n.kn(e,r)})})}},{key:"updateTargetData",value:function(e,t){return this.qn(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next(function(){return Mu(e).delete(t.targetId)}).next(function(){return n.Bn(e)}).next(function(t){return Z(t.targetCount>0),t.targetCount-=1,n.kn(e,t)})}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return Mu(e).J(function(u,o){var s=Pa(o);s.sequenceNumber<=t&&null===n.get(s.targetId)&&(i++,a.push(r.removeTargetData(e,s)))}).next(function(){return Ue.waitFor(a)}).next(function(){return i})}},{key:"forEachTarget",value:function(e,t){return Mu(e).J(function(e,n){var r=Pa(n);t(r)})}},{key:"Bn",value:function(e){return Fu(e).get("targetGlobalKey").next(function(e){return Z(null!==e),e})}},{key:"kn",value:function(e,t){return Fu(e).put("targetGlobalKey",t)}},{key:"qn",value:function(e,t){return Mu(e).put(Ra(this.serializer,t))}},{key:"Qn",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.Bn(e).next(function(e){return e.targetCount})}},{key:"getTargetData",value:function(e,t){var n=er(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Mu(e).J({range:r,index:"queryTargetsIndex"},function(e,n,r){var a=Pa(n);tr(t,a.target)&&(i=a,r.done())}).next(function(){return i})}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,i=[],a=Lu(e);return t.forEach(function(t){var u=rt(t.path);i.push(a.put({targetId:n,path:u})),i.push(r.referenceDelegate.addReference(e,n,t))}),Ue.waitFor(i)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,i=Lu(e);return Ue.forEach(t,function(t){var a=rt(t.path);return Ue.waitFor([i.delete([n,a]),r.referenceDelegate.removeReference(e,n,t)])})}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=Lu(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Lu(e),i=Pr();return r.J({range:n,H:!0},function(e,t,n){var r=ut(e[1]),a=new _e(r);i=i.add(a)}).next(function(){return i})}},{key:"containsKey",value:function(e,t){var n=rt(t.path),r=IDBKeyRange.bound([n],[me(n)],!1,!0),i=0;return Lu(e).J({index:"documentTargetsIndex",H:!0,range:r},function(e,t,n){var r=f(e,2),a=r[0];r[1];0!==a&&(i++,n.done())}).next(function(){return i>0})}},{key:"ot",value:function(e,t){return Mu(e).get(t).next(function(e){return e?Pa(e):null})}}])}();function Mu(e){return Mt(e,"targets")}function Fu(e){return Mt(e,"targetGlobal")}function Lu(e){return Mt(e,"targetDocuments")}function Pu(e,t){var n=f(e,2),r=n[0],i=n[1],a=f(t,2),u=a[0],o=a[1],s=pe(r,u);return 0===s?pe(i,o):s}var Ru=function(){return V(function e(t){R(this,e),this.Kn=t,this.buffer=new Ut(Pu),this.$n=0},[{key:"Un",value:function(){return++this.$n}},{key:"Wn",value:function(e){var t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();Pu(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}])}(),Ou=function(){return V(function e(t,n,r){R(this,e),this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Gn=null},[{key:"start",value:function(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.zn(6e4)}},{key:"stop",value:function(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}},{key:"started",get:function(){return null!==this.Gn}},{key:"zn",value:function(e){var t=this;W("LruGarbageCollector","Garbage collection scheduled in ".concat(e,"ms")),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,x(k().mark(function e(){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.Gn=null,e.prev=1,e.next=4,t.localStore.collectGarbage(t.garbageCollector);case 4:e.next=14;break;case 6:if(e.prev=6,e.t0=e.catch(1),!je(e.t0)){e.next=12;break}W("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e.t0),e.next=14;break;case 12:return e.next=14,Ve(e.t0);case 14:return e.next=16,t.zn(3e5);case 16:case"end":return e.stop()}},e,null,[[1,6]])})))}}])}(),Vu=function(){return V(function e(t,n){R(this,e),this.jn=t,this.params=n},[{key:"calculateTargetCount",value:function(e,t){return this.jn.Hn(e).next(function(e){return Math.floor(t/100*e)})}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return Ue.resolve($e.oe);var r=new Ru(t);return this.jn.forEachTarget(e,function(e){return r.Wn(e.sequenceNumber)}).next(function(){return n.jn.Jn(e,function(e){return r.Wn(e)})}).next(function(){return r.maxValue})}},{key:"removeTargets",value:function(e,t,n){return this.jn.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.jn.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector","Garbage collection skipped; disabled"),Ue.resolve(xu)):this.getCacheSize(e).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),xu):n.Yn(e,t)})}},{key:"getCacheSize",value:function(e){return this.jn.getCacheSize(e)}},{key:"Yn",value:function(e,t){var n,r,i,u,o,s,c,l=this,f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(function(t){return t>l.params.maximumSequenceNumbersToCollect?(W("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(l.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=l.params.maximumSequenceNumbersToCollect):r=t,u=Date.now(),l.nthSequenceNumber(e,r)}).next(function(r){return n=r,o=Date.now(),l.removeTargets(e,n,t)}).next(function(t){return i=t,s=Date.now(),l.removeOrphanedDocuments(e,n)}).next(function(e){return c=Date.now(),Q()<=a.LogLevel.DEBUG&&W("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(u-f,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-u)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(s-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(c-s)+"ms\n"+"Total Duration: ".concat(c-f,"ms")),Ue.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})})}}])}();function qu(e,t){return new Vu(e,t)}var Uu=function(){return V(function e(t,n){R(this,e),this.db=t,this.garbageCollector=qu(this,n)},[{key:"Hn",value:function(e){var t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(function(e){return t.next(function(t){return e+t})})}},{key:"Zn",value:function(e){var t=0;return this.Jn(e,function(e){t++}).next(function(){return t})}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"Jn",value:function(e,t){return this.Xn(e,function(e,n){return t(n)})}},{key:"addReference",value:function(e,t,n){return Bu(e,n)}},{key:"removeReference",value:function(e,t,n){return Bu(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return Bu(e,t)}},{key:"er",value:function(e,t){return function(e,t){var n=!1;return Du(e).Y(function(r){return Tu(e,r,t).next(function(e){return e&&(n=!0),Ue.resolve(!e)})}).next(function(){return n})}(e,t)}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],a=0;return this.Xn(e,function(u,o){if(o<=t){var s=n.er(e,u).next(function(t){if(!t)return a++,r.getEntry(e,u).next(function(){return r.removeEntry(u,ke.min()),Lu(e).delete(function(e){return[0,rt(e.path)]}(u))})});i.push(s)}}).next(function(){return Ue.waitFor(i)}).next(function(){return r.apply(e)}).next(function(){return a})}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return Bu(e,t)}},{key:"Xn",value:function(e,t){var n,r=Lu(e),i=$e.oe;return r.J({index:"documentTargetsIndex"},function(e,r){var a=f(e,2),u=a[0],o=(a[1],r.path),s=r.sequenceNumber;0===u?(i!==$e.oe&&t(new _e(ut(n)),i),i=s,n=o):i=$e.oe}).next(function(){i!==$e.oe&&t(new _e(ut(n)),i)})}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}])}();function Bu(e,t){return Lu(e).put(function(e,t){return{targetId:0,path:rt(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}var zu=function(){return V(function e(){R(this,e),this.changes=new _r(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1},[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,Sn.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Ue.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}])}(),Gu=function(){return V(function e(t){R(this,e),this.serializer=t},[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t,n){return Wu(e).put(n)}},{key:"removeEntry",value:function(e,t,n){return Wu(e).delete(function(e,t){var n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Na(t),n[n.length-1]]}(t,n))}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next(function(r){return r.byteSize+=t,n.tr(e,r)})}},{key:"getEntry",value:function(e,t){var n=this,r=Sn.newInvalidDocument(t);return Wu(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Hu(t))},function(e,i){r=n.nr(t,i)}).next(function(){return r})}},{key:"rr",value:function(e,t){var n=this,r={size:0,document:Sn.newInvalidDocument(t)};return Wu(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Hu(t))},function(e,i){r={document:n.nr(t,i),size:_u(i)}}).next(function(){return r})}},{key:"getEntries",value:function(e,t){var n=this,r=Tr();return this.ir(e,t,function(e,t){var i=n.nr(e,t);r=r.insert(e,i)}).next(function(){return r})}},{key:"sr",value:function(e,t){var n=this,r=Tr(),i=new Ot(_e.comparator);return this.ir(e,t,function(e,t){var a=n.nr(e,t);r=r.insert(e,a),i=i.insert(e,_u(t))}).next(function(){return{documents:r,_r:i}})}},{key:"ir",value:function(e,t,n){if(t.isEmpty())return Ue.resolve();var r=new Ut(Yu);t.forEach(function(e){return r=r.add(e)});var i=IDBKeyRange.bound(Hu(r.first()),Hu(r.last())),a=r.getIterator(),u=a.getNext();return Wu(e).J({index:"documentKeyIndex",range:i},function(e,t,r){for(var i=_e.fromSegments([].concat(D(t.prefixPath),[t.collectionGroup,t.documentId]));u&&Yu(u,i)<0;)n(u,null),u=a.getNext();u&&u.isEqual(i)&&(n(u,t),u=a.hasNext()?a.getNext():null),u?r.$(Hu(u)):r.done()}).next(function(){for(;u;)n(u,null),u=a.hasNext()?a.getNext():null})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r,i){var a=this,u=t.path,o=[u.popLast().toArray(),u.lastSegment(),Na(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],s=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Wu(e).U(IDBKeyRange.bound(o,s,!0)).next(function(e){null==i||i.incrementDocumentReadCount(e.length);var n,u=Tr(),o=g(e);try{for(o.s();!(n=o.n()).done;){var s=n.value,c=a.nr(_e.fromSegments(s.prefixPath.concat(s.collectionGroup,s.documentId)),s);c.isFoundDocument()&&(wr(t,c)||r.has(c.key))&&(u=u.insert(c.key,c))}}catch(l){o.e(l)}finally{o.f()}return u})}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){var i=this,a=Tr(),u=Ju(t,n),o=Ju(t,Le.max());return Wu(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(u,o,!0)},function(e,t,n){var u=i.nr(_e.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(a=a.insert(u.key,u)).size===r&&n.done()}).next(function(){return a})}},{key:"newChangeBuffer",value:function(e){return new Qu(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next(function(e){return e.byteSize})}},{key:"getMetadata",value:function(e){return ju(e).get("remoteDocumentGlobalKey").next(function(e){return Z(!!e),e})}},{key:"tr",value:function(e,t){return ju(e).put("remoteDocumentGlobalKey",t)}},{key:"nr",value:function(e,t){if(t){var n=Da(this.serializer,t);if(!n.isNoDocument()||!n.version.isEqual(ke.min()))return n}return Sn.newInvalidDocument(e)}}])}();function Ku(e){return new Gu(e)}var Qu=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t)).ar=e,r.trackRemovals=n,r.ur=new _r(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),r}return S(t,zu),V(t,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,i=new Ut(function(e,t){return pe(e.canonicalString(),t.canonicalString())});return this.changes.forEach(function(a,u){var o=t.ur.get(a);if(n.push(t.ar.removeEntry(e,a,o.readTime)),u.isValidDocument()){var s=Aa(t.ar.serializer,u);i=i.add(a.path.popLast());var c=_u(s);r+=c-o.size,n.push(t.ar.addEntry(e,a,s))}else if(r-=o.size,t.trackRemovals){var l=Aa(t.ar.serializer,u.convertToNoDocument(ke.min()));n.push(t.ar.addEntry(e,a,l))}}),i.forEach(function(r){n.push(t.ar.indexManager.addToCollectionParentIndex(e,r))}),n.push(this.ar.updateMetadata(e,r)),Ue.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.ar.rr(e,t).next(function(e){return n.ur.set(t,{size:e.size,readTime:e.document.readTime}),e.document})}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.ar.sr(e,t).next(function(e){var t=e.documents;return e._r.forEach(function(e,r){n.ur.set(e,{size:r,readTime:t.get(e).readTime})}),t})}}])}();function ju(e){return Mt(e,"remoteDocumentGlobal")}function Wu(e){return Mt(e,"remoteDocumentsV14")}function Hu(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Ju(e,t){var n=t.documentKey.path.toArray();return[e,Na(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Yu(e,t){for(var n=e.path.toArray(),r=t.path.toArray(),i=0,a=0;a<n.length-2&&a<r.length-2;++a)if(i=pe(n[a],r[a]))return i;return(i=pe(n.length,r.length))||((i=pe(n[n.length-2],r[r.length-2]))||pe(n[n.length-1],r[r.length-1]))}var Xu=V(function e(t,n){R(this,e),this.overlayedDocument=t,this.mutatedFields=n}),Zu=function(){return V(function e(t,n,r,i){R(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i},[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next(function(i){return r=i,n.remoteDocumentCache.getEntry(e,t)}).next(function(e){return null!==r&&oi(r.mutation,e,Gt.empty(),ge.now()),e})}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.getLocalViewOfDocuments(e,t,Pr()).next(function(){return t})})}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pr(),i=Ar();return this.populateOverlays(e,i,t).next(function(){return n.computeViews(e,t,i,r).next(function(e){var t=Cr();return e.forEach(function(e,n){t=t.insert(e,n.overlayedDocument)}),t})})}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=Ar();return this.populateOverlays(e,r,t).next(function(){return n.computeViews(e,t,r,Pr())})}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach(function(e){t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(function(e){e.forEach(function(e,n){t.set(e,n)})})}},{key:"computeViews",value:function(e,t,n,r){var i=Tr(),a=Mr(),u=Mr();return t.forEach(function(e,t){var u=n.get(t.key);r.has(t.key)&&(void 0===u||u.mutation instanceof fi)?i=i.insert(t.key,t):void 0!==u?(a.set(t.key,u.mutation.getFieldMask()),oi(u.mutation,t,u.mutation.getFieldMask(),ge.now())):a.set(t.key,Gt.empty())}),this.recalculateAndSaveOverlays(e,i).next(function(e){return e.forEach(function(e,t){return a.set(e,t)}),t.forEach(function(e,t){var n;return u.set(e,new Xu(t,null!==(n=a.get(e))&&void 0!==n?n:null))}),u})}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=Mr(),i=new Ot(function(e,t){return e-t}),a=Pr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){var n,a=g(e);try{var u=function(){var e=n.value;e.keys().forEach(function(n){var a=t.get(n);if(null!==a){var u=r.get(n)||Gt.empty();u=e.applyToLocalView(a,u),r.set(n,u);var o=(i.get(e.batchId)||Pr()).add(n);i=i.insert(e.batchId,o)}})};for(a.s();!(n=a.n()).done;)u()}catch(o){a.e(o)}finally{a.f()}}).next(function(){for(var u=[],o=i.getReverseIterator(),s=function(){var i=o.getNext(),s=i.key,c=i.value,l=Nr();c.forEach(function(e){if(!a.has(e)){var n=ai(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}}),u.push(n.documentOverlayCache.saveOverlays(e,s,l))};o.hasNext();)s();return Ue.waitFor(u)}).next(function(){return r})}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.recalculateAndSaveOverlays(e,t)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){return function(e){return _e.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lr(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(function(a){var u=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Ue.resolve(Ar()),o=-1,s=a;return u.next(function(t){return Ue.forEach(t,function(t,n){return o<n.largestBatchId&&(o=n.largestBatchId),a.get(t)?Ue.resolve():i.remoteDocumentCache.getEntry(e,t).next(function(e){s=s.insert(t,e)})}).next(function(){return i.populateOverlays(e,t,a)}).next(function(){return i.computeViews(e,s,t,Pr())}).next(function(e){return{batchId:o,changes:Dr(e)}})})})}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new _e(t)).next(function(e){var t=Cr();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n,r){var i=this,a=t.collectionGroup,u=Cr();return this.indexManager.getCollectionParents(e,a).next(function(o){return Ue.forEach(o,function(o){var s=function(e,t){return new ur(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(a));return i.getDocumentsMatchingCollectionQuery(e,s,n,r).next(function(e){e.forEach(function(e,t){u=u.insert(e,t)})})}).next(function(){return u})})}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n,r){var i,a=this;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(function(u){return i=u,a.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)}).next(function(e){i.forEach(function(t,n){var r=n.getKey();null===e.get(r)&&(e=e.insert(r,Sn.newInvalidDocument(r)))});var n=Cr();return e.forEach(function(e,r){var a=i.get(e);void 0!==a&&oi(a.mutation,r,Gt.empty(),ge.now()),wr(t,r)&&(n=n.insert(e,r))}),n})}}])}(),$u=function(){return V(function e(t){R(this,e),this.serializer=t,this.cr=new Map,this.lr=new Map},[{key:"getBundleMetadata",value:function(e,t){return Ue.resolve(this.cr.get(t))}},{key:"saveBundleMetadata",value:function(e,t){return this.cr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Yi(e.createTime)}}(t)),Ue.resolve()}},{key:"getNamedQuery",value:function(e,t){return Ue.resolve(this.lr.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.lr.set(t.name,function(e){return{name:e.name,query:Oa(e.bundledQuery),readTime:Yi(e.readTime)}}(t)),Ue.resolve()}}])}(),eo=function(){return V(function e(){R(this,e),this.overlays=new Ot(_e.comparator),this.hr=new Map},[{key:"getOverlay",value:function(e,t){return Ue.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=Ar();return Ue.forEach(t,function(t){return n.getOverlay(e,t).next(function(e){null!==e&&r.set(t,e)})}).next(function(){return r})}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach(function(n,i){r.ht(e,t,i)}),Ue.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.hr.get(n);return void 0!==i&&(i.forEach(function(e){return r.overlays=r.overlays.remove(e)}),this.hr.delete(n)),Ue.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=Ar(),i=t.length+1,a=new _e(t.child("")),u=this.overlays.getIteratorFrom(a);u.hasNext();){var o=u.getNext().value,s=o.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&o.largestBatchId>n&&r.set(o.getKey(),o)}return Ue.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new Ot(function(e,t){return e-t}),a=this.overlays.getIterator();a.hasNext();){var u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>n){var o=i.get(u.largestBatchId);null===o&&(o=Ar(),i=i.insert(u.largestBatchId,o)),o.set(u.getKey(),u)}}for(var s=Ar(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach(function(e,t){return s.set(e,t)}),!(s.size()>=r)););return Ue.resolve(s)}},{key:"ht",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new xi(t,n));var a=this.hr.get(t);void 0===a&&(a=Pr(),this.hr.set(t,a)),this.hr.set(t,a.add(n.key))}}])}(),to=function(){return V(function e(){R(this,e),this.Pr=new Ut(no.Ir),this.Tr=new Ut(no.Er)},[{key:"isEmpty",value:function(){return this.Pr.isEmpty()}},{key:"addReference",value:function(e,t){var n=new no(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}},{key:"dr",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.Ar(new no(e,t))}},{key:"Rr",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"Vr",value:function(e){var t=this,n=new _e(new xe([])),r=new no(n,e),i=new no(n,e+1),a=[];return this.Tr.forEachInRange([r,i],function(e){t.Ar(e),a.push(e.key)}),a}},{key:"mr",value:function(){var e=this;this.Pr.forEach(function(t){return e.Ar(t)})}},{key:"Ar",value:function(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}},{key:"gr",value:function(e){var t=new _e(new xe([])),n=new no(t,e),r=new no(t,e+1),i=Pr();return this.Tr.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new no(e,0),n=this.Pr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}])}(),no=function(){return V(function e(t,n){R(this,e),this.key=t,this.pr=n},null,[{key:"Ir",value:function(e,t){return _e.comparator(e.key,t.key)||pe(e.pr,t.pr)}},{key:"Er",value:function(e,t){return pe(e.pr,t.pr)||_e.comparator(e.key,t.key)}}])}(),ro=function(){return V(function e(t,n){R(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Ut(no.Ir)},[{key:"checkEmpty",value:function(e){return Ue.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var a=new ki(i,t,n,r);this.mutationQueue.push(a);var u,o=g(r);try{for(o.s();!(u=o.n()).done;){var s=u.value;this.wr=this.wr.add(new no(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast())}}catch(c){o.e(c)}finally{o.f()}return Ue.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return Ue.resolve(this.Sr(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.br(n),i=r<0?0:r;return Ue.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Ue.resolve(0===this.mutationQueue.length?-1:this.yr-1)}},{key:"getAllMutationBatches",value:function(e){return Ue.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new no(t,0),i=new no(t,Number.POSITIVE_INFINITY),a=[];return this.wr.forEachInRange([r,i],function(e){var t=n.Sr(e.pr);a.push(t)}),Ue.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Ut(pe);return t.forEach(function(e){var t=new no(e,0),i=new no(e,Number.POSITIVE_INFINITY);n.wr.forEachInRange([t,i],function(e){r=r.add(e.pr)})}),Ue.resolve(this.Dr(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;_e.isDocumentKey(i)||(i=i.child(""));var a=new no(new _e(i),0),u=new Ut(pe);return this.wr.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(u=u.add(e.pr)),!0)},a),Ue.resolve(this.Dr(u))}},{key:"Dr",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t.Sr(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Z(0===this.Cr(t.batchId,"removed")),this.mutationQueue.shift();var r=this.wr;return Ue.forEach(t.mutations,function(i){var a=new no(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.wr=r})}},{key:"Mn",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new no(t,0),r=this.wr.firstAfterOrEqual(n);return Ue.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,Ue.resolve()}},{key:"Cr",value:function(e,t){return this.br(e)}},{key:"br",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"Sr",value:function(e){var t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}])}(),io=function(){return V(function e(t){R(this,e),this.vr=t,this.docs=new Ot(_e.comparator),this.size=0},[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Ue.resolve(n?n.document.mutableCopy():Sn.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=Tr();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():Sn.newInvalidDocument(e))}),Ue.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){for(var i=Tr(),a=t.path,u=new _e(a.child("")),o=this.docs.getIteratorFrom(u);o.hasNext();){var s=o.getNext(),c=s.key,l=s.value.document;if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Pe(Fe(l),n)<=0||(r.has(l.key)||wr(t,l))&&(i=i.insert(l.key,l.mutableCopy()))}return Ue.resolve(i)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){X()}},{key:"Fr",value:function(e,t){return Ue.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new ao(this)}},{key:"getSize",value:function(e){return Ue.resolve(this.size)}}])}(),ao=function(e){function t(e){var n;return R(this,t),(n=b(this,t)).ar=e,n}return S(t,zu),V(t,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.isValidDocument()?n.push(t.ar.addEntry(e,i)):t.ar.removeEntry(r)}),Ue.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.ar.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.ar.getEntries(e,t)}}])}(),uo=function(){return V(function e(t){R(this,e),this.persistence=t,this.Mr=new _r(function(e){return er(e)},tr),this.lastRemoteSnapshotVersion=ke.min(),this.highestTargetId=0,this.Or=0,this.Nr=new to,this.targetCount=0,this.Lr=Au.Nn()},[{key:"forEachTarget",value:function(e,t){return this.Mr.forEach(function(e,n){return t(n)}),Ue.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Ue.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Ue.resolve(this.Or)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Lr.next(),Ue.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),Ue.resolve()}},{key:"qn",value:function(e){this.Mr.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Lr=new Au(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.qn(t),this.targetCount+=1,Ue.resolve()}},{key:"updateTargetData",value:function(e,t){return this.qn(t),Ue.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,Ue.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Mr.forEach(function(u,o){o.sequenceNumber<=t&&null===n.get(o.targetId)&&(r.Mr.delete(u),a.push(r.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Ue.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return Ue.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Mr.get(t)||null;return Ue.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Nr.dr(t,n),Ue.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Nr.Rr(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),Ue.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Nr.Vr(t),Ue.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Nr.gr(t);return Ue.resolve(n)}},{key:"containsKey",value:function(e,t){return Ue.resolve(this.Nr.containsKey(t))}}])}(),oo=function(){return V(function e(t,n){var r=this;R(this,e),this.Br={},this.overlays={},this.kr=new $e(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new uo(this),this.indexManager=new hu,this.remoteDocumentCache=function(e){return new io(e)}(function(e){return r.referenceDelegate.Kr(e)}),this.serializer=new Ca(n),this.$r=new $u(this.serializer)},[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.qr=!1,Promise.resolve()}},{key:"started",get:function(){return this.qr}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new eo,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.Br[e.toKey()];return n||(n=new ro(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Qr}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.$r}},{key:"runTransaction",value:function(e,t,n){var r=this;W("MemoryPersistence","Starting transaction:",e);var i=new so(this.kr.next());return this.referenceDelegate.Ur(),n(i).next(function(e){return r.referenceDelegate.Wr(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Gr",value:function(e,t){return Ue.or(Object.values(this.Br).map(function(n){return function(){return n.containsKey(e,t)}}))}}])}(),so=function(e){function t(e){var n;return R(this,t),(n=b(this,t)).currentSequenceNumber=e,n}return S(t,Oe),V(t)}(),co=function(){function e(t){R(this,e),this.persistence=t,this.zr=new to,this.jr=null}return V(e,[{key:"Jr",get:function(){if(this.jr)return this.jr;throw X()}},{key:"addReference",value:function(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),Ue.resolve()}},{key:"removeReference",value:function(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),Ue.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Jr.add(t.toString()),Ue.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.zr.Vr(t.targetId).forEach(function(e){return n.Jr.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.Jr.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Ur",value:function(){this.jr=new Set}},{key:"Wr",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ue.forEach(this.Jr,function(r){var i=_e.fromPath(r);return t.Yr(e,i).next(function(e){e||n.removeEntry(i,ke.min())})}).next(function(){return t.jr=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.Yr(e,t).next(function(e){e?n.Jr.delete(t.toString()):n.Jr.add(t.toString())})}},{key:"Kr",value:function(e){return 0}},{key:"Yr",value:function(e,t){var n=this;return Ue.or([function(){return Ue.resolve(n.zr.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Gr(e,t)}])}}],[{key:"Hr",value:function(t){return new e(t)}}])}(),lo=function(){function e(t,n){R(this,e),this.persistence=t,this.Zr=new _r(function(e){return rt(e.path)},function(e,t){return e.isEqual(t)}),this.garbageCollector=qu(this,n)}return V(e,[{key:"Ur",value:function(){}},{key:"Wr",value:function(e){return Ue.resolve()}},{key:"forEachTarget",value:function(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}},{key:"Hn",value:function(e){var t=this.Zn(e);return this.persistence.getTargetCache().getTargetCount(e).next(function(e){return t.next(function(t){return e+t})})}},{key:"Zn",value:function(e){var t=0;return this.Jn(e,function(e){t++}).next(function(){return t})}},{key:"Jn",value:function(e,t){var n=this;return Ue.forEach(this.Zr,function(r,i){return n.er(e,r,i).next(function(e){return e?Ue.resolve():t(i)})})}},{key:"removeTargets",value:function(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=0,i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.Fr(e,function(i){return n.er(e,i,t).next(function(e){e||(r++,a.removeEntry(i,ke.min()))})}).next(function(){return a.apply(e)}).next(function(){return r})}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Zr.set(t,e.currentSequenceNumber),Ue.resolve()}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}},{key:"addReference",value:function(e,t,n){return this.Zr.set(n,e.currentSequenceNumber),Ue.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Zr.set(n,e.currentSequenceNumber),Ue.resolve()}},{key:"updateLimboDocument",value:function(e,t){return this.Zr.set(t,e.currentSequenceNumber),Ue.resolve()}},{key:"Kr",value:function(e){var t=e.key.toString().length;return e.isFoundDocument()&&(t+=hn(e.data.value)),t}},{key:"er",value:function(e,t,n){var r=this;return Ue.or([function(){return r.persistence.Gr(e,t)},function(){return r.persistence.getTargetCache().containsKey(e,t)},function(){var e=r.Zr.get(t);return Ue.resolve(void 0!==e&&e>n)}])}},{key:"getCacheSize",value:function(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}],[{key:"Hr",value:function(t,n){return new e(t,n)}}])}(),fo=function(){return V(function e(t){R(this,e),this.serializer=t},[{key:"O",value:function(e,t,n,r){var i=this,a=new Be("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ot,{unique:!0}),e.createObjectStore("documentMutations")}(e),ho(e),function(e){e.createObjectStore("remoteDocuments")}(e));var u=Ue.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),ho(e)),u=u.next(function(){return e=a.store("targetGlobal"),t={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ke.min().toTimestamp(),targetCount:0},e.put("targetGlobalKey",t);var e,t})),n<4&&r>=4&&(0!==n&&(u=u.next(function(){return function(e,t){return t.store("mutations").U().next(function(n){e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ot,{unique:!0});var r=t.store("mutations"),i=n.map(function(e){return r.put(e)});return Ue.waitFor(i)})}(e,a)})),u=u.next(function(){!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(u=u.next(function(){return i.Xr(a)})),n<6&&r>=6&&(u=u.next(function(){return function(e){e.createObjectStore("remoteDocumentGlobal")}(e),i.ei(a)})),n<7&&r>=7&&(u=u.next(function(){return i.ti(a)})),n<8&&r>=8&&(u=u.next(function(){return i.ni(e,a)})),n<9&&r>=9&&(u=u.next(function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&r>=10&&(u=u.next(function(){return i.ri(a)})),n<11&&r>=11&&(u=u.next(function(){!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&r>=12&&(u=u.next(function(){!function(e){var t=e.createObjectStore("documentOverlays",{keyPath:bt});t.createIndex("collectionPathOverlayIndex",It,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",_t,{unique:!1})}(e)})),n<13&&r>=13&&(u=u.next(function(){return function(e){var t=e.createObjectStore("remoteDocumentsV14",{keyPath:ft});t.createIndex("documentKeyIndex",ht),t.createIndex("collectionGroupIndex",dt)}(e)}).next(function(){return i.ii(e,a)}).next(function(){return e.deleteObjectStore("remoteDocuments")})),n<14&&r>=14&&(u=u.next(function(){return i.si(e,a)})),n<15&&r>=15&&(u=u.next(function(){return function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:gt}).createIndex("sequenceNumberIndex",kt,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:wt}).createIndex("documentKeyIndex",xt,{unique:!1})}(e)})),n<16&&r>=16&&(u=u.next(function(){t.objectStore("indexState").clear()}).next(function(){t.objectStore("indexEntries").clear()})),u}},{key:"ei",value:function(e){var t=0;return e.store("remoteDocuments").J(function(e,n){t+=_u(n)}).next(function(){var n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}},{key:"Xr",value:function(e){var t=this,n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(function(n){return Ue.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",i).next(function(r){return Ue.forEach(r,function(r){Z(r.userId===n.userId);var i=La(t.serializer,r);return Iu(e,n.userId,i).next(function(){})})})})})}},{key:"ti",value:function(e){var t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(function(e){var r=[];return n.J(function(n,i){var a=new xe(n),u=function(e){return[0,rt(e)]}(a);r.push(t.get(u).next(function(n){return n?Ue.resolve():function(n){return t.put({targetId:0,path:rt(n),sequenceNumber:e.highestListenSequenceNumber})}(a)}))}).next(function(){return Ue.waitFor(r)})})}},{key:"ni",value:function(e,t){e.createObjectStore("collectionParents",{keyPath:mt});var n=t.store("collectionParents"),r=new du,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:rt(i)})}};return t.store("remoteDocuments").J({H:!0},function(e,t){var n=new xe(e);return i(n.popLast())}).next(function(){return t.store("documentMutations").J({H:!0},function(e,t){var n=f(e,3),r=(n[0],n[1]),a=(n[2],ut(r));return i(a.popLast())})})}},{key:"ri",value:function(e){var t=this,n=e.store("targets");return n.J(function(e,r){var i=Pa(r),a=Ra(t.serializer,i);return n.put(a)})}},{key:"ii",value:function(e,t){var n=t.store("remoteDocuments"),r=[];return n.J(function(e,n){var i=t.store("remoteDocumentsV14"),a=function(e){return e.document?new _e(xe.fromString(e.document.name).popFirst(5)):e.noDocument?_e.fromSegments(e.noDocument.path):e.unknownDocument?_e.fromSegments(e.unknownDocument.path):X()}(n).path.toArray(),u={prefixPath:a.slice(0,a.length-2),collectionGroup:a[a.length-2],documentId:a[a.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(u))}).next(function(){return Ue.waitFor(r)})}},{key:"si",value:function(e,t){var n=this,r=t.store("mutations"),i=Ku(this.serializer),a=new oo(co.Hr,this.serializer.ct);return r.U().next(function(e){var r=new Map;return e.forEach(function(e){var t,i=null!==(t=r.get(e.userId))&&void 0!==t?t:Pr();La(n.serializer,e).keys().forEach(function(e){return i=i.add(e)}),r.set(e.userId,i)}),Ue.forEach(r,function(e,r){var u=new z(r),o=Ka.lt(n.serializer,u),s=a.getIndexManager(u),c=Eu.lt(u,n.serializer,s,a.referenceDelegate);return new Zu(i,c,o,s).recalculateAndSaveOverlaysForDocumentKeys(new Nt(t,$e.oe),e).next()})})}}])}();function ho(e){e.createObjectStore("targetDocuments",{keyPath:pt}).createIndex("documentTargetsIndex",yt,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",vt,{unique:!0}),e.createObjectStore("targetGlobal")}var vo="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",po=function(){return V(function e(t,n,r,i,a,u,o,s,c,l){var f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:16;if(R(this,e),this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.oi=a,this.window=u,this.document=o,this._i=c,this.ai=l,this.ui=f,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=function(e){return Promise.resolve()},!e.D())throw new ne(te.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Uu(this,i),this.Ti=n+"main",this.serializer=new Ca(s),this.Ei=new ze(this.Ti,this.ui,new fo(this.serializer)),this.Qr=new Nu(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Ku(this.serializer),this.$r=new Ba,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,!1===l&&H("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))},[{key:"start",value:function(){var e=this;return this.Ai().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new ne(te.FAILED_PRECONDITION,vo);return e.Ri(),e.Vi(),e.mi(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Qr.getHighestSequenceNumber(t)})}).then(function(t){e.kr=new $e(t,e._i)}).then(function(){e.qr=!0}).catch(function(t){return e.Ei&&e.Ei.close(),Promise.reject(t)})}},{key:"fi",value:function(e){var t=this;return this.Ii=function(){var n=x(k().mark(function n(r){return k().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.started){n.next=2;break}return n.abrupt("return",e(r));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),e(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(e){this.Ei.L(function(){var t=x(k().mark(function t(n){return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===n.newVersion,!t.t0){t.next=4;break}return t.next=4,e();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}},{key:"setNetworkEnabled",value:function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(x(k().mark(function e(){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.started,!e.t0){e.next=4;break}return e.next=4,t.Ai();case 4:case"end":return e.stop()}},e)}))))}},{key:"Ai",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(t){return mo(t).put({clientId:e.clientId,updateTimeMs:Date.now(),networkEnabled:e.networkEnabled,inForeground:e.inForeground}).next(function(){if(e.isPrimary)return e.gi(t).next(function(t){t||(e.isPrimary=!1,e.oi.enqueueRetryable(function(){return e.Ii(!1)}))})}).next(function(){return e.pi(t)}).next(function(n){return e.isPrimary&&!n?e.yi(t).next(function(){return!1}):!!n&&e.wi(t).next(function(){return!0})})}).catch(function(t){if(je(t))return W("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return W("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){e.isPrimary!==t&&e.oi.enqueueRetryable(function(){return e.Ii(t)}),e.isPrimary=t})}},{key:"gi",value:function(e){var t=this;return yo(e).get("owner").next(function(e){return Ue.resolve(t.Si(e))})}},{key:"bi",value:function(e){return mo(e).delete(this.clientId)}},{key:"Di",value:function(){var e=x(k().mark(function e(){var t,n,r,i,a=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrimary||this.Ci(this.Pi,18e5)){e.next=6;break}return this.Pi=Date.now(),e.next=4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var t=Mt(e,"clientMetadata");return t.U().next(function(e){var n=a.vi(e,18e5),r=e.filter(function(e){return-1===n.indexOf(e)});return Ue.forEach(r,function(e){return t.delete(e.clientId)}).next(function(){return r})})}).catch(function(){return[]});case 4:if(t=e.sent,this.di){n=g(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this.di.removeItem(this.Fi(i.clientId))}catch(u){n.e(u)}finally{n.f()}}case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"mi",value:function(){var e=this;this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return e.Ai().then(function(){return e.Di()}).then(function(){return e.mi()})})}},{key:"Si",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"pi",value:function(e){var t=this;return this.ai?Ue.resolve(!0):yo(e).get("owner").next(function(n){if(null!==n&&t.Ci(n.leaseTimestampMs,5e3)&&!t.Mi(n.ownerId)){if(t.Si(n)&&t.networkEnabled)return!0;if(!t.Si(n)){if(!n.allowTabSynchronization)throw new ne(te.FAILED_PRECONDITION,vo);return!1}}return!(!t.networkEnabled||!t.inForeground)||mo(e).U().next(function(e){return void 0===t.vi(e,5e3).find(function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(e){return t.isPrimary!==e&&W("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e})}},{key:"shutdown",value:function(){var e=x(k().mark(function e(){var t=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),e.next=7,this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],function(e){var n=new Nt(e,$e.oe);return t.yi(n).next(function(){return t.bi(n)})});case 7:this.Ei.close(),this.Li();case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"vi",value:function(e,t){var n=this;return e.filter(function(e){return n.Ci(e.updateTimeMs,t)&&!n.Mi(e.clientId)})}},{key:"Bi",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return mo(t).U().next(function(t){return e.vi(t,18e5).map(function(e){return e.clientId})})})}},{key:"started",get:function(){return this.qr}},{key:"getMutationQueue",value:function(e,t){return Eu.lt(e,this.serializer,t,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.Qr}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getIndexManager",value:function(e){return new pu(e,this.serializer.ct.databaseId)}},{key:"getDocumentOverlayCache",value:function(e){return Ka.lt(this.serializer,e)}},{key:"getBundleCache",value:function(){return this.$r}},{key:"runTransaction",value:function(e,t,n){var r=this;W("IndexedDbPersistence","Starting transaction:",e);var i,a="readonly"===t?"readonly":"readwrite",u=function(e){return 16===e?At:15===e?Dt:14===e?Ct:13===e?St:12===e?Tt:11===e?Et:void X()}(this.ui);return this.Ei.runTransaction(e,a,u,function(a){return i=new Nt(a,r.kr?r.kr.next():$e.oe),"readwrite-primary"===t?r.gi(i).next(function(e){return!!e||r.pi(i)}).next(function(t){if(!t)throw H("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.oi.enqueueRetryable(function(){return r.Ii(!1)}),new ne(te.FAILED_PRECONDITION,Re);return n(i)}).next(function(e){return r.wi(i).next(function(){return e})}):r.ki(i).next(function(){return n(i)})}).then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"ki",value:function(e){var t=this;return yo(e).get("owner").next(function(e){if(null!==e&&t.Ci(e.leaseTimestampMs,5e3)&&!t.Mi(e.ownerId)&&!t.Si(e)&&!(t.ai||t.allowTabSynchronization&&e.allowTabSynchronization))throw new ne(te.FAILED_PRECONDITION,vo)})}},{key:"wi",value:function(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return yo(e).put("owner",t)}},{key:"yi",value:function(e){var t=this,n=yo(e);return n.get("owner").next(function(e){return t.Si(e)?(W("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):Ue.resolve()})}},{key:"Ci",value:function(e,t){var n=Date.now();return!(e<n-t||e>n&&(H("Detected an update time that is in the future: ".concat(e," > ").concat(n)),1))}},{key:"Ri",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.li=function(){e.oi.enqueueAndForget(function(){return e.inForeground="visible"===e.document.visibilityState,e.Ai()})},this.document.addEventListener("visibilitychange",this.li),this.inForeground="visible"===this.document.visibilityState)}},{key:"Oi",value:function(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}},{key:"Vi",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=function(){t.xi();var e=/(?:Version|Mobile)\/1[456]/;(0,u.isSafari)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&t.oi.enterRestrictedMode(!0),t.oi.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("pagehide",this.ci))}},{key:"Ni",value:function(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}},{key:"Mi",value:function(e){var t;try{var n=null!==(null===(t=this.di)||void 0===t?void 0:t.getItem(this.Fi(e)));return W("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return H("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"xi",value:function(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){H("Failed to set zombie client id.",e)}}},{key:"Li",value:function(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch(e){}}},{key:"Fi",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"D",value:function(){return ze.D()}}])}();function yo(e){return Mt(e,"owner")}function mo(e){return Mt(e,"clientMetadata")}function go(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var ko=function(){function e(t,n,r,i){R(this,e),this.targetId=t,this.fromCache=n,this.qi=r,this.Qi=i}return V(e,null,[{key:"Ki",value:function(t,n){var r,i=Pr(),a=Pr(),u=g(n.docChanges);try{for(u.s();!(r=u.n()).done;){var o=r.value;switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}}}catch(s){u.e(s)}finally{u.f()}return new e(t,n.fromCache,i,a)}}])}(),wo=function(){return V(function e(){R(this,e),this._documentReadCount=0},[{key:"documentReadCount",get:function(){return this._documentReadCount}},{key:"incrementDocumentReadCount",value:function(e){this._documentReadCount+=e}}])}(),xo=function(){return V(function e(){R(this,e),this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=(0,u.isSafari)()?8:Ge((0,u.getUA)())>0?6:4},[{key:"initialize",value:function(e,t){this.zi=e,this.indexManager=t,this.$i=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this,a={result:null};return this.ji(e,t).next(function(e){a.result=e}).next(function(){if(!a.result)return i.Hi(e,t,r,n).next(function(e){a.result=e})}).next(function(){if(!a.result){var n=new wo;return i.Ji(e,t,n).next(function(r){if(a.result=r,i.Ui)return i.Yi(e,t,n,r.size)})}}).next(function(){return a.result})}},{key:"Yi",value:function(e,t,n,r){return n.documentReadCount<this.Wi?(Q()<=a.LogLevel.DEBUG&&W("QueryEngine","SDK will not create cache indexes for query:",kr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),Ue.resolve()):(Q()<=a.LogLevel.DEBUG&&W("QueryEngine","Query:",kr(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(Q()<=a.LogLevel.DEBUG&&W("QueryEngine","The SDK decides to create cache indexes for query:",kr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,hr(t))):Ue.resolve())}},{key:"ji",value:function(e,t){var n=this;if(cr(t))return Ue.resolve(null);var r=hr(t);return this.indexManager.getIndexType(e,r).next(function(i){return 0===i?null:(null!==t.limit&&1===i&&(t=yr(t,null,"F"),r=hr(t)),n.indexManager.getDocumentsMatchingTarget(e,r).next(function(i){var a=Pr.apply(void 0,D(i));return n.zi.getDocuments(e,a).next(function(i){return n.indexManager.getMinOffset(e,r).next(function(r){var u=n.Zi(t,i);return n.Xi(t,u,a,r.readTime)?n.ji(e,yr(t,null,"F")):n.es(e,u,t,r)})})}))})}},{key:"Hi",value:function(e,t,n,r){var i=this;return cr(t)||r.isEqual(ke.min())?Ue.resolve(null):this.zi.getDocuments(e,n).next(function(u){var o=i.Zi(t,u);return i.Xi(t,o,n,r)?Ue.resolve(null):(Q()<=a.LogLevel.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),kr(t)),i.es(e,o,t,Me(r,-1)).next(function(e){return e}))})}},{key:"Zi",value:function(e,t){var n=new Ut(br(e));return t.forEach(function(t,r){wr(e,r)&&(n=n.add(r))}),n}},{key:"Xi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Ji",value:function(e,t,n){return Q()<=a.LogLevel.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",kr(t)),this.zi.getDocumentsMatchingQuery(e,t,Le.min(),n)}},{key:"es",value:function(e,t,n,r){return this.zi.getDocumentsMatchingQuery(e,n,r).next(function(e){return t.forEach(function(t){e=e.insert(t.key,t)}),e})}}])}(),bo=function(){return V(function e(t,n,r,i){R(this,e),this.persistence=t,this.ts=n,this.serializer=i,this.ns=new Ot(pe),this.rs=new _r(function(e){return er(e)},tr),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(r)},[{key:"_s",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Zu(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.ns)})}}])}();function Io(e,t,n,r){return new bo(e,t,n,r)}function _o(e,t){return Eo.apply(this,arguments)}function Eo(){return(Eo=x(k().mark(function e(t,n){var r;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ee(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next(function(i){return t=i,r._s(n),r.mutationQueue.getAllMutationBatches(e)}).next(function(n){var i,a=[],u=[],o=Pr(),s=g(t);try{for(s.s();!(i=s.n()).done;){var c=i.value;a.push(c.batchId);var l,f=g(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;o=o.add(h.key)}}catch(w){f.e(w)}finally{f.f()}}}catch(w){s.e(w)}finally{s.f()}var d,v=g(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;u.push(p.batchId);var y,m=g(p.mutations);try{for(m.s();!(y=m.n()).done;){var k=y.value;o=o.add(k.key)}}catch(w){m.e(w)}finally{m.f()}}}catch(w){v.e(w)}finally{v.f()}return r.localDocuments.getDocuments(e,o).next(function(e){return{us:e,removedBatchIds:a,addedBatchIds:u}})})});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function To(e,t){var n=ee(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r=t.batch.keys(),i=n.os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,a=i.keys(),u=Ue.resolve();return a.forEach(function(e){u=u.next(function(){return r.getEntry(t,e)}).next(function(t){var a=n.docVersions.get(e);Z(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),u.next(function(){return e.mutationQueue.removeMutationBatch(t,i)})}(n,e,t,i).next(function(){return i.apply(e)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=Pr(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))}).next(function(){return n.localDocuments.getDocuments(e,r)})})}function So(e){var t=ee(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.Qr.getLastRemoteSnapshotVersion(e)})}function Co(e,t){var n=ee(e),r=t.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;var u=[];t.targetChanges.forEach(function(a,o){var s=i.get(o);if(s){u.push(n.Qr.removeMatchingKeys(e,a.removedDocuments,o).next(function(){return n.Qr.addMatchingKeys(e,a.addedDocuments,o)}));var c=s.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(jt.EMPTY_BYTE_STRING,ke.min()).withLastLimboFreeSnapshotVersion(ke.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),i=i.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(s,c,a)&&u.push(n.Qr.updateTargetData(e,c))}});var o=Tr(),s=Pr();if(t.documentUpdates.forEach(function(r){t.resolvedLimboDocuments.has(r)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),u.push(Do(e,a,t.documentUpdates).next(function(e){o=e.cs,s=e.ls})),!r.isEqual(ke.min())){var c=n.Qr.getLastRemoteSnapshotVersion(e).next(function(t){return n.Qr.setTargetsMetadata(e,e.currentSequenceNumber,r)});u.push(c)}return Ue.waitFor(u).next(function(){return a.apply(e)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(e,o,s)}).next(function(){return o})}).then(function(e){return n.ns=i,e})}function Do(e,t,n){var r=Pr(),i=Pr();return n.forEach(function(e){return r=r.add(e)}),t.getEntries(e,r).next(function(e){var r=Tr();return n.forEach(function(n,a){var u=e.get(n);a.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(ke.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!u.isValidDocument()||a.version.compareTo(u.version)>0||0===a.version.compareTo(u.version)&&u.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):W("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",a.version)}),{cs:r,ls:i}})}function Ao(e,t){var n=ee(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)})}function No(e,t){var n=ee(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.Qr.getTargetData(e,t).next(function(i){return i?(r=i,Ue.resolve(r)):n.Qr.allocateTargetId(e).next(function(i){return r=new Sa(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Qr.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.ns.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ns=n.ns.insert(e.targetId,e),n.rs.set(t,e.targetId)),e})}function Mo(e,t,n){return Fo.apply(this,arguments)}function Fo(){return(Fo=x(k().mark(function e(t,n,r){var i,a,u;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=ee(t),a=i.ns.get(n),u=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",u,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),je(e.t1)){e.next=12;break}throw e.t1;case 12:W("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.ns=i.ns.remove(n),i.rs.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}function Lo(e,t,n){var r=ee(e),i=ke.min(),a=Pr();return r.persistence.runTransaction("Execute query","readwrite",function(e){return function(e,t,n){var r=ee(e),i=r.rs.get(n);return void 0!==i?Ue.resolve(r.ns.get(i)):r.Qr.getTargetData(t,n)}(r,e,hr(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.ts.getDocumentsMatchingQuery(e,t,n?i:ke.min(),n?a:Pr())}).next(function(e){return Oo(r,xr(t),e),{documents:e,hs:a}})})}function Po(e,t){var n=ee(e),r=ee(n.Qr),i=n.ns.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(e){return r.ot(e,t).next(function(e){return e?e.target:null})})}function Ro(e,t){var n=ee(e),r=n.ss.get(t)||ke.min();return n.persistence.runTransaction("Get new document changes","readonly",function(e){return n.os.getAllFromCollectionGroup(e,t,Me(r,-1),Number.MAX_SAFE_INTEGER)}).then(function(e){return Oo(n,t,e),e})}function Oo(e,t,n){var r=e.ss.get(t)||ke.min();n.forEach(function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.ss.set(t,r)}function Vo(e,t,n,r){return qo.apply(this,arguments)}function qo(){return(qo=x(k().mark(function e(t,n,r,i){var a,u,o,s,c,l,f,h,d,v;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=ee(t),u=Pr(),o=Tr(),s=g(r);try{for(s.s();!(c=s.n()).done;)l=c.value,f=n.Ps(l.metadata.name),l.document&&(u=u.add(f)),(h=n.Is(l)).setReadTime(n.Ts(l.metadata.readTime)),o=o.insert(f,h)}catch(p){s.e(p)}finally{s.f()}return d=a.os.newChangeBuffer({trackRemovals:!0}),e.next=7,No(a,function(e){return hr(sr(xe.fromString("__bundle__/docs/".concat(e))))}(i));case 7:return v=e.sent,e.abrupt("return",a.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Do(e,d,o).next(function(t){return d.apply(e),t}).next(function(t){return a.Qr.removeMatchingKeysForTargetId(e,v.targetId).next(function(){return a.Qr.addMatchingKeys(e,u,v.targetId)}).next(function(){return a.localDocuments.getLocalViewOfDocuments(e,t.cs,t.ls)}).next(function(){return t.cs})})}));case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Uo(e,t){return Bo.apply(this,arguments)}function Bo(){return(Bo=x(k().mark(function e(t,n){var r,i,a,u=arguments;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]?u[2]:Pr(),e.next=3,No(t,hr(Oa(n.bundledQuery)));case 3:return i=e.sent,a=ee(t),e.abrupt("return",a.persistence.runTransaction("Save named query","readwrite",function(e){var t=Yi(n.readTime);if(i.snapshotVersion.compareTo(t)>=0)return a.$r.saveNamedQuery(e,n);var u=i.withResumeToken(jt.EMPTY_BYTE_STRING,t);return a.ns=a.ns.insert(u.targetId,u),a.Qr.updateTargetData(e,u).next(function(){return a.Qr.removeMatchingKeysForTargetId(e,i.targetId)}).next(function(){return a.Qr.addMatchingKeys(e,r,i.targetId)}).next(function(){return a.$r.saveNamedQuery(e,n)})}));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function zo(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function Go(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function Ko(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var Qo=function(){function e(t,n,r,i){R(this,e),this.user=t,this.batchId=n,this.state=r,this.error=i}return V(e,[{key:"ds",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Es",value:function(t,n,r){var i,a=JSON.parse(r),u="object"==P(a)&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==P(a.error));return u&&a.error&&((u="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(i=new ne(a.error.code,a.error.message))),u?new e(t,n,a.state,i):(H("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}])}(),jo=function(){function e(t,n,r){R(this,e),this.targetId=t,this.state=n,this.error=r}return V(e,[{key:"ds",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Es",value:function(t,n){var r,i=JSON.parse(n),a="object"==P(i)&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==P(i.error));return a&&i.error&&((a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new ne(i.error.code,i.error.message))),a?new e(t,i.state,r):(H("SharedClientState","Failed to parse target state for ID '".concat(t,"': ").concat(n)),null)}}])}(),Wo=function(){function e(t,n){R(this,e),this.clientId=t,this.activeTargetIds=n}return V(e,null,[{key:"Es",value:function(t,n){for(var r=JSON.parse(n),i="object"==P(r)&&r.activeTargetIds instanceof Array,a=Or(),u=0;i&&u<r.activeTargetIds.length;++u)i=nt(r.activeTargetIds[u]),a=a.add(r.activeTargetIds[u]);return i?new e(t,a):(H("SharedClientState","Failed to parse client data for instance '".concat(t,"': ").concat(n)),null)}}])}(),Ho=function(){function e(t,n){R(this,e),this.clientId=t,this.onlineState=n}return V(e,null,[{key:"Es",value:function(t){var n=JSON.parse(t);return"object"==P(n)&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(H("SharedClientState","Failed to parse online state: ".concat(t)),null)}}])}(),Jo=function(){return V(function e(){R(this,e),this.activeTargetIds=Or()},[{key:"As",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Rs",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"ds",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}])}(),Yo=function(){return V(function e(t,n,r,i,a){R(this,e),this.window=t,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Ot(pe),this.started=!1,this.ys=[];var u=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.ws=zo(this.persistenceKey,this.Vs),this.Ss=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Jo),this.bs=new RegExp("^firestore_clients_".concat(u,"_([^_]*)$")),this.Ds=new RegExp("^firestore_mutations_".concat(u,"_(\\d+)(?:_(.*))?$")),this.Cs=new RegExp("^firestore_targets_".concat(u,"_(\\d+)$")),this.vs=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.Fs=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.fs)},[{key:"start",value:function(){var e=x(k().mark(function e(){var t,n,r,i,a,u,o,s,c,l,f,h=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncEngine.Bi();case 2:t=e.sent,n=g(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=14;break}if((i=r.value)!==this.Vs){e.next=10;break}return e.abrupt("continue",12);case 10:(a=this.getItem(zo(this.persistenceKey,i)))&&(u=Wo.Es(i,a))&&(this.ps=this.ps.insert(u.clientId,u));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),n.e(e.t0);case 19:return e.prev=19,n.f(),e.finish(19);case 22:this.Ms(),(o=this.storage.getItem(this.vs))&&(s=this.xs(o))&&this.Os(s),c=g(this.ys);try{for(c.s();!(l=c.n()).done;)f=l.value,this.gs(f)}catch(d){c.e(d)}finally{c.f()}this.ys=[],this.window.addEventListener("pagehide",function(){return h.shutdown()}),this.started=!0;case 28:case"end":return e.stop()}},e,this,[[4,16,19,22]])}));return function(){return e.apply(this,arguments)}}()},{key:"writeSequenceNumber",value:function(e){this.setItem(this.Ss,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.Ns(this.ps)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.ps.forEach(function(n,r){r.activeTargetIds.has(e)&&(t=!0)}),t}},{key:"addPendingMutation",value:function(e){this.Ls(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.Ls(e,t,n),this.Bs(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(Ko(this.persistenceKey,e));if(n){var r=jo.Es(e,n);r&&(t=r.state)}}return this.ks.As(e),this.Ms(),t}},{key:"removeLocalQueryTarget",value:function(e){this.ks.Rs(e),this.Ms()}},{key:"isLocalQueryTarget",value:function(e){return this.ks.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(Ko(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.qs(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach(function(e){r.Bs(e)}),this.currentUser=e,n.forEach(function(e){r.addPendingMutation(e)})}},{key:"setOnlineState",value:function(e){this.Qs(e)}},{key:"notifyBundleLoaded",value:function(e){this.Ks(e)}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return W("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){W("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){W("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"gs",value:function(e){var t=this,n=e;if(n.storageArea===this.storage){if(W("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void H("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(x(k().mark(function e(){var r,i,a,u,o,s,c;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.started){e.next=43;break}if(null===n.key){e.next=41;break}if(!t.bs.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return r=t.$s(n.key),e.abrupt("return",t.Us(r,null));case 6:if(!(i=t.Ws(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",t.Us(i.clientId,i));case 9:e.next=41;break;case 11:if(!t.Ds.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(a=t.Gs(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",t.zs(a));case 16:e.next=41;break;case 18:if(!t.Cs.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(u=t.js(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",t.Hs(u));case 23:e.next=41;break;case 25:if(n.key!==t.vs){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(o=t.xs(n.newValue))){e.next=30;break}return e.abrupt("return",t.Os(o));case 30:e.next=41;break;case 32:if(n.key!==t.Ss){e.next=37;break}(s=function(e){var t=$e.oe;if(null!=e)try{var n=JSON.parse(e);Z("number"==typeof n),t=n}catch(e){H("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue))!==$e.oe&&t.sequenceNumberHandler(s),e.next=41;break;case 37:if(n.key!==t.Fs){e.next=41;break}return c=t.Js(n.newValue),e.next=41,Promise.all(c.map(function(e){return t.syncEngine.Ys(e)}));case 41:e.next=44;break;case 43:t.ys.push(n);case 44:case"end":return e.stop()}},e)})))}}},{key:"ks",get:function(){return this.ps.get(this.Vs)}},{key:"Ms",value:function(){this.setItem(this.ws,this.ks.ds())}},{key:"Ls",value:function(e,t,n){var r=new Qo(this.currentUser,e,t,n),i=Go(this.persistenceKey,this.currentUser,e);this.setItem(i,r.ds())}},{key:"Bs",value:function(e){var t=Go(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"Qs",value:function(e){var t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}},{key:"qs",value:function(e,t,n){var r=Ko(this.persistenceKey,e),i=new jo(e,t,n);this.setItem(r,i.ds())}},{key:"Ks",value:function(e){var t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}},{key:"$s",value:function(e){var t=this.bs.exec(e);return t?t[1]:null}},{key:"Ws",value:function(e,t){var n=this.$s(e);return Wo.Es(n,t)}},{key:"Gs",value:function(e,t){var n=this.Ds.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Qo.Es(new z(i),r,t)}},{key:"js",value:function(e,t){var n=this.Cs.exec(e),r=Number(n[1]);return jo.Es(r,t)}},{key:"xs",value:function(e){return Ho.Es(e)}},{key:"Js",value:function(e){return JSON.parse(e)}},{key:"zs",value:function(){var e=x(k().mark(function e(t){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==this.currentUser.uid){e.next=2;break}return e.abrupt("return",this.syncEngine.Zs(t.batchId,t.state,t.error));case 2:W("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"Hs",value:function(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}},{key:"Us",value:function(e,t){var n=this,r=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),a=this.Ns(r),u=[],o=[];return a.forEach(function(e){i.has(e)||u.push(e)}),i.forEach(function(e){a.has(e)||o.push(e)}),this.syncEngine.eo(u,o).then(function(){n.ps=r})}},{key:"Os",value:function(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"Ns",value:function(e){var t=Or();return e.forEach(function(e,n){t=t.unionWith(n.activeTargetIds)}),t}}],[{key:"D",value:function(e){return!(!e||!e.localStorage)}}])}(),Xo=function(){return V(function e(){R(this,e),this.no=new Jo,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null},[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.no.As(e),this.ro[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.ro[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.no.Rs(e)}},{key:"isLocalQueryTarget",value:function(e){return this.no.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.ro[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.no.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.no.activeTargetIds.has(e)}},{key:"start",value:function(){return this.no=new Jo,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}])}(),Zo=function(){return V(function e(){R(this,e)},[{key:"io",value:function(e){}},{key:"shutdown",value:function(){}}])}(),$o=function(){return V(function e(){var t=this;R(this,e),this.so=function(){return t.oo()},this._o=function(){return t.ao()},this.uo=[],this.co()},[{key:"io",value:function(e){this.uo.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}},{key:"co",value:function(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}},{key:"oo",value:function(){W("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=g(this.uo);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"ao",value:function(){W("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=g(this.uo);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"D",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}])}(),es=null;function ts(){return null===es?es=268435456+Math.round(2147483648*Math.random()):es++,"0x"+es.toString(16)}var ns={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},rs=function(){return V(function e(t){R(this,e),this.lo=t.lo,this.ho=t.ho},[{key:"Po",value:function(e){this.Io=e}},{key:"To",value:function(e){this.Eo=e}},{key:"Ao",value:function(e){this.Ro=e}},{key:"onMessage",value:function(e){this.Vo=e}},{key:"close",value:function(){this.ho()}},{key:"send",value:function(e){this.lo(e)}},{key:"mo",value:function(){this.Io()}},{key:"fo",value:function(){this.Eo()}},{key:"po",value:function(e){this.Ro(e)}},{key:"yo",value:function(e){this.Vo(e)}}])}(),is="WebChannelConnection",as=function(e){function t(e){var n;return R(this,t),(n=b(this,t,[e])).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n.longPollingOptions=e.longPollingOptions,n}return S(t,function(){function e(t){R(this,e);this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.wo=n+"://"+t.host,this.So="projects/".concat(r,"/databases/").concat(i),this.bo="(default)"===this.databaseId.database?"project_id=".concat(r):"project_id=".concat(r,"&database_id=").concat(i)}return V(e,[{key:"Do",get:function e(){return!1}},{key:"Co",value:function e(t,n,r,i,a){var u=ts(),o=this.vo(t,n.toUriEncodedString());W("RestConnection","Sending RPC '".concat(t,"' ").concat(u,":"),o,r);var s={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(s,i,a),this.Mo(t,o,s,r).then(function(e){return W("RestConnection","Received RPC '".concat(t,"' ").concat(u,": "),e),e},function(e){throw J("RestConnection","RPC '".concat(t,"' ").concat(u," failed with error: "),e,"url: ",o,"request:",r),e})}},{key:"xo",value:function e(t,n,r,i,a,u){return this.Co(t,n,r,i,a)}},{key:"Fo",value:function e(t,n,r){t["X-Goog-Api-Client"]=function e(){return"gl-js/ fire/"+G}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(function(e,n){return t[n]=e}),r&&r.headers.forEach(function(e,n){return t[n]=e})}},{key:"vo",value:function e(t,n){var r=ns[t];return"".concat(this.wo,"/v1/").concat(n,":").concat(r)}},{key:"terminate",value:function e(){}}])}()),V(t,[{key:"Mo",value:function(e,t,n,r){var i=ts();return new Promise(function(a,u){var o=new s.XhrIo;o.setWithCredentials(!0),o.listenOnce(s.EventType.COMPLETE,function(){try{switch(o.getLastErrorCode()){case s.ErrorCode.NO_ERROR:var t=o.getResponseJson();W(is,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),a(t);break;case s.ErrorCode.TIMEOUT:W(is,"RPC '".concat(e,"' ").concat(i," timed out")),u(new ne(te.DEADLINE_EXCEEDED,"Request time out"));break;case s.ErrorCode.HTTP_ERROR:var n=o.getStatus();if(W(is,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson();Array.isArray(r)&&(r=r[0]);var c=null==r?void 0:r.error;if(c&&c.status&&c.message){var l=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(te).indexOf(t)>=0?t:te.UNKNOWN}(c.status);u(new ne(l,c.message))}else u(new ne(te.UNKNOWN,"Server responded with status "+o.getStatus()))}else u(new ne(te.UNAVAILABLE,"Connection failed."));break;default:X()}}finally{W(is,"RPC '".concat(e,"' ").concat(i," completed."))}});var c=JSON.stringify(r);W(is,"RPC '".concat(e,"' ").concat(i," sending request:"),r),o.send(t,"POST",c,n,15)})}},{key:"Oo",value:function(e,t,n){var r=ts(),i=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=(0,s.createWebChannelTransport)(),u=(0,s.getStatEventTarget)(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(o.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(o.xmlHttpFactory=new s.FetchXmlHttpFactory({})),this.Fo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;var l=i.join("");W(is,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(l),o);var f=a.createWebChannel(l,o),h=!1,d=!1,v=new rs({lo:function(t){d?W(is,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(W(is,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),f.open(),h=!0),W(is,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),f.send(t))},ho:function(){return f.close()}}),p=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(e){setTimeout(function(){throw e},0)}})};return p(f,s.WebChannel.EventType.OPEN,function(){d||(W(is,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),v.mo())}),p(f,s.WebChannel.EventType.CLOSE,function(){d||(d=!0,W(is,"RPC '".concat(e,"' stream ").concat(r," transport closed")),v.po())}),p(f,s.WebChannel.EventType.ERROR,function(t){d||(d=!0,J(is,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),v.po(new ne(te.UNAVAILABLE,"The operation could not be completed")))}),p(f,s.WebChannel.EventType.MESSAGE,function(t){var n;if(!d){var i=t.data[0];Z(!!i);var a=i,u=a.error||(null===(n=a[0])||void 0===n?void 0:n.error);if(u){W(is,"RPC '".concat(e,"' stream ").concat(r," received error:"),u);var o=u.status,s=function(e){var t=pi[e];if(void 0!==t)return Ei(t)}(o),c=u.message;void 0===s&&(s=te.INTERNAL,c="Unknown error status: "+o+" with message "+u.message),d=!0,v.po(new ne(s,c)),f.close()}else W(is,"RPC '".concat(e,"' stream ").concat(r," received:"),i),v.yo(i)}}),p(u,s.Event.STAT_EVENT,function(t){t.stat===s.Stat.PROXY?W(is,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===s.Stat.NOPROXY&&W(is,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(function(){v.fo()},0),v}}])}();function us(){return"undefined"!=typeof window?window:null}function os(){return"undefined"!=typeof document?document:null}function ss(e){return new Qi(e,!0)}var cs=function(){return V(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;R(this,e),this.oi=t,this.timerId=n,this.No=r,this.Lo=i,this.Bo=a,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()},[{key:"reset",value:function(){this.ko=0}},{key:"Ko",value:function(){this.ko=this.Bo}},{key:"$o",value:function(e){var t=this;this.cancel();var n=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,n-r);i>0&&W("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.ko," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,function(){return t.Qo=Date.now(),e()}),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}},{key:"Wo",value:function(){null!==this.qo&&(this.qo.skipDelay(),this.qo=null)}},{key:"cancel",value:function(){null!==this.qo&&(this.qo.cancel(),this.qo=null)}},{key:"Uo",value:function(){return(Math.random()-.5)*this.ko}}])}(),ls=function(){return V(function e(t,n,r,i,a,u,o,s){R(this,e),this.oi=t,this.Go=r,this.zo=i,this.connection=a,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=o,this.listener=s,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new cs(t,n)},[{key:"Zo",value:function(){return 1===this.state||5===this.state||this.Xo()}},{key:"Xo",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.e_()}},{key:"stop",value:function(){var e=x(k().mark(function e(){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.Zo(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"t_",value:function(){this.state=0,this.Yo.reset()}},{key:"n_",value:function(){var e=this;this.Xo()&&null===this.Ho&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,function(){return e.r_()}))}},{key:"i_",value:function(e){this.s_(),this.stream.send(e)}},{key:"r_",value:function(){var e=x(k().mark(function e(){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.Xo()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"s_",value:function(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}},{key:"o_",value:function(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}},{key:"close",value:function(){var e=x(k().mark(function e(t,n){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.s_(),this.o_(),this.Yo.cancel(),this.jo++,4!==t?this.Yo.reset():n&&n.code===te.RESOURCE_EXHAUSTED?(H(n.toString()),H("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):n&&n.code===te.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.__(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.Ao(n);case 9:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"__",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.a_(this.jo),n=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=f(t,2),i=r[0],a=r[1];e.jo===n&&e.u_(i,a)},function(n){t(function(){var t=new ne(te.UNKNOWN,"Fetching auth token failed: "+n.message);return e.c_(t)})})}},{key:"u_",value:function(e,t){var n=this,r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(function(){r(function(){return n.listener.Po()})}),this.stream.To(function(){r(function(){return n.state=2,n.Jo=n.oi.enqueueAfterDelay(n.zo,1e4,function(){return n.Xo()&&(n.state=3),Promise.resolve()}),n.listener.To()})}),this.stream.Ao(function(e){r(function(){return n.c_(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"e_",value:function(){var e=this;this.state=5,this.Yo.$o(x(k().mark(function t(){return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"c_",value:function(e){return W("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"a_",value:function(e){var t=this;return function(n){t.oi.enqueueAndForget(function(){return t.jo===e?n():(W("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}])}(),fs=function(e){function t(e,n,r,i,a,u){var o;return R(this,t),(o=b(this,t,[e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,u])).serializer=a,o}return S(t,ls),V(t,[{key:"l_",value:function(e,t){return this.connection.Oo("Listen",e,t)}},{key:"onMessage",value:function(e){this.Yo.reset();var t=ca(this.serializer,e),n=function(e){if(!("targetChange"in e))return ke.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?ke.min():t.readTime?Yi(t.readTime):ke.min()}(e);return this.listener.h_(t,n)}},{key:"P_",value:function(e){var t={};t.database=ia(this.serializer),t.addTarget=function(e,t){var n,r=t.target;if((n=nr(r)?{documents:da(e,r)}:{query:va(e,r)._t}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Hi(e,t.resumeToken);var i=ji(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(ke.min())>0){n.readTime=Wi(e,t.snapshotVersion.toTimestamp());var a=ji(e,t.expectedCount);null!==a&&(n.expectedCount=a)}return n}(this.serializer,e);var n=ma(this.serializer,e);n&&(t.labels=n),this.i_(t)}},{key:"I_",value:function(e){var t={};t.database=ia(this.serializer),t.removeTarget=e,this.i_(t)}}])}(),hs=function(e){function t(e,n,r,i,a,u){var o;return R(this,t),(o=b(this,t,[e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,u])).serializer=a,o.T_=!1,o}return S(t,ls),V(t,[{key:"E_",get:function(){return this.T_}},{key:"start",value:function(){this.T_=!1,this.lastStreamToken=void 0,c(T(t.prototype),"start",this).call(this)}},{key:"__",value:function(){this.T_&&this.d_([])}},{key:"l_",value:function(e,t){return this.connection.Oo("Write",e,t)}},{key:"onMessage",value:function(e){if(Z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();var t=ha(e.writeResults,e.commitTime),n=Yi(e.commitTime);return this.listener.A_(n,t)}return Z(!e.writeResults||0===e.writeResults.length),this.T_=!0,this.listener.R_()}},{key:"V_",value:function(){var e={};e.database=ia(this.serializer),this.i_(e)}},{key:"d_",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return la(t.serializer,e)})};this.i_(n)}}])}(),ds=function(e){function t(e,n,r,i){var a;return R(this,t),(a=b(this,t)).authCredentials=e,a.appCheckCredentials=n,a.connection=r,a.serializer=i,a.m_=!1,a}return S(t,V(function e(){R(this,e)})),V(t,[{key:"f_",value:function(){if(this.m_)throw new ne(te.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"Co",value:function(e,t,n,r){var i=this;return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(a){var u=f(a,2),o=u[0],s=u[1];return i.connection.Co(e,Zi(t,n),r,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===te.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new ne(te.UNKNOWN,e.toString())})}},{key:"xo",value:function(e,t,n,r,i){var a=this;return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(u){var o=f(u,2),s=o[0],c=o[1];return a.connection.xo(e,Zi(t,n),r,s,c,i)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===te.UNAUTHENTICATED&&(a.authCredentials.invalidateToken(),a.appCheckCredentials.invalidateToken()),e):new ne(te.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.m_=!0,this.connection.terminate()}}])}(),vs=function(){return V(function e(t,n){R(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0},[{key:"w_",value:function(){var e=this;0===this.g_&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.p_=null,e.b_("Backend didn't respond within 10 seconds."),e.S_("Offline"),Promise.resolve()}))}},{key:"D_",value:function(e){"Online"===this.state?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.S_("Offline")))}},{key:"set",value:function(e){this.C_(),this.g_=0,"Online"===e&&(this.y_=!1),this.S_(e)}},{key:"S_",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"b_",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.y_?(H(t),this.y_=!1):W("OnlineStateTracker",t)}},{key:"C_",value:function(){null!==this.p_&&(this.p_.cancel(),this.p_=null)}}])}(),ps=V(function e(t,n,r,i,a){var u=this;R(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=a,this.O_.io(function(e){r.enqueueAndForget(x(k().mark(function e(){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Ts(u),!e.t0){e.next=5;break}return W("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=x(k().mark(function e(t){var n;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=ee(t)).M_.add(4),e.next=4,gs(n);case 4:return n.N_.set("Unknown"),n.M_.delete(4),e.next=8,ys(n);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(u);case 5:case"end":return e.stop()}},e)})))}),this.N_=new vs(r,i)});function ys(e){return ms.apply(this,arguments)}function ms(){return(ms=x(k().mark(function e(t){var n,r,i;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ts(t)){e.next=18;break}n=g(t.x_),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])}))).apply(this,arguments)}function gs(e){return ks.apply(this,arguments)}function ks(){return(ks=x(k().mark(function e(t){var n,r,i;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=g(t.x_),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])}))).apply(this,arguments)}function ws(e,t){var n=ee(e);n.F_.has(t.targetId)||(n.F_.set(t.targetId,t),Es(n)?_s(n):rc(n).Xo()&&bs(n,t))}function xs(e,t){var n=ee(e),r=rc(n);n.F_.delete(t),r.Xo()&&Is(n,t),0===n.F_.size&&(r.Xo()?r.n_():Ts(n)&&n.N_.set("Unknown"))}function bs(e,t){if(e.L_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ke.min())>0){var n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}rc(e).P_(t)}function Is(e,t){e.L_.xe(t),rc(e).I_(t)}function _s(e){e.L_=new qi({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},ot:function(t){return e.F_.get(t)||null},tt:function(){return e.datastore.serializer.databaseId}}),rc(e).start(),e.N_.w_()}function Es(e){return Ts(e)&&!rc(e).Zo()&&e.F_.size>0}function Ts(e){return 0===ee(e).M_.size}function Ss(e){e.L_=void 0}function Cs(e){return Ds.apply(this,arguments)}function Ds(){return(Ds=x(k().mark(function e(t){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.N_.set("Online");case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function As(e){return Ns.apply(this,arguments)}function Ns(){return(Ns=x(k().mark(function e(t){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.F_.forEach(function(e,n){bs(t,e)});case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ms(e,t){return Fs.apply(this,arguments)}function Fs(){return(Fs=x(k().mark(function e(t,n){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Ss(t),Es(t)?(t.N_.D_(n),_s(t)):t.N_.set("Unknown");case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ls(e,t,n){return Ps.apply(this,arguments)}function Ps(){return(Ps=x(k().mark(function e(t,n,r){var i;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.N_.set("Online"),!(n instanceof Oi&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=x(k().mark(function e(t,n){var r,i,a,u;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=g(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(u=a.value,e.t0=t.F_.has(u),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(u,r);case 10:t.F_.delete(u),t.L_.removeTarget(u);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])}));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),W("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,Rs(t,e.t0);case 11:e.next=29;break;case 13:if(n instanceof Pi?t.L_.Ke(n):n instanceof Ri?t.L_.He(n):t.L_.We(n),r.isEqual(ke.min())){e.next=29;break}return e.prev=14,e.next=17,So(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.L_.rt(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.F_.get(r);i&&e.F_.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t,n){var r=e.F_.get(t);if(r){e.F_.set(t,r.withResumeToken(jt.EMPTY_BYTE_STRING,r.snapshotVersion)),Is(e,t);var i=new Sa(r.target,t,n,r.sequenceNumber);bs(e,i)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 22:e.next=29;break;case 24:return e.prev=24,e.t2=e.catch(14),W("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,Rs(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])}))).apply(this,arguments)}function Rs(e,t,n){return Os.apply(this,arguments)}function Os(){return(Os=x(k().mark(function e(t,n,r){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(je(n)){e.next=2;break}throw n;case 2:return t.M_.add(1),e.next=5,gs(t);case 5:t.N_.set("Offline"),r||(r=function(){return So(t.localStore)}),t.asyncQueue.enqueueRetryable(x(k().mark(function e(){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return W("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.M_.delete(1),e.next=6,ys(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Vs(e,t){return t().catch(function(n){return Rs(e,n,t)})}function qs(e){return Us.apply(this,arguments)}function Us(){return(Us=x(k().mark(function e(t){var n,r,i,a;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=ee(t),r=ic(n),i=n.v_.length>0?n.v_[n.v_.length-1].batchId:-1;case 2:if(!Bs(n)){e.next=19;break}return e.prev=3,e.next=6,Ao(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.v_.length&&r.n_(),e.abrupt("break",19);case 10:i=a.batchId,zs(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,Rs(n,e.t0);case 17:e.next=2;break;case 19:Gs(n)&&Ks(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])}))).apply(this,arguments)}function Bs(e){return Ts(e)&&e.v_.length<10}function zs(e,t){e.v_.push(t);var n=ic(e);n.Xo()&&n.E_&&n.d_(t.mutations)}function Gs(e){return Ts(e)&&!ic(e).Zo()&&e.v_.length>0}function Ks(e){ic(e).start()}function Qs(e){return js.apply(this,arguments)}function js(){return(js=x(k().mark(function e(t){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ic(t).V_();case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ws(e){return Hs.apply(this,arguments)}function Hs(){return(Hs=x(k().mark(function e(t){var n,r,i,a;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=ic(t),r=g(t.v_);try{for(r.s();!(i=r.n()).done;)a=i.value,n.d_(a.mutations)}catch(u){r.e(u)}finally{r.f()}case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Js(e,t,n){return Ys.apply(this,arguments)}function Ys(){return(Ys=x(k().mark(function e(t,n,r){var i,a;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.v_.shift(),a=wi.from(i,n,r),e.next=3,Vs(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,qs(t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Xs(e,t){return Zs.apply(this,arguments)}function Zs(){return(Zs=x(k().mark(function e(t,n){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&ic(t).E_,!e.t0){e.next=4;break}return e.next=4,function(){var e=x(k().mark(function e(t,n){var r;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!function(e){return _i(e)&&e!==te.ABORTED}(n.code)){e.next=7;break}return r=t.v_.shift(),ic(t).t_(),e.next=5,Vs(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,qs(t);case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:Gs(t)&&Ks(t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function $s(e,t){return ec.apply(this,arguments)}function ec(){return(ec=x(k().mark(function e(t,n){var r,i;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=ee(t)).asyncQueue.verifyOperationInProgress(),W("RemoteStore","RemoteStore received new credentials"),i=Ts(r),r.M_.add(3),e.next=6,gs(r);case 6:return i&&r.N_.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.M_.delete(3),e.next=12,ys(r);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function tc(e,t){return nc.apply(this,arguments)}function nc(){return(nc=x(k().mark(function e(t,n){var r;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=ee(t),!n){e.next=7;break}return r.M_.delete(2),e.next=5,ys(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.M_.add(2),e.next=12,gs(r);case 12:r.N_.set("Unknown");case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function rc(e){return e.B_||(e.B_=function(e,t,n){var r=ee(e);return r.f_(),new fs(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:Cs.bind(null,e),To:As.bind(null,e),Ao:Ms.bind(null,e),h_:Ls.bind(null,e)}),e.x_.push(function(){var t=x(k().mark(function t(n){return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.B_.t_(),Es(e)?_s(e):e.N_.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.B_.stop();case 6:Ss(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.B_}function ic(e){return e.k_||(e.k_=function(e,t,n){var r=ee(e);return r.f_(),new hs(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:function(){return Promise.resolve()},To:Qs.bind(null,e),Ao:Xs.bind(null,e),R_:Ws.bind(null,e),A_:Js.bind(null,e)}),e.x_.push(function(){var t=x(k().mark(function t(n){return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.k_.t_(),t.next=4,qs(e);case 4:t.next=9;break;case 6:return t.next=8,e.k_.stop();case 8:e.v_.length>0&&(W("RemoteStore","Stopping write stream with ".concat(e.v_.length," pending writes")),e.v_=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.k_}var ac=function(){function e(t,n,r,i,a){R(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new re,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return V(e,[{key:"promise",get:function(){return this.deferred.promise}},{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ne(te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var u=new e(t,n,Date.now()+r,i,a);return u.start(r),u}}])}();function uc(e,t){if(H("AsyncQueue","".concat(t,": ").concat(e)),je(e))return new ne(te.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var oc,sc,cc=function(){function e(t){R(this,e),this.comparator=t?function(e,n){return t(e,n)||_e.comparator(e.key,n.key)}:function(e,t){return _e.comparator(e.key,t.key)},this.keyedMap=Cr(),this.sortedSet=new Ot(this.comparator)}return V(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}])}(),lc=function(){return V(function e(){R(this,e),this.q_=new Ot(_e.comparator)},[{key:"track",value:function(e){var t=e.doc.key,n=this.q_.get(t);n?0!==e.type&&3===n.type?this.q_=this.q_.insert(t,e):3===e.type&&1!==n.type?this.q_=this.q_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.q_=this.q_.remove(t):1===e.type&&2===n.type?this.q_=this.q_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):X():this.q_=this.q_.insert(t,e)}},{key:"Q_",value:function(){var e=[];return this.q_.inorderTraversal(function(t,n){e.push(n)}),e}}])}(),fc=function(){function e(t,n,r,i,a,u,o,s,c){R(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=u,this.syncStateChanged=o,this.excludesMetadataChanges=s,this.hasCachedResults=c}return V(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mr(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i,a){var u=[];return n.forEach(function(e){u.push({type:0,doc:e})}),new e(t,n,cc.emptySet(n),u,r,i,!0,!1,a)}}])}(),hc=function(){return V(function e(){R(this,e),this.K_=void 0,this.U_=[]},[{key:"W_",value:function(){return this.U_.some(function(e){return e.G_()})}}])}(),dc=V(function e(){R(this,e),this.queries=new _r(function(e){return gr(e)},mr),this.onlineState="Unknown",this.z_=new Set});function vc(e,t){return pc.apply(this,arguments)}function pc(){return(pc=x(k().mark(function e(t,n){var r,i,a,u,o;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=ee(t),i=3,a=n.query,(u=r.queries.get(a))?!u.W_()&&n.G_()&&(i=2):(u=new hc,i=n.G_()?0:1),e.prev=5,e.t0=i,e.next=0===e.t0?9:1===e.t0?13:2===e.t0?17:19;break;case 9:return e.next=11,r.onListen(a,!0);case 11:return u.K_=e.sent,e.abrupt("break",19);case 13:return e.next=15,r.onListen(a,!1);case 15:return u.K_=e.sent,e.abrupt("break",19);case 17:return e.next=19,r.onFirstRemoteStoreListen(a);case 19:e.next=25;break;case 21:return e.prev=21,e.t1=e.catch(5),o=uc(e.t1,"Initialization of query '".concat(kr(n.query),"' failed")),e.abrupt("return",void n.onError(o));case 25:r.queries.set(a,u),u.U_.push(n),n.j_(r.onlineState),u.K_&&n.H_(u.K_)&&wc(r);case 26:case"end":return e.stop()}},e,null,[[5,21]])}))).apply(this,arguments)}function yc(e,t){return mc.apply(this,arguments)}function mc(){return(mc=x(k().mark(function e(t,n){var r,i,a,u,o;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=ee(t),i=n.query,a=3,(u=r.queries.get(i))&&(o=u.U_.indexOf(n))>=0&&(u.U_.splice(o,1),0===u.U_.length?a=n.G_()?0:1:!u.W_()&&n.G_()&&(a=2)),e.t0=a,e.next=0===e.t0?7:1===e.t0?8:2===e.t0?9:10;break;case 7:return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i,!0)));case 8:return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i,!1)));case 9:return e.abrupt("return",r.onLastRemoteStoreUnlisten(i));case 10:return e.abrupt("return");case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function gc(e,t){var n,r=ee(e),i=!1,a=g(t);try{for(a.s();!(n=a.n()).done;){var u=n.value,o=u.query,s=r.queries.get(o);if(s){var c,l=g(s.U_);try{for(l.s();!(c=l.n()).done;){c.value.H_(u)&&(i=!0)}}catch(f){l.e(f)}finally{l.f()}s.K_=u}}}catch(f){a.e(f)}finally{a.f()}i&&wc(r)}function kc(e,t,n){var r=ee(e),i=r.queries.get(t);if(i){var a,u=g(i.U_);try{for(u.s();!(a=u.n()).done;){a.value.onError(n)}}catch(o){u.e(o)}finally{u.f()}}r.queries.delete(t)}function wc(e){e.z_.forEach(function(e){e.next()})}(sc=oc||(oc={})).J_="default",sc.Cache="cache";var xc=function(){return V(function e(t,n,r){R(this,e),this.query=t,this.Y_=n,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}},[{key:"H_",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=g(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(u){r.e(u)}finally{r.f()}e=new fc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}var a=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),a=!0):this.ta(e,this.onlineState)&&(this.na(e),a=!0),this.X_=e,a}},{key:"onError",value:function(e){this.Y_.error(e)}},{key:"j_",value:function(e){this.onlineState=e;var t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}},{key:"ta",value:function(e,t){if(!e.fromCache)return!0;if(!this.G_())return!0;var n="Offline"!==t;return(!this.options.ra||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}},{key:"ea",value:function(e){if(e.docChanges.length>0)return!0;var t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"na",value:function(e){e=fc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}},{key:"G_",value:function(){return this.options.source!==oc.Cache}}])}(),bc=function(){return V(function e(t,n){R(this,e),this.ia=t,this.byteLength=n},[{key:"sa",value:function(){return"metadata"in this.ia}}])}(),Ic=function(){return V(function e(t){R(this,e),this.serializer=t},[{key:"Ps",value:function(e){return ta(this.serializer,e)}},{key:"Is",value:function(e){return e.metadata.exists?oa(this.serializer,e.document,!1):Sn.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}},{key:"Ts",value:function(e){return Yi(e)}}])}(),_c=function(){return V(function e(t,n,r){R(this,e),this.oa=t,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Ec(t)},[{key:"_a",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;var n=xe.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"aa",value:function(e){var t,n=new Map,r=new Ic(this.serializer),i=g(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.metadata.queries){var u,o=r.Ps(a.metadata.name),s=g(a.metadata.queries);try{for(s.s();!(u=s.n()).done;){var c=u.value,l=(n.get(c)||Pr()).add(o);n.set(c,l)}}catch(f){s.e(f)}finally{s.f()}}}}catch(f){i.e(f)}finally{i.f()}return n}},{key:"complete",value:function(){var e=x(k().mark(function e(){var t,n,r,i,a;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vo(this.localStore,new Ic(this.serializer),this.documents,this.oa.id);case 2:t=e.sent,n=this.aa(this.documents),r=g(this.queries),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=13;break}return a=i.value,e.next=11,Uo(this.localStore,a,n.get(a.name));case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",(this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:t}));case 22:case"end":return e.stop()}},e,this,[[5,15,18,21]])}));return function(){return e.apply(this,arguments)}}()}])}();function Ec(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}var Tc=V(function e(t){R(this,e),this.key=t}),Sc=V(function e(t){R(this,e),this.key=t}),Cc=function(){return V(function e(t,n){R(this,e),this.query=t,this.la=n,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=Pr(),this.mutatedKeys=Pr(),this.Ia=br(t),this.Ta=new cc(this.Ia)},[{key:"Ea",get:function(){return this.la}},{key:"da",value:function(e,t){var n=this,r=t?t.Aa:new lc,i=t?t.Ta:this.Ta,a=t?t.mutatedKeys:this.mutatedKeys,u=i,o=!1,s="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),f=wr(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;l&&f?l.data.isEqual(f.data)?h!==d&&(r.track({type:3,doc:f}),v=!0):n.Ra(l,f)||(r.track({type:2,doc:f}),v=!0,(s&&n.Ia(f,s)>0||c&&n.Ia(f,c)<0)&&(o=!0)):!l&&f?(r.track({type:0,doc:f}),v=!0):l&&!f&&(r.track({type:1,doc:l}),v=!0,(s||c)&&(o=!0)),v&&(f?(u=u.add(f),a=d?a.add(e):a.delete(e)):(u=u.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;u.size>this.query.limit;){var l="F"===this.query.limitType?u.last():u.first();u=u.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Ta:u,Aa:r,Xi:o,mutatedKeys:a}}},{key:"Ra",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n,r){var i=this,a=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;var u=e.Aa.Q_();u.sort(function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return X()}};return n(e)-n(t)}(e.type,t.type)||i.Ia(e.doc,t.doc)}),this.Va(n),r=null!=r&&r;var o=t&&!r?this.ma():[],s=0===this.Pa.size&&this.current&&!r?1:0,c=s!==this.ha;return this.ha=s,0!==u.length||c?{snapshot:new fc(this.query,e.Ta,a,u,e.mutatedKeys,0===s,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),fa:o}:{fa:o}}},{key:"j_",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new lc,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}},{key:"ga",value:function(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}},{key:"Va",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.la=t.la.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.la=t.la.delete(e)}),this.current=e.current)}},{key:"ma",value:function(){var e=this;if(!this.current)return[];var t=this.Pa;this.Pa=Pr(),this.Ta.forEach(function(t){e.ga(t.key)&&(e.Pa=e.Pa.add(t.key))});var n=[];return t.forEach(function(t){e.Pa.has(t)||n.push(new Sc(t))}),this.Pa.forEach(function(e){t.has(e)||n.push(new Tc(e))}),n}},{key:"pa",value:function(e){this.la=e.hs,this.Pa=Pr();var t=this.da(e.documents);return this.applyChanges(t,!0)}},{key:"ya",value:function(){return fc.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,0===this.ha,this.hasCachedResults)}}])}(),Dc=V(function e(t,n,r){R(this,e),this.query=t,this.targetId=n,this.view=r}),Ac=V(function e(t){R(this,e),this.key=t,this.wa=!1}),Nc=function(){return V(function e(t,n,r,i,a,u){R(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=u,this.Sa={},this.ba=new _r(function(e){return gr(e)},mr),this.Da=new Map,this.Ca=new Set,this.va=new Ot(_e.comparator),this.Fa=new Map,this.Ma=new to,this.xa={},this.Oa=new Map,this.Na=Au.Ln(),this.onlineState="Unknown",this.La=void 0},[{key:"isPrimaryClient",get:function(){return!0===this.La}}])}();function Mc(e,t){return Fc.apply(this,arguments)}function Fc(){return(Fc=x(k().mark(function e(t,n){var r,i,a,u,o=arguments;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(o.length>2&&void 0!==o[2])||o[2],i=Nl(t),!(u=i.ba.get(n))){e.next=7;break}i.sharedClientState.addLocalQueryTarget(u.targetId),a=u.view.ya(),e.next=10;break;case 7:return e.next=9,Rc(i,n,r,!0);case 9:a=e.sent;case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Lc(e,t){return Pc.apply(this,arguments)}function Pc(){return(Pc=x(k().mark(function e(t,n){var r;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Nl(t),e.next=3,Rc(r,n,!0,!1);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Rc(e,t,n,r){return Oc.apply(this,arguments)}function Oc(){return(Oc=x(k().mark(function e(t,n,r,i){var a,u,o,s;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,No(t.localStore,hr(n));case 2:if(a=e.sent,u=a.targetId,o=r?t.sharedClientState.addLocalQueryTarget(u):"not-current",e.t0=i,!e.t0){e.next=10;break}return e.next=9,Vc(t,n,u,"current"===o,a.resumeToken);case 9:s=e.sent;case 10:return t.isPrimaryClient&&r&&ws(t.remoteStore,a),e.abrupt("return",s);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Vc(e,t,n,r,i){return qc.apply(this,arguments)}function qc(){return(qc=x(k().mark(function e(t,n,r,i,a){var u,o,s,c,l,f;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.Ba=function(e,n,r){return function(){var e=x(k().mark(function e(t,n,r,i){var a,u,o,s;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.da(r),e.t0=a.Xi,!e.t0){e.next=6;break}return e.next=5,Lo(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.da(t,a)});case 5:a=e.sent;case 6:return u=i&&i.targetChanges.get(n.targetId),o=i&&null!=i.targetMismatches.get(n.targetId),s=n.view.applyChanges(a,t.isPrimaryClient,u,o),e.abrupt("return",(ol(t,n.targetId,s.fa),s.snapshot));case 8:case"end":return e.stop()}},e)}));return function(t,n,r,i){return e.apply(this,arguments)}}()(t,e,n,r)},e.next=3,Lo(t.localStore,n,!0);case 3:return u=e.sent,o=new Cc(n,u.hs),s=o.da(u.documents),c=Li.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState,a),l=o.applyChanges(s,t.isPrimaryClient,c),ol(t,r,l.fa),f=new Dc(n,r,o),e.abrupt("return",(t.ba.set(n,f),t.Da.has(r)?t.Da.get(r).push(n):t.Da.set(r,[n]),l.snapshot));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Uc(e,t,n){return Bc.apply(this,arguments)}function Bc(){return(Bc=x(k().mark(function e(t,n,r){var i,a,u;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=ee(t),a=i.ba.get(n),!((u=i.Da.get(a.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(i.Da.set(a.targetId,u.filter(function(e){return!mr(e,n)})),void i.ba.delete(n)));case 3:if(!i.isPrimaryClient){e.next=11;break}if(i.sharedClientState.removeLocalQueryTarget(a.targetId),e.t0=i.sharedClientState.isActiveQueryTarget(a.targetId),e.t0){e.next=9;break}return e.next=9,Mo(i.localStore,a.targetId,!1).then(function(){i.sharedClientState.clearQueryState(a.targetId),r&&xs(i.remoteStore,a.targetId),al(i,a.targetId)}).catch(Ve);case 9:e.next=14;break;case 11:return al(i,a.targetId),e.next=14,Mo(i.localStore,a.targetId,!0);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function zc(e,t){return Gc.apply(this,arguments)}function Gc(){return(Gc=x(k().mark(function e(t,n){var r,i,a;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=ee(t),i=r.ba.get(n),a=r.Da.get(i.targetId),r.isPrimaryClient&&1===a.length&&(r.sharedClientState.removeLocalQueryTarget(i.targetId),xs(r.remoteStore,i.targetId));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Kc(e,t,n){return Qc.apply(this,arguments)}function Qc(){return(Qc=x(k().mark(function e(t,n,r){var i,a,u;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ml(t),e.prev=1,e.next=4,function(e,t){var n,r,i=ee(e),a=ge.now(),u=t.reduce(function(e,t){return e.add(t.key)},Pr());return i.persistence.runTransaction("Locally write mutations","readwrite",function(e){var o=Tr(),s=Pr();return i.os.getEntries(e,u).next(function(e){(o=e).forEach(function(e,t){t.isValidDocument()||(s=s.add(e))})}).next(function(){return i.localDocuments.getOverlayedDocuments(e,o)}).next(function(r){n=r;var u,o=[],s=g(t);try{for(s.s();!(u=s.n()).done;){var c=u.value,l=si(c,n.get(c.key).overlayedDocument);null!=l&&o.push(new fi(c.key,l,Tn(l.value.mapValue),ni.exists(!0)))}}catch(f){s.e(f)}finally{s.f()}return i.mutationQueue.addMutationBatch(e,a,o,t)}).next(function(t){r=t;var a=t.applyToLocalDocumentSet(n,s);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)})}).then(function(){return{batchId:r.batchId,changes:Dr(n)}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.xa[e.currentUser.toKey()];r||(r=new Ot(pe)),r=r.insert(t,n),e.xa[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,ll(i,a.changes);case 9:return e.next=11,qs(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),u=uc(e.t0,"Failed to persist write"),r.reject(u);case 17:case"end":return e.stop()}},e,null,[[1,13]])}))).apply(this,arguments)}function jc(e,t){return Wc.apply(this,arguments)}function Wc(){return(Wc=x(k().mark(function e(t,n){var r,i;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ee(t),e.prev=1,e.next=4,Co(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.Fa.get(t);n&&(Z(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.wa=!0:e.modifiedDocuments.size>0?Z(n.wa):e.removedDocuments.size>0&&(Z(n.wa),n.wa=!1))}),e.next=8,ll(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Ve(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])}))).apply(this,arguments)}function Hc(e,t,n){var r=ee(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.ba.forEach(function(e,n){var r=n.view.j_(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=ee(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=g(n.U_);try{for(a.s();!(i=a.n()).done;){i.value.j_(t)&&(r=!0)}}catch(u){a.e(u)}finally{a.f()}}),r&&wc(n)}(r.eventManager,t),i.length&&r.Sa.h_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Jc(e,t,n){return Yc.apply(this,arguments)}function Yc(){return(Yc=x(k().mark(function e(t,n,r){var i,a,u,o,s,c;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=ee(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.Fa.get(n),!(u=a&&a.key)){e.next=14;break}return o=(o=new Ot(_e.comparator)).insert(u,Sn.newNoDocument(u,ke.min())),s=Pr().add(u),c=new Fi(ke.min(),new Map,new Ot(pe),o,s),e.next=9,jc(i,c);case 9:i.va=i.va.remove(u),i.Fa.delete(n),cl(i),e.next=16;break;case 14:return e.next=16,Mo(i.localStore,n,!1).then(function(){return al(i,n,r)}).catch(Ve);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Xc(e,t){return Zc.apply(this,arguments)}function Zc(){return(Zc=x(k().mark(function e(t,n){var r,i,a;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ee(t),i=n.batch.batchId,e.prev=1,e.next=4,To(r.localStore,n);case 4:return a=e.sent,il(r,i,null),rl(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,ll(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Ve(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function $c(e,t,n){return el.apply(this,arguments)}function el(){return(el=x(k().mark(function e(t,n,r){var i,a;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=ee(t),e.prev=1,e.next=4,function(e,t){var n=ee(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next(function(t){return Z(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)}).next(function(){return n.localDocuments.getDocuments(e,r)})})}(i.localStore,n);case 4:return a=e.sent,il(i,n,r),rl(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,ll(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Ve(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function tl(e,t){return nl.apply(this,arguments)}function nl(){return(nl=x(k().mark(function e(t,n){var r,i,a,u;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Ts((r=ee(t)).remoteStore)||W("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=ee(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)})}(r.localStore);case 5:if(-1!==(i=e.sent)){e.next=8;break}return e.abrupt("return",void n.resolve());case 8:(a=r.Oa.get(i)||[]).push(n),r.Oa.set(i,a),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),u=uc(e.t0,"Initialization of waitForPendingWrites() operation failed"),n.reject(u);case 16:case"end":return e.stop()}},e,null,[[2,12]])}))).apply(this,arguments)}function rl(e,t){(e.Oa.get(t)||[]).forEach(function(e){e.resolve()}),e.Oa.delete(t)}function il(e,t,n){var r=ee(e),i=r.xa[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.xa[r.currentUser.toKey()]=i}}function al(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=g(e.Da.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.ba.delete(a),n&&e.Sa.ka(a,n)}}catch(u){i.e(u)}finally{i.f()}e.Da.delete(t),e.isPrimaryClient&&e.Ma.Vr(t).forEach(function(t){e.Ma.containsKey(t)||ul(e,t)})}function ul(e,t){e.Ca.delete(t.path.canonicalString());var n=e.va.get(t);null!==n&&(xs(e.remoteStore,n),e.va=e.va.remove(t),e.Fa.delete(n),cl(e))}function ol(e,t,n){var r,i=g(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof Tc?(e.Ma.addReference(a.key,t),sl(e,a)):a instanceof Sc?(W("SyncEngine","Document no longer in limbo: "+a.key),e.Ma.removeReference(a.key,t),e.Ma.containsKey(a.key)||ul(e,a.key)):X()}}catch(u){i.e(u)}finally{i.f()}}function sl(e,t){var n=t.key,r=n.path.canonicalString();e.va.get(n)||e.Ca.has(r)||(W("SyncEngine","New document in limbo: "+n),e.Ca.add(r),cl(e))}function cl(e){for(;e.Ca.size>0&&e.va.size<e.maxConcurrentLimboResolutions;){var t=e.Ca.values().next().value;e.Ca.delete(t);var n=new _e(xe.fromString(t)),r=e.Na.next();e.Fa.set(r,new Ac(n)),e.va=e.va.insert(n,r),ws(e.remoteStore,new Sa(hr(sr(n.path)),r,"TargetPurposeLimboResolution",$e.oe))}}function ll(e,t,n){return fl.apply(this,arguments)}function fl(){return(fl=x(k().mark(function e(t,n,r){var i,a,u,o;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=ee(t),a=[],u=[],o=[],e.t0=i.ba.isEmpty(),e.t0){e.next=9;break}return i.ba.forEach(function(e,t){o.push(i.Ba(t,n,r).then(function(e){if((e||r)&&i.isPrimaryClient){var n=e&&!e.fromCache;i.sharedClientState.updateQueryState(t.targetId,n?"current":"not-current")}if(e){a.push(e);var o=ko.Ki(t.targetId,e);u.push(o)}}))}),e.next=6,Promise.all(o);case 6:return i.Sa.h_(a),e.next=9,function(){var e=x(k().mark(function e(t,n){var r,i,a,u,o,s,c,l;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ee(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return Ue.forEach(n,function(t){return Ue.forEach(t.qi,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return Ue.forEach(t.Qi,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),je(e.t0)){e.next=10;break}throw e.t0;case 10:W("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=g(n);try{for(i.s();!(a=i.n()).done;)u=a.value,o=u.targetId,u.fromCache||(s=r.ns.get(o),c=s.snapshotVersion,l=s.withLastLimboFreeSnapshotVersion(c),r.ns=r.ns.insert(o,l))}catch(f){i.e(f)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t,n){return e.apply(this,arguments)}}()(i.localStore,u);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function hl(e,t){return dl.apply(this,arguments)}function dl(){return(dl=x(k().mark(function e(t,n){var r,i;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=ee(t)).currentUser.isEqual(n)){e.next=11;break}return W("SyncEngine","User change. New user:",n.toKey()),e.next=5,_o(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,function(e,t){e.Oa.forEach(function(e){e.forEach(function(e){e.reject(new ne(te.CANCELLED,t))})}),e.Oa.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=11,ll(r,i.us);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function vl(e,t){var n=ee(e),r=n.Fa.get(t);if(r&&r.wa)return Pr().add(r.key);var i=Pr(),a=n.Da.get(t);if(!a)return i;var u,o=g(a);try{for(o.s();!(u=o.n()).done;){var s=u.value,c=n.ba.get(s);i=i.unionWith(c.view.Ea)}}catch(l){o.e(l)}finally{o.f()}return i}function pl(e,t){return yl.apply(this,arguments)}function yl(){return(yl=x(k().mark(function e(t,n){var r,i,a;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ee(t),e.next=3,Lo(r.localStore,n.query,!0);case 3:return i=e.sent,a=n.view.pa(i),e.abrupt("return",(r.isPrimaryClient&&ol(r,n.targetId,a.fa),a));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ml(e,t){return gl.apply(this,arguments)}function gl(){return(gl=x(k().mark(function e(t,n){var r;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ee(t),e.abrupt("return",Ro(r.localStore,n).then(function(e){return ll(r,e)}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function kl(e,t,n,r){return wl.apply(this,arguments)}function wl(){return(wl=x(k().mark(function e(t,n,r,i){var a,u;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=ee(t),e.next=3,function(e,t){var n=ee(e),r=ee(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return r.vn(e,t).next(function(t){return t?n.localDocuments.getDocuments(e,t):Ue.resolve(null)})})}(a.localStore,n);case 3:if(null===(u=e.sent)){e.next=15;break}if("pending"!==r){e.next=10;break}return e.next=8,qs(a.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===r||"rejected"===r?(il(a,n,i||null),rl(a,n),function(e,t){ee(ee(e).mutationQueue).Mn(t)}(a.localStore,n)):X();case 11:return e.next=13,ll(a,u);case 13:e.next=16;break;case 15:W("SyncEngine","Cannot apply mutation batch with id: "+n);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function xl(e,t){return bl.apply(this,arguments)}function bl(){return(bl=x(k().mark(function e(t,n){var r,i,a,u,o,s,c,l;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Nl(r=ee(t)),Ml(r),!0!==n||!0===r.La){e.next=13;break}return i=r.sharedClientState.getAllActiveQueryTargets(),e.next=5,Il(r,i.toArray());case 5:return a=e.sent,r.La=!0,e.next=9,tc(r.remoteStore,!0);case 9:u=g(a);try{for(u.s();!(o=u.n()).done;)s=o.value,ws(r.remoteStore,s)}catch(f){u.e(f)}finally{u.f()}e.next=25;break;case 13:if(!1!==n||!1===r.La){e.next=25;break}return c=[],l=Promise.resolve(),r.Da.forEach(function(e,t){r.sharedClientState.isLocalQueryTarget(t)?c.push(t):l=l.then(function(){return al(r,t),Mo(r.localStore,t,!0)}),xs(r.remoteStore,t)}),e.next=19,l;case 19:return e.next=21,Il(r,c);case 21:return function(e){var t=ee(e);t.Fa.forEach(function(e,n){xs(t.remoteStore,n)}),t.Ma.mr(),t.Fa=new Map,t.va=new Ot(_e.comparator)}(r),r.La=!1,e.next=25,tc(r.remoteStore,!1);case 25:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Il(e,t,n){return _l.apply(this,arguments)}function _l(){return(_l=x(k().mark(function e(t,n,r){var i,a,u,o,s,c,l,f,h,d,v,p,y,m;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=ee(t),a=[],u=[],o=g(n),e.prev=2,o.s();case 4:if((s=o.n()).done){e.next=45;break}if(c=s.value,l=void 0,!(f=i.Da.get(c))||0===f.length){e.next=34;break}return e.next=11,No(i.localStore,hr(f[0]));case 11:l=e.sent,h=g(f),e.prev=13,h.s();case 15:if((d=h.n()).done){e.next=24;break}return v=d.value,p=i.ba.get(v),e.next=20,pl(i,p);case 20:(y=e.sent).snapshot&&u.push(y.snapshot);case 22:e.next=15;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(13),h.e(e.t0);case 29:return e.prev=29,h.f(),e.finish(29);case 32:e.next=42;break;case 34:return e.next=36,Po(i.localStore,c);case 36:return m=e.sent,e.next=39,No(i.localStore,m);case 39:return l=e.sent,e.next=42,Vc(i,El(m),c,!1,l.resumeToken);case 42:a.push(l);case 43:e.next=4;break;case 45:e.next=50;break;case 47:e.prev=47,e.t1=e.catch(2),o.e(e.t1);case 50:return e.prev=50,o.f(),e.finish(50);case 53:return e.abrupt("return",(i.Sa.h_(u),a));case 54:case"end":return e.stop()}},e,null,[[2,47,50,53],[13,26,29,32]])}))).apply(this,arguments)}function El(e){return or(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Tl(e){return function(e){return ee(ee(e).persistence).Bi()}(ee(e).localStore)}function Sl(e,t,n,r){return Cl.apply(this,arguments)}function Cl(){return(Cl=x(k().mark(function e(t,n,r,i){var a,u,o,s;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=ee(t)).La){e.next=3;break}return e.abrupt("return",void W("SyncEngine","Ignoring unexpected query state notification."));case 3:if(!((u=a.Da.get(n))&&u.length>0)){e.next=20;break}e.t0=r,e.next="current"===e.t0?8:"not-current"===e.t0?8:"rejected"===e.t0?15:19;break;case 8:return e.next=10,Ro(a.localStore,xr(u[0]));case 10:return o=e.sent,s=Fi.createSynthesizedRemoteEventForCurrentChange(n,"current"===r,jt.EMPTY_BYTE_STRING),e.next=14,ll(a,o,s);case 14:return e.abrupt("break",20);case 15:return e.next=17,Mo(a.localStore,n,!0);case 17:return al(a,n,i),e.abrupt("break",20);case 19:X();case 20:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Dl(e,t,n){return Al.apply(this,arguments)}function Al(){return(Al=x(k().mark(function e(t,n,r){var i,a,u,o,s,c,l,f,h;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=Nl(t)).La){e.next=45;break}a=g(n),e.prev=3,a.s();case 5:if((u=a.n()).done){e.next=21;break}if(o=u.value,!i.Da.has(o)||!i.sharedClientState.isActiveQueryTarget(o)){e.next=10;break}return W("SyncEngine","Adding an already active target "+o),e.abrupt("continue",19);case 10:return e.next=12,Po(i.localStore,o);case 12:return s=e.sent,e.next=15,No(i.localStore,s);case 15:return c=e.sent,e.next=18,Vc(i,El(s),c.targetId,!1,c.resumeToken);case 18:ws(i.remoteStore,c);case 19:e.next=5;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),a.e(e.t0);case 26:return e.prev=26,a.f(),e.finish(26);case 29:l=g(r),e.prev=30,h=k().mark(function e(){var t;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.value,e.t0=i.Da.has(t),!e.t0){e.next=5;break}return e.next=5,Mo(i.localStore,t,!1).then(function(){xs(i.remoteStore,t),al(i,t)}).catch(Ve);case 5:case"end":return e.stop()}},e)}),l.s();case 33:if((f=l.n()).done){e.next=37;break}return e.delegateYield(h(),"t1",35);case 35:e.next=33;break;case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(30),l.e(e.t2);case 42:return e.prev=42,l.f(),e.finish(42);case 45:case"end":return e.stop()}},e,null,[[3,23,26,29],[30,39,42,45]])}))).apply(this,arguments)}function Nl(e){var t=ee(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=jc.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=vl.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Jc.bind(null,t),t.Sa.h_=gc.bind(null,t.eventManager),t.Sa.ka=kc.bind(null,t.eventManager),t}function Ml(e){var t=ee(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Xc.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=$c.bind(null,t),t}function Fl(e,t,n){var r=ee(e);(function(){var e=x(k().mark(function e(t,n,r){var i,a,u,o,s;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getMetadata();case 3:return i=e.sent,e.next=6,function(e,t){var n=ee(e),r=Yi(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",function(e){return n.$r.getBundleMetadata(e,t.id)}).then(function(e){return!!e&&e.createTime.compareTo(r)>=0})}(t.localStore,i);case 6:if(!e.sent){e.next=11;break}return e.next=9,n.close();case 9:return r._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(i)),e.abrupt("return",Promise.resolve(new Set));case 11:return r._updateProgress(Ec(i)),a=new _c(i,t.localStore,n.serializer),e.next=15,n.qa();case 15:u=e.sent;case 16:if(!u){e.next=26;break}return e.next=19,a._a(u);case 19:return(o=e.sent)&&r._updateProgress(o),e.next=23,n.qa();case 23:u=e.sent;case 24:e.next=16;break;case 26:return e.next=28,a.complete();case 28:return s=e.sent,e.next=31,ll(t,s.ca,void 0);case 31:return e.next=33,function(e,t){var n=ee(e);return n.persistence.runTransaction("Save bundle","readwrite",function(e){return n.$r.saveBundleMetadata(e,t)})}(t.localStore,i);case 33:return r._completeWith(s.progress),e.abrupt("return",Promise.resolve(s.ua));case 37:return e.prev=37,e.t0=e.catch(0),e.abrupt("return",(J("SyncEngine","Loading bundle failed with ".concat(e.t0)),r._failWith(e.t0),Promise.resolve(new Set)));case 40:case"end":return e.stop()}},e,null,[[0,37]])}));return function(t,n,r){return e.apply(this,arguments)}})()(r,t,n).then(function(e){r.sharedClientState.notifyBundleLoaded(e)})}var Ll=function(){return V(function e(){R(this,e),this.synchronizeTabs=!1},[{key:"initialize",value:function(){var e=x(k().mark(function e(t){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.serializer=ss(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),e.next=5,this.persistence.start();case 5:this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createGarbageCollectionScheduler",value:function(e,t){return null}},{key:"createIndexBackfillerScheduler",value:function(e,t){return null}},{key:"createLocalStore",value:function(e){return Io(this.persistence,new xo,e.initialUser,this.serializer)}},{key:"createPersistence",value:function(e){return new oo(co.Hr,this.serializer)}},{key:"createSharedClientState",value:function(e){return new Xo}},{key:"terminate",value:function(){var e=x(k().mark(function e(){var t,n;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(n=this.indexBackfillerScheduler)||void 0===n||n.stop(),this.sharedClientState.shutdown(),e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}])}(),Pl=function(e){function t(e){var n;return R(this,t),(n=b(this,t)).cacheSizeBytes=e,n}return S(t,Ll),V(t,[{key:"createGarbageCollectionScheduler",value:function(e,t){Z(this.persistence.referenceDelegate instanceof lo);var n=this.persistence.referenceDelegate.garbageCollector;return new Ou(n,e.asyncQueue,t)}},{key:"createPersistence",value:function(e){var t=void 0!==this.cacheSizeBytes?bu.withCacheSize(this.cacheSizeBytes):bu.DEFAULT;return new oo(function(e){return lo.Hr(e,t)},this.serializer)}}])}(),Rl=function(e){function t(e,n,r){var i;return R(this,t),(i=b(this,t)).Qa=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return S(t,Ll),V(t,[{key:"initialize",value:function(){var e=x(k().mark(function e(n){var r=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(T(t.prototype),"initialize",this).call(this,n);case 2:return e.next=4,this.Qa.initialize(this,n);case 4:return e.next=6,Ml(this.Qa.syncEngine);case 6:return e.next=8,qs(this.Qa.remoteStore);case 8:return e.next=10,this.persistence.fi(function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()});case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createLocalStore",value:function(e){return Io(this.persistence,new xo,e.initialUser,this.serializer)}},{key:"createGarbageCollectionScheduler",value:function(e,t){var n=this.persistence.referenceDelegate.garbageCollector;return new Ou(n,e.asyncQueue,t)}},{key:"createIndexBackfillerScheduler",value:function(e,t){var n=new Ze(t,this.persistence);return new Xe(e.asyncQueue,n)}},{key:"createPersistence",value:function(e){var t=go(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?bu.withCacheSize(this.cacheSizeBytes):bu.DEFAULT;return new po(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,us(),os(),this.serializer,this.sharedClientState,!!this.forceOwnership)}},{key:"createSharedClientState",value:function(e){return new Xo}}])}(),Ol=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t,[e,n,!1])).Qa=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return S(t,Rl),V(t,[{key:"initialize",value:function(){var e=x(k().mark(function e(n){var r,i=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(T(t.prototype),"initialize",this).call(this,n);case 2:if(r=this.Qa.syncEngine,e.t0=this.sharedClientState instanceof Yo,!e.t0){e.next=8;break}return this.sharedClientState.syncEngine={Zs:kl.bind(null,r),Xs:Sl.bind(null,r),eo:Dl.bind(null,r),Bi:Tl.bind(null,r),Ys:ml.bind(null,r)},e.next=8,this.sharedClientState.start();case 8:return e.next=10,this.persistence.fi(function(){var e=x(k().mark(function e(t){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xl(i.Qa.syncEngine,t);case 2:i.gcScheduler&&(t&&!i.gcScheduler.started?i.gcScheduler.start():t||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(t&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():t||i.indexBackfillerScheduler.stop());case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createSharedClientState",value:function(e){var t=us();if(!Yo.D(t))throw new ne(te.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=go(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Yo(t,e.asyncQueue,n,e.clientId,e.initialUser)}}])}(),Vl=function(){return V(function e(){R(this,e)},[{key:"initialize",value:function(){var e=x(k().mark(function e(t,n){var r=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return Hc(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=hl.bind(null,this.syncEngine),e.next=12,tc(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new dc}},{key:"createDatastore",value:function(e){var t=ss(e.databaseInfo.databaseId),n=function(e){return new as(e)}(e.databaseInfo);return function(e,t,n,r){return new ds(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}},{key:"createRemoteStore",value:function(e){var t=this;return function(e,t,n,r,i){return new ps(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,function(e){return Hc(t.syncEngine,e,0)},$o.D()?new $o:new Zo)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,i,a,u){var o=new Nc(e,t,n,r,i,a);return u&&(o.La=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){var e=x(k().mark(function e(){var t;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,function(){var e=x(k().mark(function e(t){var n;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=ee(t),W("RemoteStore","RemoteStore shutting down."),n.M_.add(5),e.next=5,gs(n);case 5:n.O_.shutdown(),n.N_.set("Unknown");case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(this.remoteStore);case 2:null===(t=this.datastore)||void 0===t||t.terminate();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}])}();function ql(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{read:function(){return x(k().mark(function r(){var i;return k().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n<e.byteLength)){r.next=3;break}return i={value:e.slice(n,n+t),done:!1},r.abrupt("return",(n+=t,i));case 3:return r.abrupt("return",{done:!0});case 4:case"end":return r.stop()}},r)}))()},cancel:function(){return x(k().mark(function e(){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()},releaseLock:function(){},closed:Promise.resolve()}}var Ul=function(){return V(function e(t){R(this,e),this.observer=t,this.muted=!1},[{key:"next",value:function(e){this.observer.next&&this.Ka(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Ka(this.observer.error,e):H("Uncaught Error in snapshot listener:",e.toString())}},{key:"$a",value:function(){this.muted=!0}},{key:"Ka",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}])}(),Bl=function(){return V(function e(t,n){var r=this;R(this,e),this.Ua=t,this.serializer=n,this.metadata=new re,this.buffer=new Uint8Array,this.Wa=new TextDecoder("utf-8"),this.Ga().then(function(e){e&&e.sa()?r.metadata.resolve(e.ia.metadata):r.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.ia))))},function(e){return r.metadata.reject(e)})},[{key:"close",value:function(){return this.Ua.cancel()}},{key:"getMetadata",value:function(){var e=x(k().mark(function e(){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.metadata.promise);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"qa",value:function(){var e=x(k().mark(function e(){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadata();case 2:return e.abrupt("return",this.Ga());case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"Ga",value:function(){var e=x(k().mark(function e(){var t,n,r,i;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.za();case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return n=this.Wa.decode(t),r=Number(n),isNaN(r)&&this.ja("length string (".concat(n,") is not valid number")),e.next=9,this.Ha(r);case 9:return i=e.sent,e.abrupt("return",new bc(JSON.parse(i),t.length+r));case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"Ja",value:function(){return this.buffer.findIndex(function(e){return e==="{".charCodeAt(0)})}},{key:"za",value:function(){var e=x(k().mark(function e(){var t,n;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.Ja()<0)){e.next=7;break}return e.next=3,this.Ya();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==this.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(t=this.Ja())<0&&this.ja("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,t),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"Ha",value:function(){var e=x(k().mark(function e(t){var n;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buffer.length<t)){e.next=8;break}return e.next=3,this.Ya();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.ja("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return n=this.Wa.decode(this.buffer.slice(0,t)),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"ja",value:function(e){throw this.Ua.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"Ya",value:function(){var e=x(k().mark(function e(){var t,n;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Ua.read();case 2:return(t=e.sent).done||((n=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),n.set(t.value,this.buffer.length),this.buffer=n),e.abrupt("return",t.done);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}])}(),zl=function(){return V(function e(t){R(this,e),this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set},[{key:"lookup",value:function(){var e=x(k().mark(function e(t){var n,r=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!(this.mutations.length>0)){e.next=2;break}throw this.lastTransactionError=new ne(te.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;case 2:return e.next=4,function(){var e=x(k().mark(function e(t,n){var r,i,a,u,o;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ee(t),i={documents:n.map(function(e){return ea(r.serializer,e)})},e.next=4,r.xo("BatchGetDocuments",r.serializer.databaseId,xe.emptyPath(),i,n.length);case 4:return a=e.sent,u=new Map,a.forEach(function(e){var t=sa(r.serializer,e);u.set(t.key.toString(),t)}),o=[],e.abrupt("return",(n.forEach(function(e){var t=u.get(e.toString());Z(!!t),o.push(t)}),o));case 9:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,t);case 4:return n=e.sent,e.abrupt("return",(n.forEach(function(e){return r.recordVersion(e)}),n));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new mi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var e=x(k().mark(function e(){var t,n=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!this.lastTransactionError){e.next=2;break}throw this.lastTransactionError;case 2:return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(e,t){var r=_e.fromPath(t);n.mutations.push(new gi(r,n.precondition(r)))}),e.next=7,function(){var e=x(k().mark(function e(t,n){var r,i;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ee(t),i={writes:n.map(function(e){return la(r.serializer,e)})},e.next=3,r.Co("Commit",r.serializer.databaseId,xe.emptyPath(),i);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,this.mutations);case 7:this.committed=!0;case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw X();t=ke.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new ne(te.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ke.min())?ni.exists(!1):ni.updateTime(t):ni.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ke.min()))throw new ne(te.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ni.updateTime(t)}return ni.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}])}(),Gl=function(){return V(function e(t,n,r,i,a){R(this,e),this.asyncQueue=t,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=a,this.Za=r.maxAttempts,this.Yo=new cs(this.asyncQueue,"transaction_retry")},[{key:"Xa",value:function(){this.Za-=1,this.eu()}},{key:"eu",value:function(){var e=this;this.Yo.$o(x(k().mark(function t(){var n,r;return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=new zl(e.datastore),(r=e.tu(n))&&r.then(function(t){e.asyncQueue.enqueueAndForget(function(){return n.commit().then(function(){e.deferred.resolve(t)}).catch(function(t){e.nu(t)})})}).catch(function(t){e.nu(t)});case 2:case"end":return t.stop()}},t)})))}},{key:"tu",value:function(e){try{var t=this.updateFunction(e);return!et(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"nu",value:function(e){var t=this;this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(function(){return t.eu(),Promise.resolve()})):this.deferred.reject(e)}},{key:"ru",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!_i(t)}return!1}}])}(),Kl=function(){return V(function e(t,n,r,i){var a=this;R(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=z.UNAUTHENTICATED,this.clientId=ve.newId(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,(u=x(k().mark(function e(t){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return W("FirestoreClient","Received user=",t.uid),e.next=3,a.authCredentialListener(t);case 3:a.user=t;case 4:case"end":return e.stop()}},e)})),function(e){return u.apply(this,arguments)})),this.appCheckCredentials.start(r,function(e){return W("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)});var u},[{key:"configuration",get:function(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new ne(te.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new re;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(x(k().mark(function n(){var r;return k().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e._onlineComponents,!n.t0){n.next=5;break}return n.next=5,e._onlineComponents.terminate();case 5:if(n.t1=e._offlineComponents,!n.t1){n.next=9;break}return n.next=9,e._offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=uc(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}])}();function Ql(e,t){return jl.apply(this,arguments)}function jl(){return(jl=x(k().mark(function e(t,n){var r,i;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),W("FirestoreClient","Initializing OfflineComponentProvider"),r=t.configuration,e.next=4,n.initialize(r);case 4:i=r.initialUser,t.setCredentialChangeListener(function(){var e=x(k().mark(function e(t){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,_o(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t._offlineComponents=n;case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Wl(e,t){return Hl.apply(this,arguments)}function Hl(){return(Hl=x(k().mark(function e(t,n){var r;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,Yl(t);case 3:return r=e.sent,W("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,n.initialize(r,t.configuration);case 7:t.setCredentialChangeListener(function(e){return $s(n.remoteStore,e)}),t.setAppCheckTokenChangeListener(function(e,t){return $s(n.remoteStore,t)}),t._onlineComponents=n;case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Jl(e){return"FirebaseError"===e.name?e.code===te.FAILED_PRECONDITION||e.code===te.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}function Yl(e){return Xl.apply(this,arguments)}function Xl(){return(Xl=x(k().mark(function e(t){var n;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._offlineComponents){e.next=21;break}if(!t._uninitializedComponentsProvider){e.next=18;break}return W("FirestoreClient","Using user provided OfflineComponentProvider"),e.prev=3,e.next=6,Ql(t,t._uninitializedComponentsProvider._offline);case 6:e.next=16;break;case 8:if(e.prev=8,e.t0=e.catch(3),Jl(n=e.t0)){e.next=13;break}throw n;case 13:return J("Error using user provided cache. Falling back to memory cache: "+n),e.next=16,Ql(t,new Ll);case 16:e.next=21;break;case 18:return W("FirestoreClient","Using default OfflineComponentProvider"),e.next=21,Ql(t,new Ll);case 21:return e.abrupt("return",t._offlineComponents);case 22:case"end":return e.stop()}},e,null,[[3,8]])}))).apply(this,arguments)}function Zl(e){return $l.apply(this,arguments)}function $l(){return($l=x(k().mark(function e(t){return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t._onlineComponents,e.t0){e.next=11;break}if(!t._uninitializedComponentsProvider){e.next=8;break}return W("FirestoreClient","Using user provided OnlineComponentProvider"),e.next=6,Wl(t,t._uninitializedComponentsProvider._online);case 6:e.next=11;break;case 8:return W("FirestoreClient","Using default OnlineComponentProvider"),e.next=11,Wl(t,new Vl);case 11:return e.abrupt("return",t._onlineComponents);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ef(e){return Yl(e).then(function(e){return e.persistence})}function tf(e){return Yl(e).then(function(e){return e.localStore})}function nf(e){return Zl(e).then(function(e){return e.remoteStore})}function rf(e){return Zl(e).then(function(e){return e.syncEngine})}function af(e){return Zl(e).then(function(e){return e.datastore})}function uf(e){return of.apply(this,arguments)}function of(){return(of=x(k().mark(function e(t){var n,r;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Zl(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=Mc.bind(null,n.syncEngine),r.onUnlisten=Uc.bind(null,n.syncEngine),r.onFirstRemoteStoreListen=Lc.bind(null,n.syncEngine),r.onLastRemoteStoreUnlisten=zc.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function sf(e){return e.asyncQueue.enqueue(x(k().mark(function t(){var n,r;return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ef(e);case 2:return n=t.sent,t.next=5,nf(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!0),function(e){var t=ee(e);return t.M_.delete(0),ys(t)}(r)));case 7:case"end":return t.stop()}},t)})))}function cf(e){return e.asyncQueue.enqueue(x(k().mark(function t(){var n,r;return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ef(e);case 2:return n=t.sent,t.next=5,nf(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!1),function(){var e=x(k().mark(function e(t){var n;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=ee(t)).M_.add(0),e.next=4,gs(n);case 4:n.N_.set("Offline");case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(r)));case 7:case"end":return t.stop()}},t)})))}function lf(e,t){var n=new re;return e.asyncQueue.enqueueAndForget(x(k().mark(function r(){return k().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=x(k().mark(function e(t,n,r){var i,a;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=ee(e);return n.persistence.runTransaction("read document","readonly",function(e){return n.localDocuments.getDocument(e,t)})}(t,n);case 3:(i=e.sent).isFoundDocument()?r.resolve(i):i.isNoDocument()?r.resolve(null):r.reject(new ne(te.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),a=uc(e.t0,"Failed to get document '".concat(n," from cache")),r.reject(a);case 11:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,tf(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}},r)}))),n.promise}function ff(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new re;return e.asyncQueue.enqueueAndForget(x(k().mark(function i(){return k().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new Ul({next:function(a){t.enqueueAndForget(function(){return yc(e,u)});var o=a.docs.has(n);!o&&a.fromCache?i.reject(new ne(te.UNAVAILABLE,"Failed to get document because the client is offline.")):o&&a.fromCache&&r&&"server"===r.source?i.reject(new ne(te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),u=new xc(sr(n.path),a,{includeMetadataChanges:!0,ra:!0});return vc(e,u)},i.next=3,uf(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}function hf(e,t){var n=new re;return e.asyncQueue.enqueueAndForget(x(k().mark(function r(){return k().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=x(k().mark(function e(t,n,r){var i,a,u,o,s;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Lo(t,n,!0);case 3:i=e.sent,a=new Cc(n,i.hs),u=a.da(i.documents),o=a.applyChanges(u,!1),r.resolve(o.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),s=uc(e.t0,"Failed to execute query '".concat(n," against cache")),r.reject(s);case 14:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,tf(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}},r)}))),n.promise}function df(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new re;return e.asyncQueue.enqueueAndForget(x(k().mark(function i(){return k().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new Ul({next:function(n){t.enqueueAndForget(function(){return yc(e,u)}),n.fromCache&&"server"===r.source?i.reject(new ne(te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),u=new xc(n,a,{includeMetadataChanges:!0,ra:!0});return vc(e,u)},i.next=3,uf(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}function vf(e,t,n){var r=new re;return e.asyncQueue.enqueueAndForget(x(k().mark(function i(){var a;return k().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,af(e);case 3:a=i.sent,r.resolve(function(){var e=x(k().mark(function e(t,n,r){var i,a,u,o,s,c,l,f;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=ee(t),u=pa(a.serializer,dr(n),r),o=u.request,s=u.ut,c=u.parent,a.connection.Do||delete o.parent,e.next=4,a.xo("RunAggregationQuery",a.serializer.databaseId,c,o,1);case 4:return Z(1===(l=e.sent.filter(function(e){return!!e.result})).length),f=null===(i=l[0].result)||void 0===i?void 0:i.aggregateFields,e.abrupt("return",Object.keys(f).reduce(function(e,t){return e[s[t]]=f[t],e},{}));case 8:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()(a,t,n)),i.next=10;break;case 7:i.prev=7,i.t0=i.catch(0),r.reject(i.t0);case 10:case"end":return i.stop()}},i,null,[[0,7]])}))),r.promise}function pf(e,t){var n=new Ul(t);return e.asyncQueue.enqueueAndForget(x(k().mark(function t(){return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){ee(e).z_.add(t),t.next()},t.next=3,uf(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){n.$a(),e.asyncQueue.enqueueAndForget(x(k().mark(function t(){return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){ee(e).z_.delete(t)},t.next=3,uf(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}function yf(e,t,n,r){var i=function(e,t){return function(e,t){return new Bl(e,t)}(function(e,t){if(e instanceof Uint8Array)return ql(e,t);if(e instanceof ArrayBuffer)return ql(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?Si().encode(e):e),t)}(n,ss(t));e.asyncQueue.enqueueAndForget(x(k().mark(function t(){return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Fl,t.next=3,rf(e);case 3:t.t1=t.sent,t.t2=i,t.t3=r,(0,t.t0)(t.t1,t.t2,t.t3);case 7:case"end":return t.stop()}},t)})))}function mf(e,t){return e.asyncQueue.enqueue(x(k().mark(function n(){return k().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=function(e,t){var n=ee(e);return n.persistence.runTransaction("Get named query","readonly",function(e){return n.$r.getNamedQuery(e,t)})},n.next=3,tf(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}},n)})))}function gf(e,t){return e.asyncQueue.enqueue(x(k().mark(function n(){return k().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=function(){var e=x(k().mark(function e(t,n){var r,i,a;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ee(t),i=r.indexManager,a=[],e.abrupt("return",r.persistence.runTransaction("Configure indexes","readwrite",function(e){return i.getFieldIndexes(e).next(function(t){return function(e,t,n,r,i){e=D(e),t=D(t),e.sort(n),t.sort(n);for(var a=e.length,u=t.length,o=0,s=0;o<u&&s<a;){var c=n(e[s],t[o]);c<0?i(e[s++]):c>0?r(t[o++]):(o++,s++)}for(;o<u;)r(t[o++]);for(;s<a;)i(e[s++])}(t,n,Ce,function(t){a.push(i.addFieldIndex(e,t))},function(t){a.push(i.deleteFieldIndex(e,t))})}).next(function(){return Ue.waitFor(a)})}));case 2:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n.next=3,tf(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}},n)})))}function kf(e,t){return e.asyncQueue.enqueue(x(k().mark(function n(){return k().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=function(e,t){ee(e).ts.Ui=t},n.next=3,tf(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}},n)})))}function wf(e){return e.asyncQueue.enqueue(x(k().mark(function t(){return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e){var t=ee(e),n=t.indexManager;return t.persistence.runTransaction("Delete All Indexes","readwrite",function(e){return n.deleteAllFieldIndexes(e)})},t.next=3,tf(e);case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 5:case"end":return t.stop()}},t)})))}function xf(e){var t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}var bf=new Map;function If(e,t,n){if(!n)throw new ne(te.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function _f(e,t,n,r){if(!0===t&&!0===r)throw new ne(te.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function Ef(e){if(!_e.isDocumentKey(e))throw new ne(te.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Tf(e){if(_e.isDocumentKey(e))throw new ne(te.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Sf(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==P(e)){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":X()}function Cf(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ne(te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Sf(e);throw new ne(te.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function Df(e,t){if(t<=0)throw new ne(te.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}var Af=function(){return V(function e(t){var n,r;if(R(this,e),void 0===t.host){if(void 0!==t.ssl)throw new ne(te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ne(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}_f("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=xf(null!==(r=t.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new ne(te.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new ne(te.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new ne(te.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams},[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}])}(),Nf=function(){return V(function e(t,n,r,i){R(this,e),this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Af({}),this._settingsFrozen=!1},[{key:"app",get:function(){if(!this._app)throw new ne(te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new ne(te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Af(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new ae;switch(e.type){case"firstParty":return new ce(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new ne(te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=bf.get(e))&&(W("ComponentProvider","Removing Datastore"),bf.delete(e),t.terminate()),Promise.resolve();var e,t}}])}();function Mf(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=Cf(e,Nf))._getSettings(),o="".concat(t,":").concat(n);if("firestore.googleapis.com"!==a.host&&a.host!==o&&J("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:o,ssl:!1})),i.mockUserToken){var s,c;if("string"==typeof i.mockUserToken)s=i.mockUserToken,c=z.MOCK_USER;else{s=(0,u.createMockUserToken)(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var l=i.mockUserToken.sub||i.mockUserToken.user_id;if(!l)throw new ne(te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new z(l)}e._authCredentials=new ue(new ie(s,c))}}var Ff=exports.Query=function(){function e(t,n,r){R(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return V(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}])}(),Lf=exports.DocumentReference=function(){function e(t,n,r){R(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return V(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new Pf(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}])}(),Pf=exports.CollectionReference=function(e){function t(e,n,r){var i;return R(this,t),(i=b(this,t,[e,n,sr(r)]))._path=r,i.type="collection",i}return S(t,Ff),V(t,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new Lf(this.firestore,null,new _e(e))}},{key:"withConverter",value:function(e){return new t(this.firestore,e,this._path)}}])}();function Rf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,u.getModularInstance)(e),If("collection","path",t),e instanceof Nf){var a=xe.fromString.apply(xe,[t].concat(r));return Tf(a),new Pf(e,null,a)}if(!(e instanceof Lf||e instanceof Pf))throw new ne(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(xe.fromString.apply(xe,[t].concat(r)));return Tf(o),new Pf(e.firestore,null,o)}function Of(e,t){if(e=Cf(e,Nf),If("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new ne(te.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new Ff(e,null,function(e){return new ur(xe.emptyPath(),e)}(t))}function Vf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,u.getModularInstance)(e),1===arguments.length&&(t=ve.newId()),If("doc","path",t),e instanceof Nf){var a=xe.fromString.apply(xe,[t].concat(r));return Ef(a),new Lf(e,null,new _e(a))}if(!(e instanceof Lf||e instanceof Pf))throw new ne(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(xe.fromString.apply(xe,[t].concat(r)));return Ef(o),new Lf(e.firestore,e instanceof Pf?e.converter:null,new _e(o))}function qf(e,t){return e=(0,u.getModularInstance)(e),t=(0,u.getModularInstance)(t),(e instanceof Lf||e instanceof Pf)&&(t instanceof Lf||t instanceof Pf)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function Uf(e,t){return e=(0,u.getModularInstance)(e),t=(0,u.getModularInstance)(t),e instanceof Ff&&t instanceof Ff&&e.firestore===t.firestore&&mr(e._query,t._query)&&e.converter===t.converter}var Bf=function(){return V(function e(){var t=this;R(this,e),this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new cs(this,"async_queue_retry"),this.hu=function(){var e=os();e&&W("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Yo.Wo()};var n=os();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.hu)},[{key:"isShuttingDown",get:function(){return this.ou}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Pu(),this.Iu(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.ou){this.ou=!0,this.cu=e||!1;var t=os();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.hu)}}},{key:"enqueue",value:function(e){var t=this;if(this.Pu(),this.ou)return new Promise(function(){});var n=new re;return this.Iu(function(){return t.ou&&t.cu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.su.push(e),t.Tu()})}},{key:"Tu",value:function(){var e=x(k().mark(function e(){var t=this;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.su.length){e.next=14;break}return e.prev=1,e.next=4,this.su[0]();case 4:this.su.shift(),this.Yo.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),je(e.t0)){e.next=12;break}throw e.t0;case 12:W("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.su.length>0&&this.Yo.$o(function(){return t.Tu()});case 14:case"end":return e.stop()}},e,this,[[1,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"Iu",value:function(e){var t=this,n=this.iu.then(function(){return t.uu=!0,e().catch(function(e){throw t.au=e,t.uu=!1,H("INTERNAL UNHANDLED ERROR: ",function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(function(e){return t.uu=!1,e})});return this.iu=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Pu(),this.lu.indexOf(e)>-1&&(t=0);var i=ac.createAndSchedule(this,e,t,n,function(e){return r.Eu(e)});return this._u.push(i),i}},{key:"Pu",value:function(){this.au&&X()}},{key:"verifyOperationInProgress",value:function(){}},{key:"du",value:function(){var e=x(k().mark(function e(){var t;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.iu,e.next=3,t;case 3:if(t!==this.iu){e.next=0;break}case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"Au",value:function(e){var t,n=g(this._u);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Ru",value:function(e){var t=this;return this.du().then(function(){t._u.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=g(t._u);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.du()})}},{key:"Vu",value:function(e){this.lu.push(e)}},{key:"Eu",value:function(e){var t=this._u.indexOf(e);this._u.splice(t,1)}}])}();function zf(e){return function(e,t){if("object"!=P(e)||null===e)return!1;var n,r=e,i=g(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"==typeof r[a])return!0}}catch(u){i.e(u)}finally{i.f()}return!1}(e,["next","error","complete"])}var Gf=exports.LoadBundleTask=function(){return V(function e(){R(this,e),this._progressObserver={},this._taskCompletionResolver=new re,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}},[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}])}(),Kf=exports.CACHE_SIZE_UNLIMITED=-1,Qf=exports.Firestore=function(e){function t(e,n,r,i){var a;return R(this,t),(a=b(this,t,[e,n,r,i])).type="firestore",a._queue=new Bf,a._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]",a}return S(t,Nf),V(t,[{key:"_terminate",value:function(){return this._firestoreClient||Jf(this),this._firestoreClient.terminate()}}])}();function jf(e,t,n){n||(n="(default)");var i=(0,r._getProvider)(e,"firestore");if(i.isInitialized(n)){var a=i.getImmediate({identifier:n}),o=i.getOptions(n);if((0,u.deepEqual)(o,t))return a;throw new ne(te.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&void 0!==t.localCache)throw new ne(te.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ne(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return i.initialize({options:t,instanceIdentifier:n})}function Wf(e,t){var n="object"==P(e)?e:(0,r.getApp)(),i="string"==typeof e?e:t||"(default)",a=(0,r._getProvider)(n,"firestore").getImmediate({identifier:i});if(!a._initialized){var o=(0,u.getDefaultEmulatorHostnameAndPort)("firestore");o&&Mf.apply(void 0,[a].concat(D(o)))}return a}function Hf(e){return e._firestoreClient||Jf(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Jf(e){var t,n,r,i=e._freezeSettings(),a=function(e,t,n,r){return new en(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,xf(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new Kl(e._authCredentials,e._appCheckCredentials,e._queue,a),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Yf(e,t){uh(e=Cf(e,Qf));var n=Hf(e);if(n._uninitializedComponentsProvider)throw new ne(te.FAILED_PRECONDITION,"SDK cache is already specified.");J("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");var r=e._freezeSettings(),i=new Vl;return Zf(n,i,new Rl(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}function Xf(e){uh(e=Cf(e,Qf));var t=Hf(e);if(t._uninitializedComponentsProvider)throw new ne(te.FAILED_PRECONDITION,"SDK cache is already specified.");J("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");var n=e._freezeSettings(),r=new Vl;return Zf(t,r,new Ol(r,n.cacheSizeBytes))}function Zf(e,t,n){var r=new re;return e.asyncQueue.enqueue(x(k().mark(function i(){var a;return k().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Ql(e,n);case 3:return i.next=5,Wl(e,t);case 5:r.resolve(),i.next=14;break;case 8:if(i.prev=8,i.t0=i.catch(0),Jl(a=i.t0)){i.next=13;break}throw a;case 13:J("Error enabling indexeddb cache. Falling back to memory cache: "+a),r.reject(a);case 14:case"end":return i.stop()}},i,null,[[0,8]])}))).then(function(){return r.promise})}function $f(e){if(e._initialized&&!e._terminated)throw new ne(te.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var t=new re;return e._queue.enqueueAndForgetEvenWhileRestricted(x(k().mark(function n(){return k().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,function(){var e=x(k().mark(function e(t){var n;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ze.D()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=t+"main",e.next=5,ze.delete(n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(go(e._databaseId,e._persistenceKey));case 3:t.resolve(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),t.reject(n.t0);case 9:case"end":return n.stop()}},n,null,[[0,6]])}))),t.promise}function eh(e){return function(e){var t=new re;return e.asyncQueue.enqueueAndForget(x(k().mark(function n(){return k().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=tl,n.next=3,rf(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}},n)}))),t.promise}(Hf(e=Cf(e,Qf)))}function th(e){return sf(Hf(e=Cf(e,Qf)))}function nh(e){return cf(Hf(e=Cf(e,Qf)))}function rh(e){return(0,r._removeServiceInstance)(e.app,"firestore",e._databaseId.database),e._delete()}function ih(e,t){var n=Hf(e=Cf(e,Qf)),r=new Gf;return yf(n,e._databaseId,t,r),r}function ah(e,t){return mf(Hf(e=Cf(e,Qf)),t).then(function(t){return t?new Ff(e,null,t.query):null})}function uh(e){if(e._initialized||e._terminated)throw new ne(te.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var oh=exports.AggregateField=V(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"count",n=arguments.length>1?arguments[1]:void 0;R(this,e),this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=t}),sh=exports.AggregateQuerySnapshot=function(){return V(function e(t,n,r){R(this,e),this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=t},[{key:"data",value:function(){return this._userDataWriter.convertObjectMap(this._data)}}])}(),ch=exports.Bytes=function(){function e(t){R(this,e),this._byteString=t}return V(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(jt.fromBase64String(t))}catch(t){throw new ne(te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(jt.fromUint8Array(t))}}])}(),lh=exports.FieldPath=function(){return V(function e(){R(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new ne(te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ie(n)},[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}])}();function fh(){return new lh("__name__")}var hh=exports.FieldValue=V(function e(t){R(this,e),this._methodName=t}),dh=exports.GeoPoint=function(){return V(function e(t,n){if(R(this,e),!isFinite(t)||t<-90||t>90)throw new ne(te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new ne(te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n},[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return pe(this._lat,e._lat)||pe(this._long,e._long)}}])}(),vh=/^__.*__$/,ph=function(){return V(function e(t,n,r){R(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r},[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new fi(e,this.data,this.fieldMask,t,this.fieldTransforms):new li(e,this.data,t,this.fieldTransforms)}}])}(),yh=function(){return V(function e(t,n,r){R(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r},[{key:"toMutation",value:function(e,t){return new fi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}])}();function mh(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw X()}}var gh=function(){function e(t,n,r,i,a,u){R(this,e),this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===a&&this.mu(),this.fieldTransforms=a||[],this.fieldMask=u||[]}return V(e,[{key:"path",get:function(){return this.settings.path}},{key:"fu",get:function(){return this.settings.fu}},{key:"gu",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"pu",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.gu({path:n,yu:!1});return r.wu(e),r}},{key:"Su",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.gu({path:n,yu:!1});return r.mu(),r}},{key:"bu",value:function(e){return this.gu({path:void 0,yu:!0})}},{key:"Du",value:function(e){return Vh(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"mu",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.wu(this.path.get(e))}},{key:"wu",value:function(e){if(0===e.length)throw this.Du("Document fields must not be empty");if(mh(this.fu)&&vh.test(e))throw this.Du('Document fields cannot begin and end with "__"')}}])}(),kh=function(){return V(function e(t,n,r){R(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||ss(t)},[{key:"Fu",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new gh({fu:e,methodName:t,vu:n,path:Ie.emptyPath(),yu:!1,Cu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}])}();function wh(e){var t=e._freezeSettings(),n=ss(e._databaseId);return new kh(e._databaseId,!!t.ignoreUndefinedProperties,n)}function xh(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},u=e.Fu(a.merge||a.mergeFields?2:0,t,n,i);Lh("Data must be an object, but it was:",u,r);var o,s,c=Mh(r,u);if(a.merge)o=new Gt(u.fieldMask),s=u.fieldTransforms;else if(a.mergeFields){var l,f=[],h=g(a.mergeFields);try{for(h.s();!(l=h.n()).done;){var d=Ph(t,l.value,n);if(!u.contains(d))throw new ne(te.INVALID_ARGUMENT,"Field '".concat(d,"' is specified in your field mask but missing from your input data."));qh(f,d)||f.push(d)}}catch(v){h.e(v)}finally{h.f()}o=new Gt(f),s=u.fieldTransforms.filter(function(e){return o.covers(e.field)})}else o=null,s=u.fieldTransforms;return new ph(new En(c),o,s)}var bh=function(e){function t(){return R(this,t),b(this,t,arguments)}return S(t,hh),V(t,[{key:"_toFieldTransform",value:function(e){if(2!==e.fu)throw 1===e.fu?e.Du("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Du("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof t}}])}();function Ih(e,t,n){return new gh({fu:3,vu:t.settings.vu,methodName:e._methodName,yu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}var _h=function(e){function t(){return R(this,t),b(this,t,arguments)}return S(t,hh),V(t,[{key:"_toFieldTransform",value:function(e){return new $r(e.path,new Qr)}},{key:"isEqual",value:function(e){return e instanceof t}}])}(),Eh=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t,[e])).Mu=n,r}return S(t,hh),V(t,[{key:"_toFieldTransform",value:function(e){var t=Ih(this,e,!0),n=this.Mu.map(function(e){return Nh(e,t)}),r=new jr(n);return new $r(e.path,r)}},{key:"isEqual",value:function(e){return e instanceof t&&(0,u.deepEqual)(this.Mu,e.Mu)}}])}(),Th=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t,[e])).Mu=n,r}return S(t,hh),V(t,[{key:"_toFieldTransform",value:function(e){var t=Ih(this,e,!0),n=this.Mu.map(function(e){return Nh(e,t)}),r=new Hr(n);return new $r(e.path,r)}},{key:"isEqual",value:function(e){return e instanceof t&&(0,u.deepEqual)(this.Mu,e.Mu)}}])}(),Sh=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t,[e])).xu=n,r}return S(t,hh),V(t,[{key:"_toFieldTransform",value:function(e){var t=new Yr(e.serializer,Ur(e.serializer,this.xu));return new $r(e.path,t)}},{key:"isEqual",value:function(e){return e instanceof t&&this.xu===e.xu}}])}();function Ch(e,t,n,r){var i=e.Fu(1,t,n);Lh("Data must be an object, but it was:",i,r);var a=[],o=En.empty();Lt(r,function(e,r){var s=Oh(t,e,n);r=(0,u.getModularInstance)(r);var c=i.Su(s);if(r instanceof bh)a.push(s);else{var l=Nh(r,c);null!=l&&(a.push(s),o.set(s,l))}});var s=new Gt(a);return new yh(o,s,i.fieldTransforms)}function Dh(e,t,n,r,i,a){var o=e.Fu(1,t,n),s=[Ph(t,r,n)],c=[i];if(a.length%2!=0)throw new ne(te.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var l=0;l<a.length;l+=2)s.push(Ph(t,a[l])),c.push(a[l+1]);for(var f=[],h=En.empty(),d=s.length-1;d>=0;--d)if(!qh(f,s[d])){var v=s[d],p=c[d];p=(0,u.getModularInstance)(p);var y=o.Su(v);if(p instanceof bh)f.push(v);else{var m=Nh(p,y);null!=m&&(f.push(v),h.set(v,m))}}var g=new Gt(f);return new yh(h,g,o.fieldTransforms)}function Ah(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Nh(n,e.Fu(r?4:3,t))}function Nh(e,t){if(Fh(e=(0,u.getModularInstance)(e)))return Lh("Unsupported field value:",t,e),Mh(e,t);if(e instanceof hh)return function(e,t){if(!mh(t.fu))throw t.Du("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Du("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.yu&&4!==t.fu)throw t.Du("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=g(e);try{for(a.s();!(n=a.n()).done;){var u=Nh(n.value,t.bu(i));null==u&&(u={nullValue:"NULL_VALUE"}),r.push(u),i++}}catch(o){a.e(o)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=(0,u.getModularInstance)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Ur(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=ge.fromDate(e);return{timestampValue:Wi(t.serializer,n)}}if(e instanceof ge){var r=new ge(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Wi(t.serializer,r)}}if(e instanceof dh)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof ch)return{bytesValue:Hi(t.serializer,e._byteString)};if(e instanceof Lf){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.Du("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:Xi(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Du("Unsupported field value: ".concat(Sf(e)))}(e,t)}function Mh(e,t){var n={};return Rt(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Lt(e,function(e,r){var i=Nh(r,t.pu(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function Fh(e){return!("object"!=P(e)||null===e||e instanceof Array||e instanceof Date||e instanceof ge||e instanceof dh||e instanceof ch||e instanceof Lf||e instanceof hh)}function Lh(e,t,n){if(!Fh(n)||!function(e){return"object"==P(e)&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=Sf(n);throw"an object"===r?t.Du(e+" a custom object"):t.Du(e+" "+r)}}function Ph(e,t,n){if((t=(0,u.getModularInstance)(t))instanceof lh)return t._internalPath;if("string"==typeof t)return Oh(e,t);throw Vh("Field path arguments must be of type string or ",e,!1,void 0,n)}var Rh=new RegExp("[~\\*/\\[\\]]");function Oh(e,t,n){if(t.search(Rh)>=0)throw Vh("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return y(lh,D(t.split(".")))._internalPath}catch(r){throw Vh("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Vh(e,t,n,r,i){var a=r&&!r.isEmpty(),u=void 0!==i,o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";var s="";return(a||u)&&(s+=" (found",a&&(s+=" in field ".concat(r)),u&&(s+=" in document ".concat(i)),s+=")"),new ne(te.INVALID_ARGUMENT,o+e+s)}function qh(e,t){return e.some(function(e){return e.isEqual(t)})}var Uh=function(){return V(function e(t,n,r,i,a){R(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a},[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new Lf(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new Bh(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(zh("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}])}(),Bh=function(e){function t(){return R(this,t),b(this,t,arguments)}return S(t,Uh),V(t,[{key:"data",value:function(){return c(T(t.prototype),"data",this).call(this)}}])}();function zh(e,t){return"string"==typeof t?Oh(e,t):t instanceof lh?t._internalPath:t._delegate._internalPath}function Gh(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new ne(te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Kh=V(function e(){R(this,e)}),Qh=exports.QueryConstraint=function(e){function t(){return R(this,t),b(this,t,arguments)}return S(t,Kh),V(t)}();function jh(e,t){for(var n=[],r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];t instanceof Kh&&n.push(t),function(e){var t=e.filter(function(e){return e instanceof Jh}).length,n=e.filter(function(e){return e instanceof Wh}).length;if(t>1||t>0&&n>0)throw new ne(te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(i));var u,o=g(n);try{for(o.s();!(u=o.n()).done;){e=u.value._apply(e)}}catch(s){o.e(s)}finally{o.f()}return e}var Wh=exports.QueryFieldFilterConstraint=function(e){function t(e,n,r){var i;return R(this,t),(i=b(this,t))._field=e,i._op=n,i._value=r,i.type="where",i}return S(t,Qh),V(t,[{key:"_apply",value:function(e){var t=this._parse(e);return hd(e._query,t),new Ff(e.firestore,e.converter,pr(e._query,t))}},{key:"_parse",value:function(e){var t=wh(e.firestore);return function(e,t,n,r,i,a,u){var o;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new ne(te.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){fd(u,a);var s,c=[],l=g(u);try{for(l.s();!(s=l.n()).done;){var f=s.value;c.push(ld(r,e,f))}}catch(h){l.e(h)}finally{l.f()}o={arrayValue:{values:c}}}else o=ld(r,e,u)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||fd(u,a),o=Ah(n,t,u,"in"===a||"not-in"===a);return Ln.create(i,a,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}],[{key:"_create",value:function(e,n,r){return new t(e,n,r)}}])}();function Hh(e,t,n){var r=t,i=zh("where",e);return Wh._create(i,r,n)}var Jh=exports.QueryCompositeFilterConstraint=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t)).type=e,r._queryConstraints=n,r}return S(t,Kh),V(t,[{key:"_parse",value:function(e){var t=this._queryConstraints.map(function(t){return t._parse(e)}).filter(function(e){return e.getFilters().length>0});return 1===t.length?t[0]:Pn.create(t,this._getOperator())}},{key:"_apply",value:function(e){var t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){var n,r=e,i=g(t.getFlattenedFilters());try{for(i.s();!(n=i.n()).done;){var a=n.value;hd(r,a),r=pr(r,a)}}catch(u){i.e(u)}finally{i.f()}}(e._query,t),new Ff(e.firestore,e.converter,pr(e._query,t)))}},{key:"_getQueryConstraints",value:function(){return this._queryConstraints}},{key:"_getOperator",value:function(){return"and"===this.type?"and":"or"}}],[{key:"_create",value:function(e,n){return new t(e,n)}}])}();function Yh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach(function(e){return dd("or",e)}),Jh._create("or",t)}function Xh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach(function(e){return dd("and",e)}),Jh._create("and",t)}var Zh=exports.QueryOrderByConstraint=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t))._field=e,r._direction=n,r.type="orderBy",r}return S(t,Qh),V(t,[{key:"_apply",value:function(e){var t=function(e,t,n){if(null!==e.startAt)throw new ne(te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new ne(te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Nn(t,n)}(e._query,this._field,this._direction);return new Ff(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new ur(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,n){return new t(e,n)}}])}();function $h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=zh("orderBy",e);return Zh._create(n,t)}var ed=exports.QueryLimitConstraint=function(e){function t(e,n,r){var i;return R(this,t),(i=b(this,t)).type=e,i._limit=n,i._limitType=r,i}return S(t,Qh),V(t,[{key:"_apply",value:function(e){return new Ff(e.firestore,e.converter,yr(e._query,this._limit,this._limitType))}}],[{key:"_create",value:function(e,n,r){return new t(e,n,r)}}])}();function td(e){return Df("limit",e),ed._create("limit",e,"F")}function nd(e){return Df("limitToLast",e),ed._create("limitToLast",e,"L")}var rd=exports.QueryStartAtConstraint=function(e){function t(e,n,r){var i;return R(this,t),(i=b(this,t)).type=e,i._docOrFields=n,i._inclusive=r,i}return S(t,Qh),V(t,[{key:"_apply",value:function(e){var t=cd(e,this.type,this._docOrFields,this._inclusive);return new Ff(e.firestore,e.converter,function(e,t){return new ur(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,n,r){return new t(e,n,r)}}])}();function id(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return rd._create("startAt",t,!0)}function ad(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return rd._create("startAfter",t,!1)}var ud=exports.QueryEndAtConstraint=function(e){function t(e,n,r){var i;return R(this,t),(i=b(this,t)).type=e,i._docOrFields=n,i._inclusive=r,i}return S(t,Qh),V(t,[{key:"_apply",value:function(e){var t=cd(e,this.type,this._docOrFields,this._inclusive);return new Ff(e.firestore,e.converter,function(e,t){return new ur(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}],[{key:"_create",value:function(e,n,r){return new t(e,n,r)}}])}();function od(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ud._create("endBefore",t,!1)}function sd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ud._create("endAt",t,!0)}function cd(e,t,n,r){if(n[0]=(0,u.getModularInstance)(n[0]),n[0]instanceof Uh)return function(e,t,n,r,i){if(!r)throw new ne(te.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a,u=[],o=g(fr(e));try{for(o.s();!(a=o.n()).done;){var s=a.value;if(s.field.isKeyField())u.push(dn(t,r.key));else{var c=r.data.field(s.field);if(Xt(c))throw new ne(te.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=s.field.canonicalString();throw new ne(te.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(l,"' (used as the orderBy) does not exist."))}u.push(c)}}}catch(f){o.e(f)}finally{o.f()}return new Cn(u,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=wh(e.firestore);return function(e,t,n,r,i,a){var u=e.explicitOrderBy;if(i.length>u.length)throw new ne(te.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var o=[],s=0;s<i.length;s++){var c=i[s];if(u[s].field.isKeyField()){if("string"!=typeof c)throw new ne(te.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(P(c)));if(!lr(e)&&-1!==c.indexOf("/"))throw new ne(te.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(c,"' contains a slash."));var l=e.path.child(xe.fromString(c));if(!_e.isDocumentKey(l))throw new ne(te.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(l,"' is not because it contains an odd number of segments."));var f=new _e(l);o.push(dn(t,f))}else{var h=Ah(n,r,c);o.push(h)}}return new Cn(o,a)}(e._query,e.firestore._databaseId,i,t,n,r)}function ld(e,t,n){if("string"==typeof(n=(0,u.getModularInstance)(n))){if(""===n)throw new ne(te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lr(t)&&-1!==n.indexOf("/"))throw new ne(te.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(xe.fromString(n));if(!_e.isDocumentKey(r))throw new ne(te.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return dn(e,new _e(r))}if(n instanceof Lf)return dn(e,n._key);throw new ne(te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Sf(n),"."))}function fd(e,t){if(!Array.isArray(e)||0===e.length)throw new ne(te.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function hd(e,t){var n=function(e,t){var n,r=g(e);try{for(r.s();!(n=r.n()).done;){var i,a=g(n.value.getFlattenedFilters());try{for(a.s();!(i=a.n()).done;){var u=i.value;if(t.indexOf(u.op)>=0)return u.op}}catch(o){a.e(o)}finally{a.f()}}}catch(o){r.e(o)}finally{r.f()}return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new ne(te.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new ne(te.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}function dd(e,t){if(!(t instanceof Wh||t instanceof Jh))throw new ne(te.INVALID_ARGUMENT,"Function ".concat(e,"() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'."))}var vd=exports.AbstractUserDataWriter=function(){return V(function e(){R(this,e)},[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(an(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Jt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw X()}}},{key:"convertObject",value:function(e,t){return this.convertObjectMap(e.fields,t)}},{key:"convertObjectMap",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",r={};return Lt(e,function(e,i){r[e]=t.convertValue(i,n)}),r}},{key:"convertGeoPoint",value:function(e){return new dh(Jt(e.latitude),Jt(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=Zt(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp($t(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=Ht(e);return new ge(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=xe.fromString(e);Z(Ta(n));var r=new tn(n.get(1),n.get(3)),i=new _e(n.popFirst(5));return r.isEqual(t)||H("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}])}();function pd(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var yd=function(e){function t(e){var n;return R(this,t),(n=b(this,t)).firestore=e,n}return S(t,vd),V(t,[{key:"convertBytes",value:function(e){return new ch(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Lf(this.firestore,null,t)}}])}();function md(e){return new oh("sum",Ph("sum",e))}function gd(e){return new oh("avg",Ph("average",e))}function kd(){return new oh("count")}function wd(e,t){var n,r;return e instanceof oh&&t instanceof oh&&e.aggregateType===t.aggregateType&&(null===(n=e._internalFieldPath)||void 0===n?void 0:n.canonicalString())===(null===(r=t._internalFieldPath)||void 0===r?void 0:r.canonicalString())}function xd(e,t){return Uf(e.query,t.query)&&(0,u.deepEqual)(e.data(),t.data())}var bd=exports.SnapshotMetadata=function(){return V(function e(t,n){R(this,e),this.hasPendingWrites=t,this.fromCache=n},[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}])}(),Id=exports.DocumentSnapshot=function(e){function t(e,n,r,i,a,u){var o;return R(this,t),(o=b(this,t,[e,n,r,i,u]))._firestore=e,o._firestoreImpl=e,o.metadata=a,o}return S(t,Uh),V(t,[{key:"exists",value:function(){return c(T(t.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new _d(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(zh("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}])}(),_d=exports.QueryDocumentSnapshot=function(e){function t(){return R(this,t),b(this,t,arguments)}return S(t,Id),V(t,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c(T(t.prototype),"data",this).call(this,e)}}])}(),Ed=exports.QuerySnapshot=function(){return V(function e(t,n,r,i){R(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new bd(i.hasPendingWrites,i.fromCache),this.query=r},[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new _d(n._firestore,n._userDataWriter,r.key,r,new bd(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new ne(te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){var r=new _d(e._firestore,e._userDataWriter,t.doc.key,t.doc,new bd(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new _d(e._firestore,e._userDataWriter,t.doc.key,t.doc,new bd(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:Td(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}])}();function Td(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return X()}}function Sd(e,t){return e instanceof Id&&t instanceof Id?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Ed&&t instanceof Ed&&e._firestore===t._firestore&&Uf(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function Cd(e){e=Cf(e,Lf);var t=Cf(e.firestore,Qf);return ff(Hf(t),e._key).then(function(n){return zd(t,e,n)})}var Dd=function(e){function t(e){var n;return R(this,t),(n=b(this,t)).firestore=e,n}return S(t,vd),V(t,[{key:"convertBytes",value:function(e){return new ch(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Lf(this.firestore,null,t)}}])}();function Ad(e){e=Cf(e,Lf);var t=Cf(e.firestore,Qf),n=Hf(t),r=new Dd(t);return lf(n,e._key).then(function(n){return new Id(t,r,e._key,n,new bd(null!==n&&n.hasLocalMutations,!0),e.converter)})}function Nd(e){e=Cf(e,Lf);var t=Cf(e.firestore,Qf);return ff(Hf(t),e._key,{source:"server"}).then(function(n){return zd(t,e,n)})}function Md(e){e=Cf(e,Ff);var t=Cf(e.firestore,Qf),n=Hf(t),r=new Dd(t);return Gh(e._query),df(n,e._query).then(function(n){return new Ed(t,r,e,n)})}function Fd(e){e=Cf(e,Ff);var t=Cf(e.firestore,Qf),n=Hf(t),r=new Dd(t);return hf(n,e._query).then(function(n){return new Ed(t,r,e,n)})}function Ld(e){e=Cf(e,Ff);var t=Cf(e.firestore,Qf),n=Hf(t),r=new Dd(t);return df(n,e._query,{source:"server"}).then(function(n){return new Ed(t,r,e,n)})}function Pd(e,t,n){e=Cf(e,Lf);var r=Cf(e.firestore,Qf),i=pd(e.converter,t,n);return Bd(r,[xh(wh(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,ni.none())])}function Rd(e,t,n){e=Cf(e,Lf);for(var r=Cf(e.firestore,Qf),i=wh(r),a=arguments.length,o=new Array(a>3?a-3:0),s=3;s<a;s++)o[s-3]=arguments[s];return Bd(r,[("string"==typeof(t=(0,u.getModularInstance)(t))||t instanceof lh?Dh(i,"updateDoc",e._key,t,n,o):Ch(i,"updateDoc",e._key,t)).toMutation(e._key,ni.exists(!0))])}function Od(e){return Bd(Cf(e.firestore,Qf),[new mi(e._key,ni.none())])}function Vd(e,t){var n=Cf(e.firestore,Qf),r=Vf(e),i=pd(e.converter,t);return Bd(n,[xh(wh(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,ni.exists(!1))]).then(function(){return r})}function qd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=(0,u.getModularInstance)(e);var s={includeMetadataChanges:!1,source:"default"},c=0;"object"!=P(n[c])||zf(n[c])||(s=n[c],c++);var l,f,h,d={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(zf(n[c])){var v=n[c];n[c]=null===(i=v.next)||void 0===i?void 0:i.bind(v),n[c+1]=null===(a=v.error)||void 0===a?void 0:a.bind(v),n[c+2]=null===(o=v.complete)||void 0===o?void 0:o.bind(v)}if(e instanceof Lf)f=Cf(e.firestore,Qf),h=sr(e._key.path),l={next:function(t){n[c]&&n[c](zd(f,e,t))},error:n[c+1],complete:n[c+2]};else{var p=Cf(e,Ff);f=Cf(p.firestore,Qf),h=p._query;var y=new Dd(f);l={next:function(e){n[c]&&n[c](new Ed(f,y,p,e))},error:n[c+1],complete:n[c+2]},Gh(e._query)}return function(e,t,n,r){var i=new Ul(r),a=new xc(t,i,n);return e.asyncQueue.enqueueAndForget(x(k().mark(function t(){return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=vc,t.next=3,uf(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.$a(),e.asyncQueue.enqueueAndForget(x(k().mark(function t(){return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=yc,t.next=3,uf(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}(Hf(f),h,d,l)}function Ud(e,t){return pf(Hf(e=Cf(e,Qf)),zf(t)?t:{next:t})}function Bd(e,t){return function(e,t){var n=new re;return e.asyncQueue.enqueueAndForget(x(k().mark(function r(){return k().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=Kc,r.next=3,rf(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}},r)}))),n.promise}(Hf(e),t)}function zd(e,t,n){var r=n.docs.get(t._key),i=new Dd(e);return new Id(e,i,t._key,r,new bd(n.hasPendingWrites,n.fromCache),t.converter)}function Gd(e){return Kd(e,{count:kd()})}function Kd(e,t){var n=Cf(e.firestore,Qf),r=Hf(n),i=Pt(t,function(e,t){return new bi(t,e.aggregateType,e._internalFieldPath)});return vf(r,e._query,i).then(function(t){return function(e,t,n){var r=new Dd(e);return new sh(t,r,n)}(n,e,t)})}var Qd=function(){return V(function e(t){R(this,e),this.kind="memory",this._onlineComponentProvider=new Vl,(null==t?void 0:t.garbageCollector)?this._offlineComponentProvider=t.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=new Ll},[{key:"toJSON",value:function(){return{kind:this.kind}}}])}(),jd=function(){return V(function e(t){var n;R(this,e),this.kind="persistent",(null==t?void 0:t.tabManager)?(t.tabManager._initialize(t),n=t.tabManager):(n=tv(void 0))._initialize(t),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider},[{key:"toJSON",value:function(){return{kind:this.kind}}}])}(),Wd=function(){return V(function e(){R(this,e),this.kind="memoryEager",this._offlineComponentProvider=new Ll},[{key:"toJSON",value:function(){return{kind:this.kind}}}])}(),Hd=function(){return V(function e(t){R(this,e),this.kind="memoryLru",this._offlineComponentProvider=new Pl(t)},[{key:"toJSON",value:function(){return{kind:this.kind}}}])}();function Jd(){return new Wd}function Yd(e){return new Hd(null==e?void 0:e.cacheSizeBytes)}function Xd(e){return new Qd(e)}function Zd(e){return new jd(e)}var $d=function(){return V(function e(t){R(this,e),this.forceOwnership=t,this.kind="persistentSingleTab"},[{key:"toJSON",value:function(){return{kind:this.kind}}},{key:"_initialize",value:function(e){this._onlineComponentProvider=new Vl,this._offlineComponentProvider=new Rl(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes,this.forceOwnership)}}])}(),ev=function(){return V(function e(){R(this,e),this.kind="PersistentMultipleTab"},[{key:"toJSON",value:function(){return{kind:this.kind}}},{key:"_initialize",value:function(e){this._onlineComponentProvider=new Vl,this._offlineComponentProvider=new Ol(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes)}}])}();function tv(e){return new $d(null==e?void 0:e.forceOwnership)}function nv(){return new ev}var rv={maxAttempts:5},iv=exports.WriteBatch=function(){return V(function e(t,n){R(this,e),this._firestore=t,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=wh(t)},[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=av(e,this._firestore),i=pd(r.converter,t,n),a=xh(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,ni.none())),this}},{key:"update",value:function(e,t,n){this._verifyNotCommitted();for(var r,i=av(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),s=3;s<a;s++)o[s-3]=arguments[s];return r="string"==typeof(t=(0,u.getModularInstance)(t))||t instanceof lh?Dh(this._dataReader,"WriteBatch.update",i._key,t,n,o):Ch(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(r.toMutation(i._key,ni.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=av(e,this._firestore);return this._mutations=this._mutations.concat(new mi(t._key,ni.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new ne(te.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}])}();function av(e,t){if((e=(0,u.getModularInstance)(e)).firestore!==t)throw new ne(te.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}var uv=exports.Transaction=function(e){function t(e,n){var r;return R(this,t),(r=b(this,t,[e,n]))._firestore=e,r}return S(t,e),V(t,[{key:"get",value:function(e){var n=this,r=av(e,this._firestore),i=new Dd(this._firestore);return c(T(t.prototype),"get",this).call(this,e).then(function(e){return new Id(n._firestore,i,r._key,e._document,new bd(!1,!1),r.converter)})}}])}(function(){return V(function e(t,n){R(this,e),this._firestore=t,this._transaction=n,this._dataReader=wh(t)},[{key:"get",value:function(e){var t=this,n=av(e,this._firestore),r=new yd(this._firestore);return this._transaction.lookup([n._key]).then(function(e){if(!e||1!==e.length)return X();var i=e[0];if(i.isFoundDocument())return new Uh(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Uh(t._firestore,r,n._key,null,n.converter);throw X()})}},{key:"set",value:function(e,t,n){var r=av(e,this._firestore),i=pd(r.converter,t,n),a=xh(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(e,t,n){for(var r,i=av(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),s=3;s<a;s++)o[s-3]=arguments[s];return r="string"==typeof(t=(0,u.getModularInstance)(t))||t instanceof lh?Dh(this._dataReader,"Transaction.update",i._key,t,n,o):Ch(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,r),this}},{key:"delete",value:function(e){var t=av(e,this._firestore);return this._transaction.delete(t._key),this}}])}());function ov(e,t,n){e=Cf(e,Qf);var r=Object.assign(Object.assign({},rv),n);return function(e){if(e.maxAttempts<1)throw new ne(te.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){var r=new re;return e.asyncQueue.enqueueAndForget(x(k().mark(function i(){var a;return k().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,af(e);case 2:a=i.sent,new Gl(e.asyncQueue,a,n,t,r).Xa();case 4:case"end":return i.stop()}},i)}))),r.promise}(Hf(e),function(n){return t(new uv(e,n))},r)}function sv(){return new bh("deleteField")}function cv(){return new _h("serverTimestamp")}function lv(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Eh("arrayUnion",t)}function fv(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Th("arrayRemove",t)}function hv(e){return new Sh("increment",e)}function dv(e){return Hf(e=Cf(e,Qf)),new iv(e,function(t){return Bd(e,t)})}function vv(e,t){var n,r=Hf(e=Cf(e,Qf));return r._uninitializedComponentsProvider&&"memory"!==(null===(n=r._uninitializedComponentsProvider)||void 0===n?void 0:n._offlineKind)?gf(r,function(e){var t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new ne(te.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==e?void 0:e.message))}}(e):e,n=[];if(Array.isArray(t.indexes)){var r,i=g(t.indexes);try{for(i.s();!(r=i.n()).done;){var a=r.value,u=pv(a,"collectionGroup"),o=[];if(Array.isArray(a.fields)){var s,c=g(a.fields);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=Oh("setIndexConfiguration",pv(l,"fieldPath"));"CONTAINS"===l.arrayConfig?o.push(new De(f,2)):"ASCENDING"===l.order?o.push(new De(f,0)):"DESCENDING"===l.order&&o.push(new De(f,1))}}catch(h){c.e(h)}finally{c.f()}}n.push(new Ee(Ee.UNKNOWN_ID,u,o,Ne.empty()))}}catch(h){i.e(h)}finally{i.f()}}return n}(t)):(J("Cannot enable indexes when persistence is disabled"),Promise.resolve())}function pv(e,t){if("string"!=typeof e[t])throw new ne(te.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}var yv=exports.PersistentCacheIndexManager=V(function e(t){R(this,e),this._client=t,this.type="PersistentCacheIndexManager"});function mv(e){var t;e=Cf(e,Qf);var n=bv.get(e);if(n)return n;var r=Hf(e);if("persistent"!==(null===(t=r._uninitializedComponentsProvider)||void 0===t?void 0:t._offlineKind))return null;var i=new yv(r);return bv.set(e,i),i}function gv(e){xv(e,!0)}function kv(e){xv(e,!1)}function wv(e){e._client.verifyNotTerminated(),wf(e._client).then(function(e){return W("deleting all persistent cache indexes succeeded")}).catch(function(e){return J("deleting all persistent cache indexes failed",e)})}function xv(e,t){e._client.verifyNotTerminated(),kf(e._client,t).then(function(e){return W("setting persistent cache index auto creation isEnabled=".concat(t," succeeded"))}).catch(function(e){return J("setting persistent cache index auto creation isEnabled=".concat(t," failed"),e)})}var bv=new WeakMap;function Iv(e){var t,n=null===(t=Hf(Cf(e.firestore,Qf))._onlineComponents)||void 0===t?void 0:t.datastore.serializer;return void 0===n?null:va(n,hr(e._query))._t}function _v(e,t){var n,r=Pt(t,function(e,t){return new bi(t,e.aggregateType,e._internalFieldPath)}),i=null===(n=Hf(Cf(e.firestore,Qf))._onlineComponents)||void 0===n?void 0:n.datastore.serializer;return void 0===i?null:pa(i,dr(e._query),r,!0).request}var Ev=exports._TestingHooks=function(){return V(function e(){throw R(this,e),new Error("instances of this class should not be created")},null,[{key:"onExistenceFilterMismatch",value:function(e){return Tv.instance.onExistenceFilterMismatch(e)}}])}(),Tv=function(){function e(){R(this,e),this.Ou=new Map}return V(e,[{key:"et",value:function(e){this.Ou.forEach(function(t){return t(e)})}},{key:"onExistenceFilterMismatch",value:function(e){var t=Symbol(),n=this.Ou;return n.set(t,e),function(){return n.delete(t)}}}],[{key:"instance",get:function(){return Sv||function(e){if(Ti)throw new Error("a TestingHooksSpi instance is already set");Ti=e}(Sv=new e),Sv}}])}(),Sv=null;!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){G=e}(r.SDK_VERSION),(0,r._registerComponent)(new i.Component("firestore",function(e,n){var r=n.instanceIdentifier,i=n.options,a=e.getProvider("app").getImmediate(),u=new Qf(new oe(e.getProvider("auth-internal")),new fe(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new ne(te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new tn(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),u._setSettings(i),u},"PUBLIC").setMultipleInstances(!0)),(0,r.registerVersion)(B,"4.6.3",e),(0,r.registerVersion)(B,"4.6.3","esm2017")}();
},{"@firebase/app":"h2Mb","@firebase/component":"vhY9","@firebase/logger":"JJem","@firebase/util":"chA2","@firebase/webchannel-wrapper/bloom-blob":"WPde","@firebase/webchannel-wrapper/webchannel-blob":"gTzP","process":"pBGv","buffer":"dskh"}],"rrht":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/firestore");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/firestore":"lBbe"}],"vCxL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__addDisposableResource=k,exports.__assign=void 0,exports.__asyncDelegator=g,exports.__asyncGenerator=x,exports.__asyncValues=O,exports.__await=m,exports.__awaiter=l,exports.__classPrivateFieldGet=T,exports.__classPrivateFieldIn=I,exports.__classPrivateFieldSet=D,exports.__createBinding=void 0,exports.__decorate=o,exports.__disposeResources=A,exports.__esDecorate=i,exports.__exportStar=_,exports.__extends=t,exports.__generator=p,exports.__importDefault=E,exports.__importStar=S,exports.__makeTemplateObject=j,exports.__metadata=f,exports.__param=a,exports.__propKey=s,exports.__read=h,exports.__rest=n,exports.__runInitializers=c,exports.__setFunctionName=u,exports.__spread=v,exports.__spreadArray=w,exports.__spreadArrays=b,exports.__values=d,exports.default=void 0;var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};function t(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};function n(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function o(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function a(e,t){return function(r,n){t(r,n,e)}}function i(e,t,r,n,o,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var c,s=n.kind,u="getter"===s?"get":"setter"===s?"set":"value",f=!t&&e?n.static?e:e.prototype:null,l=t||(f?Object.getOwnPropertyDescriptor(f,n.name):{}),p=!1,y=r.length-1;y>=0;y--){var _={};for(var d in n)_[d]="access"===d?{}:n[d];for(var d in n.access)_.access[d]=n.access[d];_.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var h=(0,r[y])("accessor"===s?{get:l.get,set:l.set}:l[u],_);if("accessor"===s){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(c=i(h.get))&&(l.get=c),(c=i(h.set))&&(l.set=c),(c=i(h.init))&&o.unshift(c)}else(c=i(h))&&("field"===s?o.unshift(c):l[u]=c)}f&&Object.defineProperty(f,n.name,l),p=!0}function c(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function s(e){return"symbol"==typeof e?e:"".concat(e)}function u(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{s(n.next(e))}catch(t){a(t)}}function c(e){try{s(n.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,c)}s((n=n.apply(e,t||[])).next())})}function p(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(s){c=[6,s],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}exports.__assign=r;var y=exports.__createBinding=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function _(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||y(t,e,r)}function d(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,c=a.length;i<c;i++,o++)n[o]=a[i];return n}function w(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function x(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),n[Symbol.asyncIterator]=function(){return this},n;function i(e,t){o[e]&&(n[e]=function(t){return new Promise(function(r,n){a.push([e,t,r,n])>1||c(e,t)})},t&&(n[e]=t(n[e])))}function c(e,t){try{(r=o[e](t)).value instanceof m?Promise.resolve(r.value.v).then(s,u):f(a[0][2],r)}catch(n){f(a[0][3],n)}var r}function s(e){c("next",e)}function u(e){c("throw",e)}function f(e,t){e(t),a.shift(),a.length&&c(a[0][0],a[0][1])}}function g(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:m(e[n](t)),done:!1}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof d?d(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&y(t,e,r);return P(t,e),t}function E(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function D(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function I(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function k(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n,o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(o=n)}if("function"!=typeof n)throw new TypeError("Object not disposable.");o&&(n=function(){try{o.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var R="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function A(e){function t(t){e.error=e.hasError?new R(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(r,function(e){return t(e),r()})}catch(a){t(a)}}if(e.hasError)throw e.error}()}var F=exports.default={__extends:t,__assign:r,__rest:n,__decorate:o,__param:a,__metadata:f,__awaiter:l,__generator:p,__createBinding:y,__exportStar:_,__values:d,__read:h,__spread:v,__spreadArrays:b,__spreadArray:w,__await:m,__asyncGenerator:x,__asyncDelegator:g,__asyncValues:O,__makeTemplateObject:j,__importStar:S,__importDefault:E,__classPrivateFieldGet:T,__classPrivateFieldSet:D,__classPrivateFieldIn:I,__addDisposableResource:k,__disposeResources:A};
},{}],"aTyD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.A=exports.$=void 0,exports.B=ti,exports.C=ni,exports.D=ii,exports.E=ri,exports.I=exports.H=exports.G=exports.F=void 0,exports.J=ot,exports.K=ct,exports.a=exports._=exports.Z=exports.Y=exports.X=exports.W=exports.V=exports.U=exports.T=exports.S=exports.R=exports.Q=exports.P=exports.O=exports.N=exports.M=exports.L=void 0,exports.a0=tn,exports.a1=ln,exports.a2=hn,exports.a3=pn,exports.a4=fn,exports.a5=yn,exports.a6=wn,exports.a7=En,exports.a8=An,exports.a9=Sn,exports.aA=Le,exports.aB=T,exports.aC=S,exports.aD=void 0,exports.aE=Te,exports.aF=Ee,exports.aG=Br,exports.aH=Fr,exports.aI=Ur,exports.aJ=We,exports.aL=exports.aK=void 0,exports.aM=Ve,exports.aN=Ri,exports.aQ=exports.aP=exports.aO=void 0,exports.aa=kn,exports.ab=Rn,exports.ac=Nn,exports.ad=bn,exports.ae=Pn,exports.af=Cn,exports.ag=Dn,exports.ah=Ln,exports.ai=void 0,exports.aj=Vt,exports.ak=xn,exports.al=Un,exports.am=Fn,exports.an=te,exports.ao=ne,exports.ap=on,exports.aq=$n,exports.ar=le,exports.as=ai,exports.at=fi,exports.au=R,exports.av=De,exports.aw=Pe,exports.ax=_,exports.ay=bs,exports.az=ts,exports.b=void 0,exports.c=Nr,exports.d=Pr,exports.e=br,exports.f=Hr,exports.g=Wr,exports.h=zr,exports.i=void 0,exports.j=$r,exports.k=void 0,exports.l=gr,exports.n=exports.m=void 0,exports.o=Ys,exports.p=void 0,exports.q=Bn,exports.r=vr,exports.s=fr,exports.t=Jn,exports.u=_r,exports.v=Yn,exports.w=Xn,exports.x=Qn,exports.y=Zn,exports.z=ei;var e=require("@firebase/app"),t=require("@firebase/util"),n=require("@firebase/logger"),i=require("tslib"),r=require("@firebase/component");const s=exports.F={PHONE:"phone",TOTP:"totp"},o=exports.p={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},a=exports.S={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},c=exports.O={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},u=exports.A={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function d(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function l(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const h=exports.G=d,p=exports.H=l,m=new t.ErrorFactory("auth","Firebase",l()),f=exports.I={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type"},g=new n.Logger("@firebase/auth");function v(t,...i){g.logLevel<=n.LogLevel.WARN&&g.warn(`Auth (${e.SDK_VERSION}): ${t}`,...i)}function I(t,...i){g.logLevel<=n.LogLevel.ERROR&&g.error(`Auth (${e.SDK_VERSION}): ${t}`,...i)}function _(e,...t){throw A(e,...t)}function T(e,...t){return A(e,...t)}function y(e,n,i){const r=Object.assign(Object.assign({},p()),{[n]:i});return new t.ErrorFactory("auth","Firebase",r).create(n,{appName:e.name})}function w(e){return y(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function E(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&_(e,"argument-error"),y(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.`+"Did you pass a reference from a different Auth SDK?")}function A(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return m.create(e,...t)}function S(e,t,...n){if(!e)throw A(t,...n)}function k(e){const t="INTERNAL ASSERTION FAILED: "+e;throw I(t),new Error(t)}function R(e,t){e||k(t)}function N(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function b(){return"http:"===P()||"https:"===P()}function P(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function O(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(b()||(0,t.isBrowserExtension)()||"connection"in navigator))||navigator.onLine}function C(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}class D{constructor(e,n){this.shortDelay=e,this.longDelay=n,R(n>e,"Short delay should be less than long delay!"),this.isMobile=(0,t.isMobileCordova)()||(0,t.isReactNative)()}get(){return O()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function L(e,t){R(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class M{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void k("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void k("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void k("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}exports.aP=M;const x={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},U=new D(3e4,6e4);function F(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function V(e,n,i,r,s={}){return j(e,s,async()=>{let s={},o={};r&&("GET"===n?o=r:s={body:JSON.stringify(r)});const a=(0,t.querystring)(Object.assign({key:e.config.apiKey},o)).slice(1),c=await e._getAdditionalHeaders();return c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode),M.fetch()(q(e,e.config.apiHost,i,a),Object.assign({method:n,headers:c,referrerPolicy:"no-referrer"},s))})}async function j(e,n,i){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},x),n);try{const n=new G(e),o=await Promise.race([i(),n.promise]);n.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw W(e,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const t=o.ok?a.errorMessage:a.error.message,[n,i]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw W(e,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw W(e,"email-already-in-use",a);if("USER_DISABLED"===n)throw W(e,"user-disabled",a);const s=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw y(e,s,i);_(e,s)}}catch(s){if(s instanceof t.FirebaseError)throw s;_(e,"network-request-failed",{message:String(s)})}}async function H(e,t,n,i,r={}){const s=await V(e,t,n,i,r);return"mfaPendingCredential"in s&&_(e,"multi-factor-auth-required",{_serverResponse:s}),s}function q(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?L(e.config,r):`${e.config.apiScheme}://${r}`}function z(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class G{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(T(this.auth,"network-request-failed")),U.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function W(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=T(e,t,i);return r.customData._tokenResponse=n,r}function K(e){return void 0!==e&&void 0!==e.getResponse}function $(e){return void 0!==e&&void 0!==e.enterprise}class B{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return z(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function J(e){return(await V(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function Y(e,t){return V(e,"GET","/v2/recaptchaConfig",F(e,t))}async function X(e,t){return V(e,"POST","/v1/accounts:delete",t)}async function Q(e,t){return V(e,"POST","/v1/accounts:update",t)}async function Z(e,t){return V(e,"POST","/v1/accounts:lookup",t)}function ee(e){if(e)try{const n=new Date(Number(e));if(!isNaN(n.getTime()))return n.toUTCString()}catch(t){}}function te(e,n=!1){return(0,t.getModularInstance)(e).getIdToken(n)}async function ne(e,n=!1){const i=(0,t.getModularInstance)(e),r=await i.getIdToken(n),s=re(r);S(s&&s.exp&&s.auth_time&&s.iat,i.auth,"internal-error");const o="object"==typeof s.firebase?s.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:ee(ie(s.auth_time)),issuedAtTime:ee(ie(s.iat)),expirationTime:ee(ie(s.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}function ie(e){return 1e3*Number(e)}function re(e){const[n,i,r]=e.split(".");if(void 0===n||void 0===i||void 0===r)return I("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,t.base64Decode)(i);return e?JSON.parse(e):(I("Failed to decode base64 JWT payload"),null)}catch(s){return I("Caught error parsing JWT payload as JSON",null==s?void 0:s.toString()),null}}function se(e){const t=re(e);return S(t,"internal-error"),S(void 0!==t.exp,"internal-error"),S(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function oe(e,n,i=!1){if(i)return n;try{return await n}catch(r){throw r instanceof t.FirebaseError&&ae(r)&&e.auth.currentUser===e&&await e.auth.signOut(),r}}function ae({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}class ce{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class ue{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ee(this.lastLoginAt),this.creationTime=ee(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function de(e){var t;const n=e.auth,i=await e.getIdToken(),r=await oe(e,Z(n,{idToken:i}));S(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?pe(s.providerUserInfo):[],a=he(e.providerData,o),c=e.isAnonymous,u=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!c&&u,l={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ue(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,l)}async function le(e){const n=(0,t.getModularInstance)(e);await de(n),await n.auth._persistUserIfCurrent(n),n.auth._notifyListenersIfCurrent(n)}function he(e,t){return[...e.filter(e=>!t.some(t=>t.providerId===e.providerId)),...t]}function pe(e){return e.map(e=>{var{providerId:t}=e,n=(0,i.__rest)(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}async function me(e,n){const i=await j(e,{},async()=>{const i=(0,t.querystring)({grant_type:"refresh_token",refresh_token:n}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,o=q(e,r,"/v1/token",`key=${s}`),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",M.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token}}async function fe(e,t){return V(e,"POST","/v2/accounts:revokeToken",F(e,t))}class ge{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){S(e.idToken,"internal-error"),S(void 0!==e.idToken,"internal-error"),S(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):se(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){S(0!==e.length,"internal-error");const t=se(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(S(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await me(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new ge;return n&&(S("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(S("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(S("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ge,this.toJSON())}_performRefresh(){return k("not implemented")}}function ve(e,t){S("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Ie{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,s=(0,i.__rest)(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ce(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ue(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await oe(this,this.stsTokenManager.getToken(this.auth,e));return S(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return ne(this,e)}reload(){return le(this)}_assign(e){this!==e&&(S(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ie(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){S(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await de(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,e._isFirebaseServerApp)(this.auth.app))return Promise.reject(w(this.auth));const t=await this.getIdToken();return await oe(this,X(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,c,u;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,l=null!==(i=t.email)&&void 0!==i?i:void 0,h=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,m=null!==(o=t.tenantId)&&void 0!==o?o:void 0,f=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,v=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:I,emailVerified:_,isAnonymous:T,providerData:y,stsTokenManager:w}=t;S(I&&w,e,"internal-error");const E=ge.fromJSON(this.name,w);S("string"==typeof I,e,"internal-error"),ve(d,e.name),ve(l,e.name),S("boolean"==typeof _,e,"internal-error"),S("boolean"==typeof T,e,"internal-error"),ve(h,e.name),ve(p,e.name),ve(m,e.name),ve(f,e.name),ve(g,e.name),ve(v,e.name);const A=new Ie({uid:I,auth:e,email:l,emailVerified:_,displayName:d,isAnonymous:T,photoURL:p,phoneNumber:h,tenantId:m,stsTokenManager:E,createdAt:g,lastLoginAt:v});return y&&Array.isArray(y)&&(A.providerData=y.map(e=>Object.assign({},e))),f&&(A._redirectEventId=f),A}static async _fromIdTokenResponse(e,t,n=!1){const i=new ge;i.updateFromServerResponse(t);const r=new Ie({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await de(r),r}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];S(void 0!==i.localId,"internal-error");const r=void 0!==i.providerUserInfo?pe(i.providerUserInfo):[],s=!(i.email&&i.passwordHash||(null==r?void 0:r.length)),o=new ge;o.updateFromIdToken(n);const a=new Ie({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:s}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new ue(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash||(null==r?void 0:r.length))};return Object.assign(a,c),a}}exports.aK=Ie;const _e=new Map;function Te(e){R(e instanceof Function,"Expected a class definition");let t=_e.get(e);return t?(R(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,_e.set(e,t),t)}class ye{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ye.type="NONE";const we=exports.U=ye;function Ee(e,t,n){return`firebase:${e}:${t}:${n}`}class Ae{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=Ee(this.userKey,i.apiKey,r),this.fullPersistenceKey=Ee("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ie._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Ae(Te(we),e,n);const i=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let r=i[0]||Te(we);const s=Ee(n,e.config.apiKey,e.name);let o=null;for(const u of t)try{const t=await u._get(s);if(t){const n=Ie._fromJSON(e,t);u!==r&&(o=n),r=u;break}}catch(c){}const a=i.filter(e=>e._shouldAllowMigration);return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==r)try{await e._remove(s)}catch(c){}})),new Ae(r,e,n)):new Ae(r,e,n)}}function Se(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(be(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ke(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Oe(t))return"Blackberry";if(Ce(t))return"Webos";if(Re(t))return"Safari";if((t.includes("chrome/")||Ne(t))&&!t.includes("edge/"))return"Chrome";if(Pe(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function ke(e=(0,t.getUA)()){return/firefox\//i.test(e)}function Re(e=(0,t.getUA)()){const n=e.toLowerCase();return n.includes("safari/")&&!n.includes("chrome/")&&!n.includes("crios/")&&!n.includes("android")}function Ne(e=(0,t.getUA)()){return/crios\//i.test(e)}function be(e=(0,t.getUA)()){return/iemobile/i.test(e)}function Pe(e=(0,t.getUA)()){return/android/i.test(e)}function Oe(e=(0,t.getUA)()){return/blackberry/i.test(e)}function Ce(e=(0,t.getUA)()){return/webos/i.test(e)}function De(e=(0,t.getUA)()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Le(e=(0,t.getUA)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}function Me(e=(0,t.getUA)()){var n;return De(e)&&!!(null===(n=window.navigator)||void 0===n?void 0:n.standalone)}function xe(){return(0,t.isIE)()&&10===document.documentMode}function Ue(e=(0,t.getUA)()){return De(e)||Pe(e)||Ce(e)||Oe(e)||/windows phone/i.test(e)||be(e)}function Fe(){try{return!(!window||window===window.top)}catch(e){return!1}}function Ve(n,i=[]){let r;switch(n){case"Browser":r=Se((0,t.getUA)());break;case"Worker":r=`${Se((0,t.getUA)())}-${n}`;break;default:r=n}const s=i.length?i.join(","):"FirebaseCore-web";return`${r}/JsCore/${e.SDK_VERSION}/${s}`}class je{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,i)=>{try{n(e(t))}catch(r){i(r)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=(()=>Promise.resolve())}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(i){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==n?void 0:n.message})}}}async function He(e,t={}){return V(e,"GET","/v2/passwordPolicy",F(e,t))}const qe=6;class ze{constructor(e){var t,n,i,r;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:qe,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=e.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,r,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(r=a.containsUppercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}class Ge{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ke(this),this.idTokenSubscription=new Ke(this),this.beforeStateQueue=new je(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=m,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Te(t)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Ae.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(r){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(e,!0)):void 0}async initializeCurrentUserFromIdToken(e){try{const n=await Z(this,{idToken:e}),i=await Ie._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var n;if((0,e._isFirebaseServerApp)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let r=i,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const e=null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId,i=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(t);e&&e!==i||null==o||!o.user||(r=o.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return S(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await de(e)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=C()}async _delete(){this._deleted=!0}async updateCurrentUser(n){if((0,e._isFirebaseServerApp)(this.app))return Promise.reject(w(this));const i=n?(0,t.getModularInstance)(n):null;return i&&S(i.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(i&&i._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&S(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,e._isFirebaseServerApp)(this.app)?Promise.reject(w(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return(0,e._isFirebaseServerApp)(this.app)?Promise.reject(w(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Te(t))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await He(this),t=new ze(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new t.ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await fe(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Te(e)||this._popupRedirectResolver;S(t,this,"argument-error"),this.redirectPersistenceManager=await Ae.create(this,[Te(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(S(o,this,"internal-error"),o.then(()=>{s||r(this.currentUser)}),"function"==typeof t){const r=e.addObserver(t,n,i);return()=>{s=!0,r()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return S(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ve(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&v(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function We(e){return(0,t.getModularInstance)(e)}exports.aL=Ge;class Ke{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,t.createSubscribe)(e=>this.observer=e)}get next(){return S(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let $e={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Be(e){$e=e}function Je(e){return $e.loadJS(e)}function Ye(){return $e.recaptchaV2Script}function Xe(){return $e.recaptchaEnterpriseScript}function Qe(){return $e.gapiScript}function Ze(e){return`__${e}${Math.floor(1e6*Math.random())}`}const et="recaptcha-enterprise",tt="NO_RECAPTCHA";class nt{constructor(e){this.type=et,this.auth=We(e)}async verify(e="verify",t=!1){function n(t,n,i){const r=window.grecaptcha;$(r)?r.enterprise.ready(()=>{r.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(tt)})}):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Y(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(i=>{if(void 0!==i.recaptchaKey){const n=new B(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(r=>{if(!t&&$(window.grecaptcha))n(r,e,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let t=Xe();0!==t.length&&(t+=r),Je(t).then(()=>{n(r,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}}async function it(e,t,n,i=!1){const r=new nt(e);let s;try{s=await r.verify(n)}catch(a){s=await r.verify(n,!0)}const o=Object.assign({},t);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function rt(e,t,n,i){var r;if(null===(r=e._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await it(e,t,n,"getOobCode"===n);return i(e,r)}return i(e,t).catch(async r=>{if("auth/missing-recaptcha-token"===r.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const r=await it(e,t,n,"getOobCode"===n);return i(e,r)}return Promise.reject(r)})}async function st(e){const t=We(e),n=await Y(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),i=new B(n);if(null==t.tenantId?t._agentRecaptchaConfig=i:t._tenantRecaptchaConfigs[t.tenantId]=i,i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){new nt(t).verify()}}function ot(n,i){const r=(0,e._getProvider)(n,"auth");if(r.isInitialized()){const e=r.getImmediate(),n=r.getOptions();if((0,t.deepEqual)(n,null!=i?i:{}))return e;_(e,"already-initialized")}return r.initialize({options:i})}function at(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Te);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}function ct(e,t,n){const i=We(e);S(i._canInitEmulator,i,"emulator-config-failed"),S(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=ut(t),{host:o,port:a}=dt(t),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||ht()}function ut(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function dt(e){const t=ut(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:lt(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:lt(t)}}}function lt(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function ht(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}class pt{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return k("not implemented")}_getIdTokenResponse(e){return k("not implemented")}_linkToIdToken(e,t){return k("not implemented")}_getReauthenticationResolver(e){return k("not implemented")}}async function mt(e,t){return V(e,"POST","/v1/accounts:resetPassword",F(e,t))}async function ft(e,t){return V(e,"POST","/v1/accounts:update",t)}async function gt(e,t){return V(e,"POST","/v1/accounts:signUp",t)}async function vt(e,t){return V(e,"POST","/v1/accounts:update",F(e,t))}async function It(e,t){return H(e,"POST","/v1/accounts:signInWithPassword",F(e,t))}async function _t(e,t){return V(e,"POST","/v1/accounts:sendOobCode",F(e,t))}async function Tt(e,t){return _t(e,t)}async function yt(e,t){return _t(e,t)}async function wt(e,t){return _t(e,t)}async function Et(e,t){return _t(e,t)}async function At(e,t){return H(e,"POST","/v1/accounts:signInWithEmailLink",F(e,t))}async function St(e,t){return H(e,"POST","/v1/accounts:signInWithEmailLink",F(e,t))}exports.L=pt;class kt extends pt{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new kt(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new kt(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return rt(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",It);case"emailLink":return At(e,{email:this._email,oobCode:this._password});default:_(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return rt(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",gt);case"emailLink":return St(e,{idToken:t,email:this._email,oobCode:this._password});default:_(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Rt(e,t){return H(e,"POST","/v1/accounts:signInWithIdp",F(e,t))}exports.M=kt;const Nt="http://localhost";class bt extends pt{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new bt(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,s=(0,i.__rest)(t,["providerId","signInMethod"]);if(!n||!r)return null;const o=new bt(n,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){return Rt(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Rt(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Rt(e,t)}buildRequest(){const e={requestUri:Nt,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=(0,t.querystring)(n)}return e}}async function Pt(e,t){return V(e,"POST","/v1/accounts:sendVerificationCode",F(e,t))}async function Ot(e,t){return H(e,"POST","/v1/accounts:signInWithPhoneNumber",F(e,t))}async function Ct(e,t){const n=await H(e,"POST","/v1/accounts:signInWithPhoneNumber",F(e,t));if(n.temporaryProof)throw W(e,"account-exists-with-different-credential",n);return n}exports.N=bt;const Dt={USER_NOT_FOUND:"user-not-found"};async function Lt(e,t){return H(e,"POST","/v1/accounts:signInWithPhoneNumber",F(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Dt)}class Mt extends pt{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Mt({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Mt({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return Ot(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return Ct(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return Lt(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new Mt({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}function xt(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Ut(e){const n=(0,t.querystringDecode)((0,t.extractQuerystring)(e)).link,i=n?(0,t.querystringDecode)((0,t.extractQuerystring)(n)).deep_link_id:null,r=(0,t.querystringDecode)((0,t.extractQuerystring)(e)).deep_link_id;return(r?(0,t.querystringDecode)((0,t.extractQuerystring)(r)).link:null)||r||i||n||e}exports.Q=Mt;class Ft{constructor(e){var n,i,r,s,o,a;const c=(0,t.querystringDecode)((0,t.extractQuerystring)(e)),u=null!==(n=c.apiKey)&&void 0!==n?n:null,d=null!==(i=c.oobCode)&&void 0!==i?i:null,l=xt(null!==(r=c.mode)&&void 0!==r?r:null);S(u&&d&&l,"argument-error"),this.apiKey=u,this.operation=l,this.code=d,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=Ut(e);try{return new Ft(t)}catch(n){return null}}}function Vt(e){return Ft.parseLink(e)}exports.ai=Ft;class jt{constructor(){this.providerId=jt.PROVIDER_ID}static credential(e,t){return kt._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ft.parseLink(t);return S(n,"argument-error"),kt._fromEmailAndCode(e,n.code,n.tenantId)}}exports.V=jt,jt.PROVIDER_ID="password",jt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",jt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ht{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class qt extends Ht{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class zt extends qt{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return S("providerId"in t&&"signInMethod"in t,"argument-error"),bt._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return S(e.idToken||e.accessToken,"argument-error"),bt._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return zt.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return zt.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:i,pendingToken:r,nonce:s,providerId:o}=e;if(!(n||i||t||r))return null;if(!o)return null;try{return new zt(o)._credential({idToken:t,accessToken:n,nonce:s,pendingToken:r})}catch(a){return null}}}exports.Z=zt;class Gt extends qt{constructor(){super("facebook.com")}static credential(e){return bt._fromParams({providerId:Gt.PROVIDER_ID,signInMethod:Gt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gt.credentialFromTaggedObject(e)}static credentialFromError(e){return Gt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!(e&&"oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Gt.credential(e.oauthAccessToken)}catch(t){return null}}}exports.W=Gt,Gt.FACEBOOK_SIGN_IN_METHOD="facebook.com",Gt.PROVIDER_ID="facebook.com";class Wt extends qt{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return bt._fromParams({providerId:Wt.PROVIDER_ID,signInMethod:Wt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Wt.credentialFromTaggedObject(e)}static credentialFromError(e){return Wt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Wt.credential(t,n)}catch(i){return null}}}exports.X=Wt,Wt.GOOGLE_SIGN_IN_METHOD="google.com",Wt.PROVIDER_ID="google.com";class Kt extends qt{constructor(){super("github.com")}static credential(e){return bt._fromParams({providerId:Kt.PROVIDER_ID,signInMethod:Kt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Kt.credentialFromTaggedObject(e)}static credentialFromError(e){return Kt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!(e&&"oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Kt.credential(e.oauthAccessToken)}catch(t){return null}}}exports.Y=Kt,Kt.GITHUB_SIGN_IN_METHOD="github.com",Kt.PROVIDER_ID="github.com";const $t="http://localhost";class Bt extends pt{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return Rt(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Rt(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Rt(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i,pendingToken:r}=t;return n&&i&&r&&n===i?new Bt(n,r):null}static _create(e,t){return new Bt(e,t)}buildRequest(){return{requestUri:$t,returnSecureToken:!0,pendingToken:this.pendingToken}}}exports.aQ=Bt;const Jt="saml.";class Yt extends Ht{constructor(e){S(e.startsWith(Jt),"argument-error"),super(e)}static credentialFromResult(e){return Yt.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Yt.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Bt.fromJSON(e);return S(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return Bt._create(n,t)}catch(i){return null}}}exports._=Yt;class Xt extends qt{constructor(){super("twitter.com")}static credential(e,t){return bt._fromParams({providerId:Xt.PROVIDER_ID,signInMethod:Xt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xt.credentialFromTaggedObject(e)}static credentialFromError(e){return Xt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Xt.credential(t,n)}catch(i){return null}}}async function Qt(e,t){return H(e,"POST","/v1/accounts:signUp",F(e,t))}exports.$=Xt,Xt.TWITTER_SIGN_IN_METHOD="twitter.com",Xt.PROVIDER_ID="twitter.com";class Zt{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await Ie._fromIdTokenResponse(e,n,i),s=en(n);return new Zt({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=en(n);return new Zt({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function en(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function tn(t){var n;if((0,e._isFirebaseServerApp)(t.app))return Promise.reject(w(t));const i=We(t);if(await i._initializationPromise,null===(n=i.currentUser)||void 0===n?void 0:n.isAnonymous)return new Zt({user:i.currentUser,providerId:null,operationType:"signIn"});const r=await Qt(i,{returnSecureToken:!0}),s=await Zt._fromIdTokenResponse(i,"signIn",r,!0);return await i._updateCurrentUser(s.user),s}class nn extends t.FirebaseError{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,nn.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new nn(e,t,n,i)}}function rn(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw nn._fromErrorAndOperation(e,n,t,i);throw n})}function sn(e){return new Set(e.map(({providerId:e})=>e).filter(e=>!!e))}async function on(e,n){const i=(0,t.getModularInstance)(e);await cn(!0,i,n);const{providerUserInfo:r}=await Q(i.auth,{idToken:await i.getIdToken(),deleteProvider:[n]}),s=sn(r||[]);return i.providerData=i.providerData.filter(e=>s.has(e.providerId)),s.has("phone")||(i.phoneNumber=null),await i.auth._persistUserIfCurrent(i),i}async function an(e,t,n=!1){const i=await oe(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Zt._forOperation(e,"link",i)}async function cn(e,t,n){await de(t);const i=!1===e?"provider-already-linked":"no-such-provider";S(sn(t.providerData).has(n)===e,t.auth,i)}async function un(t,n,i=!1){const{auth:r}=t;if((0,e._isFirebaseServerApp)(r.app))return Promise.reject(w(r));try{const e=await oe(t,rn(r,"reauthenticate",n,t),i);S(e.idToken,r,"internal-error");const o=re(e.idToken);S(o,r,"internal-error");const{sub:a}=o;return S(t.uid===a,r,"user-mismatch"),Zt._forOperation(t,"reauthenticate",e)}catch(s){throw"auth/user-not-found"===(null==s?void 0:s.code)&&_(r,"user-mismatch"),s}}async function dn(t,n,i=!1){if((0,e._isFirebaseServerApp)(t.app))return Promise.reject(w(t));const r=await rn(t,"signIn",n),s=await Zt._fromIdTokenResponse(t,"signIn",r);return i||await t._updateCurrentUser(s.user),s}async function ln(e,t){return dn(We(e),t)}async function hn(e,n){const i=(0,t.getModularInstance)(e);return await cn(!1,i,n.providerId),an(i,n)}async function pn(e,n){return un((0,t.getModularInstance)(e),n)}async function mn(e,t){return H(e,"POST","/v1/accounts:signInWithCustomToken",F(e,t))}async function fn(t,n){if((0,e._isFirebaseServerApp)(t.app))return Promise.reject(w(t));const i=We(t),r=await mn(i,{token:n,returnSecureToken:!0}),s=await Zt._fromIdTokenResponse(i,"signIn",r);return await i._updateCurrentUser(s.user),s}class gn{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?vn._fromServerResponse(e,t):"totpInfo"in t?In._fromServerResponse(e,t):_(e,"internal-error")}}class vn extends gn{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new vn(t)}}class In extends gn{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new In(t)}}function _n(e,t,n){var i;S((null===(i=n.url)||void 0===i?void 0:i.length)>0,e,"invalid-continue-uri"),S(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(S(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(S(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Tn(e){const t=We(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function yn(e,t,n){const i=We(e),r={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&_n(i,r,n),await rt(i,r,"getOobCode",yt)}async function wn(e,n,i){await mt((0,t.getModularInstance)(e),{oobCode:n,newPassword:i}).catch(async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Tn(e),t})}async function En(e,n){await vt((0,t.getModularInstance)(e),{oobCode:n})}async function An(e,n){const i=(0,t.getModularInstance)(e),r=await mt(i,{oobCode:n}),s=r.requestType;switch(S(s,i,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":S(r.newEmail,i,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":S(r.mfaInfo,i,"internal-error");default:S(r.email,i,"internal-error")}let o=null;return r.mfaInfo&&(o=gn._fromServerResponse(We(i),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:o},operation:s}}async function Sn(e,n){const{data:i}=await An((0,t.getModularInstance)(e),n);return i.email}async function kn(t,n,i){if((0,e._isFirebaseServerApp)(t.app))return Promise.reject(w(t));const r=We(t),s=rt(r,{returnSecureToken:!0,email:n,password:i,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Qt),o=await s.catch(e=>{throw"auth/password-does-not-meet-requirements"===e.code&&Tn(t),e}),a=await Zt._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function Rn(n,i,r){return(0,e._isFirebaseServerApp)(n.app)?Promise.reject(w(n)):ln((0,t.getModularInstance)(n),jt.credential(i,r)).catch(async e=>{throw"auth/password-does-not-meet-requirements"===e.code&&Tn(n),e})}async function Nn(e,t,n){const i=We(e),r={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};!function(e,t){S(t.handleCodeInApp,i,"argument-error"),t&&_n(i,e,t)}(r,n),await rt(i,r,"getOobCode",wt)}function bn(e,t){const n=Ft.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}async function Pn(n,i,r){if((0,e._isFirebaseServerApp)(n.app))return Promise.reject(w(n));const s=(0,t.getModularInstance)(n),o=jt.credentialWithLink(i,r||N());return S(o._tenantId===(s.tenantId||null),s,"tenant-id-mismatch"),ln(s,o)}async function On(e,t){return V(e,"POST","/v1/accounts:createAuthUri",F(e,t))}async function Cn(e,n){const i={identifier:n,continueUri:b()?N():"http://localhost"},{signinMethods:r}=await On((0,t.getModularInstance)(e),i);return r||[]}async function Dn(e,n){const i=(0,t.getModularInstance)(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};n&&_n(i.auth,r,n);const{email:s}=await Tt(i.auth,r);s!==e.email&&await e.reload()}async function Ln(e,n,i){const r=(0,t.getModularInstance)(e),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:n};i&&_n(r.auth,s,i);const{email:o}=await Et(r.auth,s);o!==e.email&&await e.reload()}async function Mn(e,t){return V(e,"POST","/v1/accounts:update",t)}async function xn(e,{displayName:n,photoURL:i}){if(void 0===n&&void 0===i)return;const r=(0,t.getModularInstance)(e),s={idToken:await r.getIdToken(),displayName:n,photoUrl:i,returnSecureToken:!0},o=await oe(r,Mn(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:e})=>"password"===e);a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function Un(n,i){const r=(0,t.getModularInstance)(n);return(0,e._isFirebaseServerApp)(r.auth.app)?Promise.reject(w(r.auth)):Vn(r,i,null)}function Fn(e,n){return Vn((0,t.getModularInstance)(e),null,n)}async function Vn(e,t,n){const{auth:i}=e,r={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(r.email=t),n&&(r.password=n);const s=await oe(e,ft(i,r));await e._updateTokensIfNecessary(s,!0)}function jn(e){var t,n;if(!e)return null;const{providerId:i}=e,r=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!i&&(null==e?void 0:e.idToken)){const i=null===(n=null===(t=re(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(i){return new Hn(s,"anonymous"!==i&&"custom"!==i?i:null)}}if(!i)return null;switch(i){case"facebook.com":return new zn(s,r);case"github.com":return new Gn(s,r);case"google.com":return new Wn(s,r);case"twitter.com":return new Kn(s,r,e.screenName||null);case"custom":case"anonymous":return new Hn(s,null);default:return new Hn(s,i,r)}}class Hn{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class qn extends Hn{constructor(e,t,n,i){super(e,t,n),this.username=i}}class zn extends Hn{constructor(e,t){super(e,"facebook.com",t)}}class Gn extends qn{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class Wn extends Hn{constructor(e,t){super(e,"google.com",t)}}class Kn extends qn{constructor(e,t,n){super(e,"twitter.com",t,n)}}function $n(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:jn(n)}function Bn(e,n){return(0,t.getModularInstance)(e).setPersistence(n)}function Jn(e){return st(e)}async function Yn(e,t){return We(e).validatePassword(t)}function Xn(e,n,i,r){return(0,t.getModularInstance)(e).onIdTokenChanged(n,i,r)}function Qn(e,n,i){return(0,t.getModularInstance)(e).beforeAuthStateChanged(n,i)}function Zn(e,n,i,r){return(0,t.getModularInstance)(e).onAuthStateChanged(n,i,r)}function ei(e){(0,t.getModularInstance)(e).useDeviceLanguage()}function ti(e,n){return(0,t.getModularInstance)(e).updateCurrentUser(n)}function ni(e){return(0,t.getModularInstance)(e).signOut()}function ii(e,t){return We(e).revokeAccessToken(t)}async function ri(e){return(0,t.getModularInstance)(e).delete()}class si{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new si("enroll",e,t)}static _fromMfaPendingCredential(e){return new si("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return si._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return si._fromIdtoken(e.multiFactorSession.idToken)}return null}}class oi{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=We(e),i=t.customData._serverResponse,r=(i.mfaInfo||[]).map(e=>gn._fromServerResponse(n,e));S(i.mfaPendingCredential,n,"internal-error");const s=si._fromMfaPendingCredential(i.mfaPendingCredential);return new oi(s,r,async e=>{const r=await e._process(n,s);delete i.mfaInfo,delete i.mfaPendingCredential;const o=Object.assign(Object.assign({},i),{idToken:r.idToken,refreshToken:r.refreshToken});switch(t.operationType){case"signIn":const e=await Zt._fromIdTokenResponse(n,t.operationType,o);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return S(t.user,n,"internal-error"),Zt._forOperation(t.user,t.operationType,o);default:_(n,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function ai(e,n){var i;const r=(0,t.getModularInstance)(e),s=n;return S(n.customData.operationType,r,"argument-error"),S(null===(i=s.customData._serverResponse)||void 0===i?void 0:i.mfaPendingCredential,r,"argument-error"),oi._fromError(r,s)}function ci(e,t){return V(e,"POST","/v2/accounts/mfaEnrollment:start",F(e,t))}function ui(e,t){return V(e,"POST","/v2/accounts/mfaEnrollment:finalize",F(e,t))}function di(e,t){return V(e,"POST","/v2/accounts/mfaEnrollment:start",F(e,t))}function li(e,t){return V(e,"POST","/v2/accounts/mfaEnrollment:finalize",F(e,t))}function hi(e,t){return V(e,"POST","/v2/accounts/mfaEnrollment:withdraw",F(e,t))}class pi{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(t=>gn._fromServerResponse(e.auth,t)))})}static _fromUser(e){return new pi(e)}async getSession(){return si._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,i=await this.getSession(),r=await oe(this.user,n._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(r),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken();try{const e=await oe(this.user,hi(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:e})=>e!==t),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(i){throw i}}}const mi=new WeakMap;function fi(e){const n=(0,t.getModularInstance)(e);return mi.has(n)||mi.set(n,pi._fromUser(n)),mi.get(n)}const gi="__sak";class vi{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(gi,"1"),this.storage.removeItem(gi),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}function Ii(){const e=(0,t.getUA)();return Re(e)||De(e)}const _i=1e3,Ti=10;class yi extends vi{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=((e,t)=>this.onStorageEvent(e,t)),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=Ii()&&Fe(),this.fallbackToPolling=Ue(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);xe()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Ti):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},_i)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}yi.type="LOCAL";const wi=exports.b=yi;class Ei extends vi{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Ei.type="SESSION";const Ai=exports.a=Ei;function Si(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ki{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new ki(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async e=>e(t.origin,r)),a=await Si(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ri(e="",t=10){let n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}ki.receivers=[];class Ni{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise((o,a)=>{const c=Ri("",20);i.port1.start();const u=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),r=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function bi(){return window}function Pi(e){bi().location.href=e}function Oi(){return void 0!==bi().WorkerGlobalScope&&"function"==typeof bi().importScripts}async function Ci(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}function Di(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}function Li(){return Oi()?self:null}const Mi="firebaseLocalStorageDb",xi=1,Ui="firebaseLocalStorage",Fi="fbase_key";class Vi{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ji(e,t){return e.transaction([Ui],t?"readwrite":"readonly").objectStore(Ui)}function Hi(){const e=indexedDB.deleteDatabase(Mi);return new Vi(e).toPromise()}function qi(){const e=indexedDB.open(Mi,xi);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Ui,{keyPath:Fi})}catch(i){n(i)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Ui)?t(n):(n.close(),await Hi(),t(await qi()))})})}async function zi(e,t,n){const i=ji(e,!0).put({[Fi]:t,value:n});return new Vi(i).toPromise()}async function Gi(e,t){const n=ji(e,!1).get(t),i=await new Vi(n).toPromise();return void 0===i?null:i.value}function Wi(e,t){const n=ji(e,!0).delete(t);return new Vi(n).toPromise()}const Ki=800,$i=3;class Bi{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await qi(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(n){if(t++>$i)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Oi()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ki._getInstance(Li()),this.receiver._subscribe("keyChanged",async(e,t)=>{return{keyProcessed:(await this._poll()).includes(t.key)}}),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Ci(),!this.activeServiceWorker)return;this.sender=new Ni(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&Di()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await qi();return await zi(t,gi,"1"),await Wi(t,gi),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>zi(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>Gi(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Wi(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=ji(e,!1).getAll();return new Vi(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Ki)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Bi.type="LOCAL";const Ji=exports.i=Bi;function Yi(e,t){return V(e,"POST","/v2/accounts/mfaSignIn:start",F(e,t))}function Xi(e,t){return V(e,"POST","/v2/accounts/mfaSignIn:finalize",F(e,t))}function Qi(e,t){return V(e,"POST","/v2/accounts/mfaSignIn:finalize",F(e,t))}const Zi=500,er=6e4,tr=1e12;class nr{constructor(e){this.auth=e,this.counter=tr,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new ir(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||tr;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||tr;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||tr;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class ir{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=(()=>{this.execute()});const i="string"==typeof e?document.getElementById(e):e;S(i,"argument-error",{appName:t}),this.container=i,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(()=>{this.responseToken=rr(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(n){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(n){}this.isVisible&&this.execute()},er)},Zi))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function rr(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<e;i++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}const sr=Ze("rcb"),or=new D(3e4,6e4);class ar{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=bi().grecaptcha)||void 0===e?void 0:e.render)}load(e,n=""){return S(cr(n),e,"argument-error"),this.shouldResolveImmediately(n)&&K(bi().grecaptcha)?Promise.resolve(bi().grecaptcha):new Promise((i,r)=>{const s=bi().setTimeout(()=>{r(T(e,"network-request-failed"))},or.get());bi()[sr]=(()=>{bi().clearTimeout(s),delete bi()[sr];const t=bi().grecaptcha;if(!t||!K(t))return void r(T(e,"internal-error"));const o=t.render;t.render=((e,t)=>{const n=o(e,t);return this.counter++,n}),this.hostLanguage=n,i(t)}),Je(`${Ye()}?${(0,t.querystring)({onload:sr,render:"explicit",hl:n})}`).catch(()=>{clearTimeout(s),r(T(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=bi().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function cr(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}class ur{async load(e){return new nr(e)}clearedOneInstance(){}}const dr="recaptcha",lr={theme:"light",type:"image"};class hr{constructor(e,t,n=Object.assign({},lr)){this.parameters=n,this.type=dr,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=We(e),this.isInvisible="invisible"===this.parameters.size,S("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const i="string"==typeof t?document.getElementById(t):t;S(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ur:new ar,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(n=>{const i=e=>{e&&(this.tokenChangeListeners.delete(i),n(e))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){S(!this.parameters.sitekey,this.auth,"argument-error"),S(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),S("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(e=>e(t)),"function"==typeof e)e(t);else if("string"==typeof e){const n=bi()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){S(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){S(b()&&!Oi(),this.auth,"internal-error"),await pr(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await J(this.auth);S(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return S(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function pr(){let e=null;return new Promise(t=>{"complete"!==document.readyState?(e=(()=>t()),window.addEventListener("load",e)):t()}).catch(t=>{throw e&&window.removeEventListener("load",e),t})}exports.R=hr;class mr{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Mt._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function fr(n,i,r){if((0,e._isFirebaseServerApp)(n.app))return Promise.reject(w(n));const s=We(n),o=await Ir(s,i,(0,t.getModularInstance)(r));return new mr(o,e=>ln(s,e))}async function gr(e,n,i){const r=(0,t.getModularInstance)(e);await cn(!1,r,"phone");const s=await Ir(r.auth,n,(0,t.getModularInstance)(i));return new mr(s,e=>hn(r,e))}async function vr(n,i,r){const s=(0,t.getModularInstance)(n);if((0,e._isFirebaseServerApp)(s.auth.app))return Promise.reject(w(s.auth));const o=await Ir(s.auth,i,(0,t.getModularInstance)(r));return new mr(o,e=>pn(s,e))}async function Ir(e,t,n){var i;const r=await n.verify();try{let s;if(S("string"==typeof r,e,"argument-error"),S(n.type===dr,e,"argument-error"),"session"in(s="string"==typeof t?{phoneNumber:t}:t)){const t=s.session;if("phoneNumber"in s){return S("enroll"===t.type,e,"internal-error"),(await ci(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo}{S("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;return S(n,e,"missing-multi-factor-info"),(await Yi(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await Pt(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}async function _r(n,i){const r=(0,t.getModularInstance)(n);if((0,e._isFirebaseServerApp)(r.auth.app))return Promise.reject(w(r.auth));await an(r,i)}class Tr{constructor(e){this.providerId=Tr.PROVIDER_ID,this.auth=We(e)}verifyPhoneNumber(e,n){return Ir(this.auth,e,(0,t.getModularInstance)(n))}static credential(e,t){return Mt._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Tr.credentialFromTaggedObject(t)}static credentialFromError(e){return Tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Mt._fromTokenResponse(t,n):null}}function yr(e,t){return t?Te(t):(S(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}exports.P=Tr,Tr.PROVIDER_ID="phone",Tr.PHONE_SIGN_IN_METHOD="phone";class wr extends pt{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Rt(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Rt(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Rt(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Er(e){return dn(e.auth,new wr(e),e.bypassAuthState)}function Ar(e){const{auth:t,user:n}=e;return S(n,t,"internal-error"),un(n,new wr(e),e.bypassAuthState)}async function Sr(e){const{auth:t,user:n}=e;return S(n,t,"internal-error"),an(n,new wr(e),e.bypassAuthState)}class kr{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Er;case"linkViaPopup":case"linkViaRedirect":return Sr;case"reauthViaPopup":case"reauthViaRedirect":return Ar;default:_(this.auth,"internal-error")}}resolve(e){R(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){R(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Rr=new D(2e3,1e4);async function Nr(t,n,i){if((0,e._isFirebaseServerApp)(t.app))return Promise.reject(T(t,"operation-not-supported-in-this-environment"));const r=We(t);E(t,n,Ht);const s=yr(r,i);return new Or(r,"signInViaPopup",n,s).executeNotNull()}async function br(n,i,r){const s=(0,t.getModularInstance)(n);if((0,e._isFirebaseServerApp)(s.auth.app))return Promise.reject(T(s.auth,"operation-not-supported-in-this-environment"));E(s.auth,i,Ht);const o=yr(s.auth,r);return new Or(s.auth,"reauthViaPopup",i,o,s).executeNotNull()}async function Pr(e,n,i){const r=(0,t.getModularInstance)(e);E(r.auth,n,Ht);const s=yr(r.auth,i);return new Or(r.auth,"linkViaPopup",n,s,r).executeNotNull()}class Or extends kr{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,Or.currentPopupAction&&Or.currentPopupAction.cancel(),Or.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return S(e,this.auth,"internal-error"),e}async onExecution(){R(1===this.filter.length,"Popup operations only handle one event");const e=Ri();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(T(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(T(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Or.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;null!==(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)&&void 0!==n&&n.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(T(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Rr.get())};e()}}Or.currentPopupAction=null;const Cr="pendingRedirect",Dr=new Map;class Lr extends kr{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Dr.get(this.auth._key());if(!e){try{const n=await Mr(this.resolver,this.auth)?await super.execute():null;e=(()=>Promise.resolve(n))}catch(t){e=(()=>Promise.reject(t))}Dr.set(this.auth._key(),e)}return this.bypassAuthState||Dr.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function Mr(e,t){const n=jr(t),i=Vr(e);if(!(await i._isAvailable()))return!1;const r="true"===await i._get(n);return await i._remove(n),r}async function xr(e,t){return Vr(e)._set(jr(t),"true")}function Ur(){Dr.clear()}function Fr(e,t){Dr.set(e._key(),t)}function Vr(e){return Te(e._redirectPersistence)}function jr(e){return Ee(Cr,e.config.apiKey,e.name)}function Hr(e,t,n){return qr(e,t,n)}async function qr(t,n,i){if((0,e._isFirebaseServerApp)(t.app))return Promise.reject(w(t));const r=We(t);E(t,n,Ht),await r._initializationPromise;const s=yr(r,i);return await xr(s,r),s._openRedirect(r,n,"signInViaRedirect")}function zr(e,t,n){return Gr(e,t,n)}async function Gr(n,i,r){const s=(0,t.getModularInstance)(n);if(E(s.auth,i,Ht),(0,e._isFirebaseServerApp)(s.auth.app))return Promise.reject(w(s.auth));await s.auth._initializationPromise;const o=yr(s.auth,r);await xr(o,s.auth);const a=await Jr(s);return o._openRedirect(s.auth,i,"reauthViaRedirect",a)}function Wr(e,t,n){return Kr(e,t,n)}async function Kr(e,n,i){const r=(0,t.getModularInstance)(e);E(r.auth,n,Ht),await r.auth._initializationPromise;const s=yr(r.auth,i);await cn(!1,r,n.providerId),await xr(s,r.auth);const o=await Jr(r);return s._openRedirect(r.auth,n,"linkViaRedirect",o)}async function $r(e,t){return await We(e)._initializationPromise,Br(e,t,!1)}async function Br(t,n,i=!1){if((0,e._isFirebaseServerApp)(t.app))return Promise.reject(w(t));const r=We(t),s=yr(r,n),o=new Lr(r,s,i),a=await o.execute();return a&&!i&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,n)),a}async function Jr(e){const t=Ri(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}const Yr=6e5;class Xr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!es(e)?t:(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0),t)}sendToConsumer(e,t){var n;if(e.error&&!Zr(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(T(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Yr&&this.cachedEventUids.clear(),this.cachedEventUids.has(Qr(e))}saveEventToCache(e){this.cachedEventUids.add(Qr(e)),this.lastProcessedEventTime=Date.now()}}function Qr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Zr({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}function es(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Zr(e);default:return!1}}async function ts(e,t={}){return V(e,"GET","/v1/projects",t)}exports.aD=Xr;const ns=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,is=/^https?/;async function rs(e){if(e.config.emulator)return;const{authorizedDomains:t}=await ts(e);for(const i of t)try{if(ss(i))return}catch(n){}_(e,"unauthorized-domain")}function ss(e){const t=N(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!is.test(n))return!1;if(ns.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const os=new D(3e4,6e4);function as(){const e=bi().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function cs(e){return new Promise((t,n)=>{var i,r,s;function o(){as(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{as(),n(T(e,"network-request-failed"))},timeout:os.get()})}if(null===(r=null===(i=bi().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(null===(s=bi().gapi)||void 0===s||!s.load){const t=Ze("iframefcb");return bi()[t]=(()=>{gapi.load?o():n(T(e,"network-request-failed"))}),Je(`${Qe()}?onload=${t}`).catch(e=>n(e))}o()}}).catch(e=>{throw us=null,e})}let us=null;function ds(e){return us=us||cs(e)}const ls=new D(5e3,15e3),hs="__/auth/iframe",ps="emulator/auth/iframe",ms={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fs=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gs(n){const i=n.config;S(i.authDomain,n,"auth-domain-config-required");const r=i.emulator?L(i,ps):`https://${n.config.authDomain}/${hs}`,s={apiKey:i.apiKey,appName:n.name,v:e.SDK_VERSION},o=fs.get(n.config.apiHost);o&&(s.eid=o);const a=n._getFrameworks();return a.length&&(s.fw=a.join(",")),`${r}?${(0,t.querystring)(s).slice(1)}`}async function vs(e){const t=await ds(e),n=bi().gapi;return S(n,e,"internal-error"),t.open({where:document.body,url:gs(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ms,dontclear:!0},t=>new Promise(async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=T(e,"network-request-failed"),s=bi().setTimeout(()=>{i(r)},ls.get());function o(){bi().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{i(r)})}))}const Is={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},_s=500,Ts=600,ys="_blank",ws="http://localhost";class Es{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function As(e,n,i,r=_s,s=Ts){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},Is),{width:r.toString(),height:s.toString(),top:o,left:a}),d=(0,t.getUA)().toLowerCase();i&&(c=Ne(d)?ys:i),ke(d)&&(n=n||ws,u.scrollbars="yes");const l=Object.entries(u).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(Me(d)&&"_self"!==c)return Ss(n||"",c),new Es(null);const h=window.open(n||"",c,l);S(h,e,"popup-blocked");try{h.focus()}catch(p){}return new Es(h)}function Ss(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}exports.aO=Es;const ks="__/auth/handler",Rs="emulator/auth/handler",Ns=encodeURIComponent("fac");async function bs(n,i,r,s,o,a){S(n.config.authDomain,n,"auth-domain-config-required"),S(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:r,redirectUrl:s,v:e.SDK_VERSION,eventId:o};if(i instanceof Ht){i.setDefaultLanguage(n.languageCode),c.providerId=i.providerId||"",(0,t.isEmpty)(i.getCustomParameters())||(c.customParameters=JSON.stringify(i.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))c[e]=t}if(i instanceof qt){const e=i.getScopes().filter(e=>""!==e);e.length>0&&(c.scopes=e.join(","))}n.tenantId&&(c.tid=n.tenantId);const u=c;for(const e of Object.keys(u))void 0===u[e]&&delete u[e];const d=await n._getAppCheckToken(),l=d?`#${Ns}=${encodeURIComponent(d)}`:"";return`${Ps(n)}?${(0,t.querystring)(u).slice(1)}${l}`}function Ps({config:e}){return e.emulator?L(e,Rs):`https://${e.authDomain}/${ks}`}const Os="webStorageSupport";class Cs{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ai,this._completeRedirectFn=Br,this._overrideRedirectResult=Fr}async _openPopup(e,t,n,i){var r;return R(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),As(e,await bs(e,t,n,N(),i),Ri())}async _openRedirect(e,t,n,i){return await this._originValidation(e),Pi(await bs(e,t,n,N(),i)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(R(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await vs(e),n=new Xr(e);return t.register("authEvent",t=>{return S(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Os,{type:Os},n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Os];void 0!==r&&t(!!r),_(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=rs(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ue()||Re()||De()}}const Ds=exports.k=Cs;class Ls{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return k("unexpected MultiFactorSessionType")}}}class Ms extends Ls{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Ms(e)}_finalizeEnroll(e,t,n){return ui(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return Xi(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class xs{constructor(){}static assertion(e){return Ms._fromCredential(e)}}exports.m=xs,xs.FACTOR_ID="phone";class Us{static assertionForEnrollment(e,t){return Fs._fromSecret(e,t)}static assertionForSignIn(e,t){return Fs._fromEnrollmentId(e,t)}static async generateSecret(e){var t;const n=e;S(void 0!==(null===(t=n.user)||void 0===t?void 0:t.auth),"internal-error");const i=await di(n.user.auth,{idToken:n.credential,totpEnrollmentInfo:{}});return Vs._fromStartTotpMfaEnrollmentResponse(i,n.user.auth)}}exports.T=Us,Us.FACTOR_ID="totp";class Fs extends Ls{constructor(e,t,n){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=n}static _fromSecret(e,t){return new Fs(t,void 0,e)}static _fromEnrollmentId(e,t){return new Fs(t,e)}async _finalizeEnroll(e,t,n){return S(void 0!==this.secret,e,"argument-error"),li(e,{idToken:t,displayName:n,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){S(void 0!==this.enrollmentId&&void 0!==this.otp,e,"argument-error");const n={verificationCode:this.otp};return Qi(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:n})}}class Vs{constructor(e,t,n,i,r,s,o){this.sessionInfo=s,this.auth=o,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=n,this.codeIntervalSeconds=i,this.enrollmentCompletionDeadline=r}static _fromStartTotpMfaEnrollmentResponse(e,t){return new Vs(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var n;let i=!1;return(js(e)||js(t))&&(i=!0),i&&(js(e)&&(e=(null===(n=this.auth.currentUser)||void 0===n?void 0:n.email)||"unknownuser"),js(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function js(e){return void 0===e||0===(null==e?void 0:e.length)}exports.n=Vs;var Hs="@firebase/auth",qs="1.7.4";class zs{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){S(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Gs(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ws(t){(0,e._registerComponent)(new r.Component("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;S(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ve(t)},u=new Ge(i,r,s,c);return at(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),(0,e._registerComponent)(new r.Component("auth-internal",e=>{return(e=>new zs(e))(We(e.getProvider("auth").getImmediate()))},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,e.registerVersion)(Hs,qs,Gs(t)),(0,e.registerVersion)(Hs,qs,"esm2017")}const Ks=300,$s=(0,t.getExperimentalSetting)("authIdTokenMaxAge")||300;let Bs=null;const Js=e=>async t=>{const n=t&&await t.getIdTokenResult(),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>$s)return;const r=null==n?void 0:n.token;Bs!==r&&(Bs=r,await fetch(e,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function Ys(n=(0,e.getApp)()){const i=(0,e._getProvider)(n,"auth");if(i.isInitialized())return i.getImmediate();const r=ot(n,{popupRedirectResolver:Ds,persistence:[Ji,wi,Ai]}),s=(0,t.getExperimentalSetting)("authTokenSyncURL");if(s&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(s,location.origin);if(location.origin===e.origin){const t=Js(e.toString());Qn(r,t,()=>t(r.currentUser)),Xn(r,e=>t(e))}}const o=(0,t.getDefaultEmulatorHost)("auth");return o&&ct(r,`http://${o}`),r}function Xs(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}Be({loadJS:e=>new Promise((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=(e=>{const t=T("internal-error");t.customData=e,n(t)}),i.type="text/javascript",i.charset="UTF-8",Xs().appendChild(i)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),Ws("Browser");
},{"@firebase/app":"h2Mb","@firebase/util":"chA2","@firebase/logger":"JJem","tslib":"vCxL","@firebase/component":"vhY9"}],"QWyA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"ActionCodeOperation",{enumerable:!0,get:function(){return e.A}}),Object.defineProperty(exports,"ActionCodeURL",{enumerable:!0,get:function(){return e.ai}}),Object.defineProperty(exports,"AuthCredential",{enumerable:!0,get:function(){return e.L}}),Object.defineProperty(exports,"AuthErrorCodes",{enumerable:!0,get:function(){return e.I}}),Object.defineProperty(exports,"EmailAuthCredential",{enumerable:!0,get:function(){return e.M}}),Object.defineProperty(exports,"EmailAuthProvider",{enumerable:!0,get:function(){return e.V}}),Object.defineProperty(exports,"FacebookAuthProvider",{enumerable:!0,get:function(){return e.W}}),Object.defineProperty(exports,"FactorId",{enumerable:!0,get:function(){return e.F}}),Object.defineProperty(exports,"GithubAuthProvider",{enumerable:!0,get:function(){return e.Y}}),Object.defineProperty(exports,"GoogleAuthProvider",{enumerable:!0,get:function(){return e.X}}),Object.defineProperty(exports,"OAuthCredential",{enumerable:!0,get:function(){return e.N}}),Object.defineProperty(exports,"OAuthProvider",{enumerable:!0,get:function(){return e.Z}}),Object.defineProperty(exports,"OperationType",{enumerable:!0,get:function(){return e.O}}),Object.defineProperty(exports,"PhoneAuthCredential",{enumerable:!0,get:function(){return e.Q}}),Object.defineProperty(exports,"PhoneAuthProvider",{enumerable:!0,get:function(){return e.P}}),Object.defineProperty(exports,"PhoneMultiFactorGenerator",{enumerable:!0,get:function(){return e.m}}),Object.defineProperty(exports,"ProviderId",{enumerable:!0,get:function(){return e.p}}),Object.defineProperty(exports,"RecaptchaVerifier",{enumerable:!0,get:function(){return e.R}}),Object.defineProperty(exports,"SAMLAuthProvider",{enumerable:!0,get:function(){return e._}}),Object.defineProperty(exports,"SignInMethod",{enumerable:!0,get:function(){return e.S}}),Object.defineProperty(exports,"TotpMultiFactorGenerator",{enumerable:!0,get:function(){return e.T}}),Object.defineProperty(exports,"TotpSecret",{enumerable:!0,get:function(){return e.n}}),Object.defineProperty(exports,"TwitterAuthProvider",{enumerable:!0,get:function(){return e.$}}),Object.defineProperty(exports,"applyActionCode",{enumerable:!0,get:function(){return e.a7}}),Object.defineProperty(exports,"beforeAuthStateChanged",{enumerable:!0,get:function(){return e.x}}),Object.defineProperty(exports,"browserLocalPersistence",{enumerable:!0,get:function(){return e.b}}),Object.defineProperty(exports,"browserPopupRedirectResolver",{enumerable:!0,get:function(){return e.k}}),Object.defineProperty(exports,"browserSessionPersistence",{enumerable:!0,get:function(){return e.a}}),Object.defineProperty(exports,"checkActionCode",{enumerable:!0,get:function(){return e.a8}}),Object.defineProperty(exports,"confirmPasswordReset",{enumerable:!0,get:function(){return e.a6}}),Object.defineProperty(exports,"connectAuthEmulator",{enumerable:!0,get:function(){return e.K}}),Object.defineProperty(exports,"createUserWithEmailAndPassword",{enumerable:!0,get:function(){return e.aa}}),Object.defineProperty(exports,"debugErrorMap",{enumerable:!0,get:function(){return e.G}}),Object.defineProperty(exports,"deleteUser",{enumerable:!0,get:function(){return e.E}}),Object.defineProperty(exports,"fetchSignInMethodsForEmail",{enumerable:!0,get:function(){return e.af}}),Object.defineProperty(exports,"getAdditionalUserInfo",{enumerable:!0,get:function(){return e.aq}}),Object.defineProperty(exports,"getAuth",{enumerable:!0,get:function(){return e.o}}),Object.defineProperty(exports,"getIdToken",{enumerable:!0,get:function(){return e.an}}),Object.defineProperty(exports,"getIdTokenResult",{enumerable:!0,get:function(){return e.ao}}),Object.defineProperty(exports,"getMultiFactorResolver",{enumerable:!0,get:function(){return e.as}}),Object.defineProperty(exports,"getRedirectResult",{enumerable:!0,get:function(){return e.j}}),Object.defineProperty(exports,"inMemoryPersistence",{enumerable:!0,get:function(){return e.U}}),Object.defineProperty(exports,"indexedDBLocalPersistence",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(exports,"initializeAuth",{enumerable:!0,get:function(){return e.J}}),Object.defineProperty(exports,"initializeRecaptchaConfig",{enumerable:!0,get:function(){return e.t}}),Object.defineProperty(exports,"isSignInWithEmailLink",{enumerable:!0,get:function(){return e.ad}}),Object.defineProperty(exports,"linkWithCredential",{enumerable:!0,get:function(){return e.a2}}),Object.defineProperty(exports,"linkWithPhoneNumber",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(exports,"linkWithPopup",{enumerable:!0,get:function(){return e.d}}),Object.defineProperty(exports,"linkWithRedirect",{enumerable:!0,get:function(){return e.g}}),Object.defineProperty(exports,"multiFactor",{enumerable:!0,get:function(){return e.at}}),Object.defineProperty(exports,"onAuthStateChanged",{enumerable:!0,get:function(){return e.y}}),Object.defineProperty(exports,"onIdTokenChanged",{enumerable:!0,get:function(){return e.w}}),Object.defineProperty(exports,"parseActionCodeURL",{enumerable:!0,get:function(){return e.aj}}),Object.defineProperty(exports,"prodErrorMap",{enumerable:!0,get:function(){return e.H}}),Object.defineProperty(exports,"reauthenticateWithCredential",{enumerable:!0,get:function(){return e.a3}}),Object.defineProperty(exports,"reauthenticateWithPhoneNumber",{enumerable:!0,get:function(){return e.r}}),Object.defineProperty(exports,"reauthenticateWithPopup",{enumerable:!0,get:function(){return e.e}}),Object.defineProperty(exports,"reauthenticateWithRedirect",{enumerable:!0,get:function(){return e.h}}),Object.defineProperty(exports,"reload",{enumerable:!0,get:function(){return e.ar}}),Object.defineProperty(exports,"revokeAccessToken",{enumerable:!0,get:function(){return e.D}}),Object.defineProperty(exports,"sendEmailVerification",{enumerable:!0,get:function(){return e.ag}}),Object.defineProperty(exports,"sendPasswordResetEmail",{enumerable:!0,get:function(){return e.a5}}),Object.defineProperty(exports,"sendSignInLinkToEmail",{enumerable:!0,get:function(){return e.ac}}),Object.defineProperty(exports,"setPersistence",{enumerable:!0,get:function(){return e.q}}),Object.defineProperty(exports,"signInAnonymously",{enumerable:!0,get:function(){return e.a0}}),Object.defineProperty(exports,"signInWithCredential",{enumerable:!0,get:function(){return e.a1}}),Object.defineProperty(exports,"signInWithCustomToken",{enumerable:!0,get:function(){return e.a4}}),Object.defineProperty(exports,"signInWithEmailAndPassword",{enumerable:!0,get:function(){return e.ab}}),Object.defineProperty(exports,"signInWithEmailLink",{enumerable:!0,get:function(){return e.ae}}),Object.defineProperty(exports,"signInWithPhoneNumber",{enumerable:!0,get:function(){return e.s}}),Object.defineProperty(exports,"signInWithPopup",{enumerable:!0,get:function(){return e.c}}),Object.defineProperty(exports,"signInWithRedirect",{enumerable:!0,get:function(){return e.f}}),Object.defineProperty(exports,"signOut",{enumerable:!0,get:function(){return e.C}}),Object.defineProperty(exports,"unlink",{enumerable:!0,get:function(){return e.ap}}),Object.defineProperty(exports,"updateCurrentUser",{enumerable:!0,get:function(){return e.B}}),Object.defineProperty(exports,"updateEmail",{enumerable:!0,get:function(){return e.al}}),Object.defineProperty(exports,"updatePassword",{enumerable:!0,get:function(){return e.am}}),Object.defineProperty(exports,"updatePhoneNumber",{enumerable:!0,get:function(){return e.u}}),Object.defineProperty(exports,"updateProfile",{enumerable:!0,get:function(){return e.ak}}),Object.defineProperty(exports,"useDeviceLanguage",{enumerable:!0,get:function(){return e.z}}),Object.defineProperty(exports,"validatePassword",{enumerable:!0,get:function(){return e.v}}),Object.defineProperty(exports,"verifyBeforeUpdateEmail",{enumerable:!0,get:function(){return e.ah}}),Object.defineProperty(exports,"verifyPasswordResetCode",{enumerable:!0,get:function(){return e.a9}});var e=require("./index-454a0f5f.js");require("@firebase/app"),require("@firebase/util"),require("@firebase/logger"),require("tslib"),require("@firebase/component");
},{"./index-454a0f5f.js":"aTyD","@firebase/app":"h2Mb","@firebase/util":"chA2","@firebase/logger":"JJem","tslib":"vCxL","@firebase/component":"vhY9"}],"lHTY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/auth");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/auth":"QWyA"}],"Focm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.registerUser=p;var t=require("firebase/app"),e=require("firebase/firestore"),r=require("firebase/auth");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(){o=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",s=c.asyncIterator||"@@asyncIterator",f=c.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof w?e:w,i=Object.create(o.prototype),c=new I(n||[]);return a(i,"_invoke",{value:k(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var y="suspendedStart",v="suspendedYield",d="executing",g="completed",m={};function w(){}function b(){}function x(){}var L={};l(L,u,function(){return this});var E=Object.getPrototypeOf,_=E&&E(E(N([])));_&&_!==r&&i.call(_,u)&&(L=_);var S=x.prototype=w.prototype=Object.create(L);function j(t){["next","throw","return"].forEach(function(e){l(t,e,function(t){return this._invoke(e,t)})})}function O(t,e){function r(o,a,c,u){var s=p(t[o],t,a);if("throw"!==s.type){var f=s.arg,l=f.value;return l&&"object"==n(l)&&i.call(l,"__await")?e.resolve(l.__await).then(function(t){r("next",t,c,u)},function(t){r("throw",t,c,u)}):e.resolve(l).then(function(t){f.value=t,c(f)},function(t){return r("throw",t,c,u)})}u(s.arg)}var o;a(this,"_invoke",{value:function(t,n){function i(){return new e(function(e,o){r(t,n,e,o)})}return o=o?o.then(i,i):i()}})}function k(e,r,n){var o=y;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=P(c,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?g:v,s.arg===m)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=g,n.method="throw",n.arg=s.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function G(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(i.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return b.prototype=x,a(S,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:b,configurable:!0}),b.displayName=l(x,f,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,l(t,f,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},j(O.prototype),l(O.prototype,s,function(){return this}),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},j(S),l(S,f,"Generator"),l(S,u,function(){return this}),l(S,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(G),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),s=i.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),G(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;G(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function i(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function a(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var a=t.apply(e,r);function c(t){i(a,n,o,c,u,"next",t)}function u(t){i(a,n,o,c,u,"throw",t)}c(void 0)})}}var c={apiKey:"AIzaSyDWaYEiz9xsnLyE1lqo2csSDZyi-XRxk2w",authDomain:"accenture-training-website.firebaseapp.com",databaseURL:"https://accenture-training-website-default-rtdb.europe-west1.firebasedatabase.app",projectId:"accenture-training-website",storageBucket:"accenture-training-website.appspot.com",messagingSenderId:"281533185330",appId:"1:281533185330:web:025c8d538a16b68c492b2b"},u=(0,t.initializeApp)(c),s=(0,e.getFirestore)(u),f=(0,r.getAuth)(u);function l(){return h.apply(this,arguments)}function h(){return(h=a(o().mark(function t(){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,e.setDoc)((0,e.doc)(s,"cities","LA"),{name:"Los Angeles",state:"CA",country:"USA"});case 3:console.log("Document successfully written!"),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Error writing document: ",t.t0);case 9:case"end":return t.stop()}},t,null,[[0,6]])}))).apply(this,arguments)}function p(t,e){return new Promise(function(t,e){e("Simulated error: Invalid email or password.")})}
},{"firebase/app":"QtzL","firebase/firestore":"rrht","firebase/auth":"lHTY"}],"epB2":[function(require,module,exports) {
"use strict";var t=require("./index.js");function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(){r=function(){return n};var t,n={},o=Object.prototype,i=o.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",s=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof w?e:w,i=Object.create(o.prototype),c=new N(n||[]);return a(i,"_invoke",{value:I(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}n.wrap=h;var y="suspendedStart",d="suspendedYield",v="executing",m="completed",g={};function w(){}function b(){}function x(){}var L={};f(L,u,function(){return this});var E=Object.getPrototypeOf,k=E&&E(E(B([])));k&&k!==o&&i.call(k,u)&&(L=k);var O=x.prototype=w.prototype=Object.create(L);function _(t){["next","throw","return"].forEach(function(e){f(t,e,function(t){return this._invoke(e,t)})})}function j(t,r){function n(o,a,c,u){var s=p(t[o],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==e(f)&&i.call(f,"__await")?r.resolve(f.__await).then(function(t){n("next",t,c,u)},function(t){n("throw",t,c,u)}):r.resolve(f).then(function(t){l.value=t,c(l)},function(t){return n("throw",t,c,u)})}u(s.arg)}var o;a(this,"_invoke",{value:function(t,e){function i(){return new r(function(r,o){n(t,e,r,o)})}return o=o?o.then(i,i):i()}})}function I(e,r,n){var o=y;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=S(c,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?m:d,s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function G(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function B(r){if(r||""===r){var n=r[u];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(i.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(e(r)+" is not iterable")}return b.prototype=x,a(O,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:b,configurable:!0}),b.displayName=f(x,l,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(O),t},n.awrap=function(t){return{__await:t}},_(j.prototype),f(j.prototype,s,function(){return this}),n.AsyncIterator=j,n.async=function(t,e,r,o,i){void 0===i&&(i=Promise);var a=new j(h(t,e,r,o),i);return n.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},_(O),f(O,l,"Generator"),f(O,u,function(){return this}),f(O,"toString",function(){return"[object Generator]"}),n.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},n.values=B,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(G),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),s=i.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),G(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;G(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:B(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},n}function n(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise(function(o,i){var a=t.apply(e,r);function c(t){n(a,o,i,c,u,"next",t)}function u(t){n(a,o,i,c,u,"throw",t)}c(void 0)})}}function i(){var t=document.getElementById("username");t&&(t.textContent="Lisa")}function a(t){return card}function c(t){window.location.href="description.html?courseId=".concat(t)}function u(){return s.apply(this,arguments)}function s(){return(s=o(r().mark(function t(){return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)}))).apply(this,arguments)}function l(){return f.apply(this,arguments)}function f(){return(f=o(r().mark(function t(){return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)}))).apply(this,arguments)}function h(){return p.apply(this,arguments)}function p(){return(p=o(r().mark(function t(){return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)}))).apply(this,arguments)}function y(t){return d.apply(this,arguments)}function d(){return(d=o(r().mark(function t(e){return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)}))).apply(this,arguments)}function v(){}document.addEventListener("DOMContentLoaded",function(){console.log("DOM fully loaded and parsed"),document.getElementById("loginButton").addEventListener("click",function(){var e=o(r().mark(function e(n){var o,i,a,c,s;return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),console.log("Log In button clicked"),o=document.getElementById("email").value,i=document.getElementById("password").value,(a=document.getElementById("errorMessage")).textContent="",a.style.display="none",e.prev=7,e.next=10,(0,t.registerUser)(o,i);case 10:c=e.sent,console.log("Registration successful:",c),window.location.href="dashboard.html",e.next=19;break;case 15:e.prev=15,e.t0=e.catch(7),console.error("Error during logging in:",e.t0),a.textContent=e.t0;case 19:window.location.pathname.endsWith("dashboard.html")&&u(),window.location.pathname.endsWith("catalog.html")&&l(),window.location.pathname.endsWith("description.html")&&(h(),(s=document.getElementById("search-bar"))&&s.addEventListener("input",v));case 22:case"end":return e.stop()}},e,null,[[7,15]])}));return function(t){return e.apply(this,arguments)}}()),i()});
},{"./index.js":"Focm"}]},{},["epB2"], null)
//# sourceMappingURL=/main.cf684f01.js.map